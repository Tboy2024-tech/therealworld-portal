/* VimeoPlayer - v4.46.12 - 2025-11-25 - https://player.vimeo.com/NOTICE.txt */
const e={MANIFEST:"manifest",SEGMENT:"segment"},t={method:"GET",async:!0,retry:0,throwHttpErrors:!0,headers:{},hooks:{beforeRequest:[],beforeRetry:[],afterResponse:[]},validateStatus:function(e){return e>=200&&e<300},retryStatus:function(e){return[408,413,429].includes(e)||e>=500&&e<600}};function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function n(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}function i(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function s(e,t){return e.get(n(e,t))}function a(e,t,r){i(e,t),t.set(e,r)}function o(e,t,r){return e.set(n(e,t),r),r}function c(e,t){i(e,t),t.add(e)}function u(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=v(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e){if(null==e)throw new TypeError("Cannot destructure "+e)}function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach(function(t){l(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function _(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function p(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||v(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){if(e){if("string"==typeof e)return r(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}function m(e){return e.filter((e,t,r)=>r.indexOf(e)===t)}function g(e,t){return e.reduce((e,r,n,i)=>e.concat(t(r,n,i)),[])}function E(e){return(t,...r)=>(r.forEach(r=>{for(const n in r){const i=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,Object.assign(i,e))}}),t)}const T=E({enumerable:!1,configurable:!0,writeable:!1}),y=E({enumerable:!1,configurable:!1,writeable:!1}),S=E({enumerable:!0,configurable:!0,writeable:!1}),b={h264:"video/mp4",hls:"application/vnd.apple.mpegurl",hlsLive:"application/x-mpegURL",dash:"application/vnd.vimeo.dash+json",dashMpd:"video/vnd.mpeg.dash.mpd",vp6:"video/x-flv",vp8:"video/webm",webm:"video/webm",hds:"application/f4m"},A=e=>new Promise(t=>setTimeout(t,e));function I(e){return"webkitDisplayingFullscreen"in e&&e.webkitDisplayingFullscreen}function w(e){if(e&&I(e))return!0;const t=[document.fullscreenElement,document.webkitFullscreenElement,document.webkitCurrentFullScreenElement,document.mozFullScreenElement,document.msFullscreenElement].find(e=>void 0!==e);return Boolean(t)}const R=()=>{var e;const t=null==(e=window.navigator.connection)?void 0:e.downlink;return void 0===t?null:1e3*t*1e3};function P(e){try{const t=new URLSearchParams;return Object.entries(e).forEach(([e,r])=>{void 0!==r&&t.append(e,String(r))}),t.toString()}catch(e){return""}}function D(e){if("string"!=typeof e)return{};try{const t=new URLSearchParams(e),r={};return t.forEach((e,t)=>{r[t]=e}),r}catch(e){return{}}}function L(e){try{return new URL(e)}catch(e){return{}}}const k=(e,t,r=!1)=>{try{const n=new URL(e);return Object.entries(t).forEach(([e,t])=>{var i;r&&void 0===t||n.searchParams.set(e,null!==(i=null==t?void 0:t.toString())&&void 0!==i?i:"")}),n.toString()}catch(t){return e}},C=e=>{try{const{username:t,password:r,host:n}=new URL(e);return n?t||r?`${t}:${r}@${n}`:n:null}catch(e){return null}},O=function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}(function(e){let t=!1;return function(r,n){var i=function(){if(/json=1/.test(e))return function(e,t){return void 0?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}(Ye(e).json(),function(e){const r=e.url;return t=!0,r})}();return i&&i.then?i.then(n):n(i)}(0,function(r){return t?r:e})});function N(e){const t=L(e),r=t&&t.pathname.match(/^\/(exp=)?(\d{10,})/);if(r&&r[2])return 1e3*Number(r[2])}function M(e){e.substring(0,e.lastIndexOf("/")+1)}const x=(e,t=!1)=>new Promise((r,n)=>{if(t){const t=document.querySelector(`script[src="${e}"]`);if(t&&!t.dataset.error)return void setTimeout(r,0)}const i=document.createElement("script");i.src=e,i.addEventListener("load",r),i.addEventListener("error",e=>{i.dataset.error="true",n(e.error)}),document.head.appendChild(i)}),U=e=>Math.pow(e,2),F=e=>Math.sqrt(e),V=(e,t)=>{const r=(r,...n)=>{[`%c${e}`,t].concat(n)},n=e=>(...t)=>{r.apply(void 0,[e].concat(t))},i=n("log"),s=(...e)=>{i.apply(void 0,e)};return Object.assign(s,{log:i,warn:n("warn"),error:n("error")}),s};function j(e,...t){return t.reduce((e,t)=>(Object.keys(t||{}).forEach(r=>{const n=e[r],i=t[r];n&&void 0===i||(Array.isArray(i)?e[r]=(n||[]).concat(i):(e=>e&&"object"==typeof e)(i)?e[r]=j({},n,i):e[r]=i)}),e),e)}const H=void 0!==window.ManagedMediaSource?window.ManagedMediaSource:window.MediaSource,B=(e=!1)=>e?window.MediaSource:H,X=navigator.userAgent.toLowerCase(),W=["googlebot","google-inspectiontool"],q=["bingbot","bingpreview","yandex","slurp","facebookexternalhit","msnbot","feedly","parse.ly"],G=["gptbot","claude-web","claudebot","perplexitybot","perplexity-user"];function K(e){e=e.toLowerCase();const t=new RegExp(e).test(X);return"safari"===e?t&&new RegExp("version").test(X):t}function Y(e){const t=document.createElement("div"),r=e.charAt(0).toUpperCase()+e.slice(1),n=(e+" "+["Webkit","Moz","O","ms"].join(r+" ")+r).split(" ");for(let e in n){const r=n[e];if(void 0!==t.style[r])return r}return e}const $=!!K("android")&&(parseFloat(X.replace(/^.* android (\d+)\.(\d+).*$/,"$1.$2"))||!0),z=window.devicePixelRatio||1,Q=!(!K("windows phone")&&!K("iemobile"))&&(parseFloat(X.replace(/^.* windows phone (os )?(\d+)\.(\d+).*$/,"$2.$3"))||!0),J=!!K("msie")&&parseFloat(X.replace(/^.*msie (\d+).*$/,"$1")),Z=!!K("trident")&&parseFloat(X.replace(/^.*trident\/(\d+)\.(\d+).*$/,"$1.$2"))+4,ee=K("ipad;")||K("iphone;")||K("ipod touch;")?parseFloat(X.replace(/^.* os (\d+)_(\d+).*$/,"$1.$2")):navigator.userAgent.includes("Mac")&&"ontouchend"in document,te=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Version)/i.test(navigator.userAgent),re="MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,ne=K("opera")||K("opr"),ie=/^Mozilla\/5\.0 \(.* Mac OS X.*\(KHTML, like Gecko\)(?: Mobile\/[\S]*|)$/i.test(X),se=(K("safari")||te)&&K("apple")&&!K("chrome")&&!K("android");function ae(){if(!K("chrome"))return[];const e=X.split(" ").find(function(e){return ee?/CriOS\//.test(e):/chrome\//.test(e)});return e?e.replace("chrome/","").split(".").map(function(e){return parseInt(e,10)}):[]}function oe(e){if(!se)return!1;const t=e.split("."),r=function(){if(!K("safari"))return[];const e=X.split(" ").find(function(e){return/version\//.test(e)});return e?e.replace("version/","").split(".").map(function(e){return parseInt(e,10)}):[]}();for(let e=0;e<3;e++){const n=parseInt(t[e],10)||0,i=r[e]||0;if(n<i)return!0;if(n>i)return!1}return!0}const ce={autoplayPolicy:oe("11"),hevc:oe("11"),dolbyVision:oe("14.1"),spatial:oe("11.0.2"),fullscreenRequiresDataLoaded:oe("17.2")},ue={airPlay:"WebKitPlaybackTargetAvailabilityEvent"in window,android:$,appleMail:ie,hasAutoplayPolicy:$||ee||ce.autoplayPolicy||ae()[0]>=66,iOS:ee,iPadOS:re,mobileAndroid:$&&K("mobile"),browser:{bb10:K("bb10"),chrome:K("chrome"),firefox:K("firefox"),ie:J||Z,edge:K("edge"),opera:ne,safari:se,chromium:"chrome"in window&&!K("crios"),webKit:se||K("crios")},mse:H,devicePixelRatio:z,iPhone:K("iphone;")||K("ipod touch;")||K("ipod;"),iPad:K("ipad;"),iPadNonRetina:K("ipad;")&&z<2,mac:K("mac os"),navigatorConnectionDownlink:!!window.navigator.connection?.downlink,pictureInPictureSupportType:function(){if("pictureInPictureEnabled"in document)return"pip-api";const e=document.createElement("video");return!("function"!=typeof e.webkitSetPresentationMode||!e.webkitSupportsPresentationMode("picture-in-picture"))&&"webkit-presentation-mode"}(),pointerEvents:window.navigator.pointerEnabled||window.navigator.msPointerEnabled||!1,passiveEvents:function(){let e=!1;try{const t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassive",null,t),window.removeEventListener("testPassive",null,t)}catch(e){}return e}(),svg:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||K("windows phone")||window.navigator.maxTouchPoints>1||window.navigator.msMaxTouchPoints||!1,transformProperty:Y("transform"),transitionProperty:Y("transition"),webp:function(){const e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))&&0===e.toDataURL("image/webp").indexOf("data:image/webp")}(),windowsPhone:Q,mediaCapabilities:"mediaCapabilities"in navigator,webShare:"canShare"in navigator&&"share"in navigator,isGoogleBot:(()=>{const e=X.toLowerCase();return W.some(t=>e.includes(t))})(),isCrawler:(()=>{const e=X.toLowerCase();return q.some(t=>e.includes(t))})(),isLLMBot:(()=>{const e=X.toLowerCase();return G.some(t=>e.includes(t))})(),storageAccessAPI:"requestStorageAccess"in document&&"hasStorageAccess"in document,clipboardAPI:"clipboard"in navigator&&"write"in navigator.clipboard,videoContentPreload:!K("iphone"),intersectionObserver:"IntersectionObserver"in window},le=e=>{ue.mse=e},he=/mac os x 10_13/.test(X),de=ue.iOS&&ue.iOS>=11,fe="undefined"!=typeof matchMedia&&(matchMedia("(color-gamut: p3)").matches&&screen.pixelDepth>24||matchMedia("(dynamic-range: high), (video-dynamic-range: high)").matches);ue.hevc=function(e="hvc1"){return void 0!==H?H.isTypeSupported(`video/mp4; codecs="${e}"`):ce.hevc&&(he||de)}("hvc1.2.4.H150.90"),ue.hdr=fe,ue.dolbyVision=function(){const e='video/mp4; codecs="dvh1"';let t=void 0!==H&&H.isTypeSupported(e);if(!t){const r=document.createElement("video");"canPlayType"in r&&(t="probably"===r.canPlayType(e))}return!((re||ue.iOS)&&!ce.dolbyVision)&&t}(),ue.vp9hdr=(window.matchMedia("(color-gamut: p3)").matches||window.matchMedia("(color-gamut: rec2020)").matches)&&screen.colorDepth>=48&&(H.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.16.09.00"')||H.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.16.09.01"')||H.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.18.09.00"')||H.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.18.09.01"')),ue.av1=void 0!==H&&H.isTypeSupported('video/mp4; codecs="av01.0.31M.08.0.110.01.01.01.0"'),ue.webvr=!(!window.navigator||!("getVRDisplays"in window.navigator)),ue.webxr=!!(window.navigator&&"xr"in window.navigator&&"supportsSession"in window.navigator.xr),ue.spatialPlayback=!!ue.mse,ue.stereoscopic=ue.spatialPlayback&&ue.mobileAndroid,ue.chromeHls=function(){const e=document.createElement("video"),t=K("chrome")&&ae()[0]>=142;return!("function"!=typeof e.canPlayType||!t||!e.canPlayType(b.hls))}(),ue.fullscreenRequiresDataLoaded=ue.iOS>=17||ue.iPadOS&&ce.fullscreenRequiresDataLoaded;const _e=function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}(function(e){return new Promise(t=>{const{cleanup:r}=pe(e,e=>{e&&(t(),r())})})});function pe(e,t){let r=!0,n=!0;function i(){return n=r&&"visible"===document.visibilityState,n}if(!ue.intersectionObserver)return null==t||t(!0),{cleanup:()=>{},isInView:!0};const s=new IntersectionObserver(e=>{const[s]=e;r=!(null==s||!s.isIntersecting),i(),null==t||t(n)},{threshold:.5});s.observe(e);const a=()=>{i(),null==t||t(n)};return document.addEventListener("visibilitychange",a),{cleanup:()=>{s.disconnect(),document.removeEventListener("visibilitychange",a)},get isInView(){return n}}}function ve(){let e,t,r=new Promise((r,n)=>{e=r,t=n});return Object.assign(r,{resolve:e,reject:t}),r}function me(e,t){if(!t||!t.length)return 0;if(1===t.length&&t.end(0)-t.start(0)<1e-6)return 0;let r=0;for(let n=t.length-1;n>=0&&t.end(n)>e;--n)r+=t.end(n)-Math.max(t.start(n),e);return r}function ge(e,t){let r=e;for(let n=0;n<t.length;n++)if(t.start(n)<=e&&t.end(n)>=e){r=t.end(n);break}return r-e}function Ee(){return void 0!==window.performance&&"function"==typeof window.performance.now?window.performance.now():Date.now()}function Te(){return Math.trunc(Ee()/1e3)}function ye(e){return Te()-e}function Se(e){return Ee()-e}const be=e=>Math.trunc(Date.now()/1e3)-e;function Ae(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^16*Math.random()>>e/4).toString(16))}function Ie(e,t){this.headers={},this.perfTimings={},j(this,t),this.ok=2==(this.status/100|0),this.body=e,this.text=()=>Promise.resolve(e),this.json=()=>Promise.resolve(JSON.parse(e)),this.blob=()=>Promise.resolve(new Blob([e])),this.arrayBuffer=()=>Promise.resolve(e),this.clone=()=>new Ie(e,this),this.isVimeoResponse=!0}class we extends Error{constructor(){super("The operation was aborted."),this.name="AbortError"}}class Re extends Error{constructor(e){super(e.statusText),this.name="HTTPError",this.response=e}}class Pe extends Error{constructor(){super("A network error occurred."),this.name="NetworkError"}}class De extends Error{constructor(e){super("Request timed out."),this.name="TimeoutError",this.timeoutMs=e}}function Le(e,t){let{url:r,method:n,body:i,onDownloadProgress:s}=e,a=100;return new Promise(function(o,c){const u=t?new t:new XMLHttpRequest,l=window.performance;u.open(n.toUpperCase(),r,e.async),e.timeout&&(u.timeout=e.timeout),u.onload=function(){if(0===u.status&&(!u.responseURL||0!==u.responseURL.indexOf("file:")))return;const e={};u.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,(t,r,n)=>{e[r]=e[r]?`${e[r]},${n}`:n});let t={};if(window.performance&&void 0!==window.performance.getEntriesByType){const e=window.performance.getEntriesByType("resource");if(e.length&&e.length>=a&&("function"==typeof l.clearResourceTimings&&l.clearResourceTimings(),"function"==typeof l.setResourceTimingBufferSize&&(l.setResourceTimingBufferSize(500),a=500)),e.length){const r=e.filter(e=>e.name===u.responseURL).sort((e,t)=>e.connectStart-t.connectStart);r.length&&(t=r[r.length-1].toJSON())}}o(new Ie(u.response,{headers:e,statusText:u.statusText,status:u.status,url:u.responseURL,perfTimings:t}))},u.onabort=function(){c(new we)},u.onerror=function(){c(new Pe)},u.ontimeout=function(){c(new De(e.timeout))},"function"==typeof s&&u.addEventListener("progress",s);for(let t in e.headers)u.setRequestHeader(t,e.headers[t]);e.withCredentials&&(u.withCredentials=!0),e.responseType&&(u.responseType=e.responseType),e.abort=u.abort.bind(u),u.send(i||null)})}const ke=.3;function Ce(){}function Oe(e,t,r){if(!e.s){if(r instanceof Ne){if(!r.s)return void(r.o=Oe.bind(null,e,t));1&t&&(t=r.s),r=r.v}if(r&&r.then)return void r.then(Oe.bind(null,e,t),Oe.bind(null,e,2));e.s=t,e.v=r;const n=e.o;n&&n(e)}}const Ne=function(){function e(){}return e.prototype.then=function(t,r){const n=new e,i=this.s;if(i){const e=1&i?t:r;if(e){try{Oe(n,1,e(this.v))}catch(e){Oe(n,2,e)}return n}return this}return this.o=function(e){try{const i=e.v;1&e.s?Oe(n,1,t?t(i):i):r?Oe(n,1,r(i)):Oe(n,2,i)}catch(e){Oe(n,2,e)}},n},e}();function Me(e){return e instanceof Ne&&1&e.s}function xe(e){const t=function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}(function(n){return function(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}(n,function(i){let s=!1;const a=function(t){if(!e.retryAbortErrors&&t instanceof we)return 0;if(t instanceof De)return 0;if(r>=e.retry)return 0;if(t instanceof Re){if(!e.retryStatus(t.response.status))return 0;const r=function(e){const t="retry-after".toLowerCase();for(const r in e)if(r.toLowerCase()===t)return e[r];return null}(t.response.headers);if(r&&e.retryStatus(t.response.status)){let e=Number(r);return isNaN(e)?e=Date.parse(r)-Date.now():e*=1e3,e}if(413===t.response.status)return 0}return ke*2**(r-1)*1e3}(i);return r++,function(o,c){var u=function(){if(0!==a&&r>0)return function(e,t){return void 0?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}(A(a),function(){var a;const o=(null==e||null==(a=e.hooks)?void 0:a.beforeRetry)||[];return function(e,t){return e&&e.then?e.then(t):t(e)}(function(e,t,r){var n,i,s=-1;return function a(o){try{for(;++s<e.length&&(!r||!r());)if((o=t(s))&&o.then){if(!Me(o))return void o.then(a,i||(i=Oe.bind(null,n=new Ne,2)));o=o.v}n?Oe(n,1,o):n=o}catch(e){Oe(n||(n=new Ne),2,e)}}(),n}(o,function(t){return function(e){if(!void 0)return e&&e.then?e.then(Ce):Promise.resolve()}((0,o[t])(e,i,r))}),function(){const e=t(n);return s=!0,e})})}();return u&&u.then?u.then(c):c(u)}(0,function(t){if(s)return t;if(e.throwHttpErrors)throw i})})});let r=0;return t}function Ue(e,t){const r=e.then.bind(e);return Object.assign(e,{abort:t,then:(...e)=>Ue(r.apply(void 0,e),t)})}function Fe(e,t,r){return r?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function Ve(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}function je(e,t,r){if(!e.s){if(r instanceof He){if(!r.s)return void(r.o=je.bind(null,e,t));1&t&&(t=r.s),r=r.v}if(r&&r.then)return void r.then(je.bind(null,e,t),je.bind(null,e,2));e.s=t,e.v=r;const n=e.o;n&&n(e)}}const He=function(){function e(){}return e.prototype.then=function(t,r){const n=new e,i=this.s;if(i){const e=1&i?t:r;if(e){try{je(n,1,e(this.v))}catch(e){je(n,2,e)}return n}return this}return this.o=function(e){try{const i=e.v;1&e.s?je(n,1,t?t(i):i):r?je(n,1,r(i)):je(n,2,i)}catch(e){je(n,2,e)}},n},e}();function Be(e){return e instanceof He&&1&e.s}function Xe(e,t,r){var n,i,s=-1;return function a(o){try{for(;++s<e.length&&(!r||!r());)if((o=t(s))&&o.then){if(!Be(o))return void o.then(a,i||(i=je.bind(null,n=new He,2)));o=o.v}n?je(n,1,o):n=o}catch(e){je(n||(n=new He),2,e)}}(),n}function We(e,t){return e&&e.then?e.then(t):t(e)}const qe=["get","post","put","patch","head","delete"],Ge={json:"application/json",text:"text/plain",arrayBuffer:"*/*",blob:"*/*"},Ke=["get"];function Ye(e,t){const r=Ve(function(){let e=!1,r=!1;const n=t.hooks.beforeRequest||[];return We(Xe(n,function(i){return Fe((0,n[i])(t),function(n){if(n instanceof $e)return t=n,void(r=!0);if(null!=n&&n.isVimeoResponse){const r=Promise.resolve(n).then(ze(t));return e=!0,r}})},function(){return r||e}),function(r){return e?r:Le(t).then(ze(t))})});t=new $e(e,t);const{method:n,json:i,jwt:s,searchParams:a}=t;i&&(t.headers["Content-Type"]=Ge.json,t.body=JSON.stringify(i)),s&&(t.headers.Authorization=`jwt ${s}`),a&&(t.url=k(t.url,a));const o=-1!==Ke.indexOf(n.toLowerCase())?xe(t)(r):r();for(const e in Ge)o[e]=Ve(function(){return t.headers["Content-Type"]=Ge[e],Fe(o,function(t){return t.clone()[e]()})});return Ue(o,()=>t.abort())}function $e(e,r){j(this,t,e="string"==typeof e?{url:e}:e,r)}function ze(e){const{validateStatus:t,throwHttpErrors:r,hooks:n}=e;return Ve(function(i){const s=n.afterResponse||[];return We(Xe(s,function(t){return Fe((0,s[t])(e,i.clone()),function(e){e instanceof Ie&&(i=e)})}),function(){if(!t||t(i.status))return i;if(r)throw new Re(i);return i})})}qe.forEach(function(e){return Ye[e]=(t,r)=>Ye(t,f({method:e},r)),Ye[e]});const{get:Qe,post:Je,put:Ze,patch:et,head:tt}=Ye,rt={ARRAY_BUFFER:"arraybuffer"};var nt=Object.freeze({__proto__:null,ContentTypes:e,defaults:t,requestMethods:qe,responseTypes:Ge,retryMethods:Ke,request:Ye,Request:$e,get:Qe,post:Je,put:Ze,patch:et,head:tt,Response:Ie,ResponseTypes:rt,AbortError:we,HTTPError:Re,NetworkError:Pe,TimeoutError:De,xhr:Le}),it=Array.isArray,st="object"==typeof global&&global&&global.Object===Object&&global,at="object"==typeof self&&self&&self.Object===Object&&self,ot=st||at||Function("return this")(),ct=ot.Symbol,ut=Object.prototype,lt=ut.hasOwnProperty,ht=ut.toString,dt=ct?ct.toStringTag:void 0,ft=Object.prototype.toString,_t=ct?ct.toStringTag:void 0;function pt(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":_t&&_t in Object(e)?function(e){var t=lt.call(e,dt),r=e[dt];try{e[dt]=void 0;var n=!0}catch(e){}var i=ht.call(e);return n&&(t?e[dt]=r:delete e[dt]),i}(e):function(e){return ft.call(e)}(e)}function vt(e){return null!=e&&"object"==typeof e}function mt(e){return"symbol"==typeof e||vt(e)&&"[object Symbol]"==pt(e)}var gt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Et=/^\w*$/;function Tt(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function yt(e){if(!Tt(e))return!1;var t=pt(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}var St=ot["__core-js_shared__"],bt=function(){var e=/[^.]+$/.exec(St&&St.keys&&St.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),At=Function.prototype.toString;function It(e){if(null!=e){try{return At.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var wt=/^\[object .+?Constructor\]$/,Rt=Function.prototype,Pt=Object.prototype,Dt=Rt.toString,Lt=Pt.hasOwnProperty,kt=RegExp("^"+Dt.call(Lt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Ct(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!Tt(e)||function(e){return!!bt&&bt in e}(e))&&(yt(e)?kt:wt).test(It(e))}(r)?r:void 0}var Ot=Ct(Object,"create"),Nt=Object.prototype.hasOwnProperty,Mt=Object.prototype.hasOwnProperty;function xt(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Ut(e,t){return e===t||e!=e&&t!=t}function Ft(e,t){for(var r=e.length;r--;)if(Ut(e[r][0],t))return r;return-1}xt.prototype.clear=function(){this.__data__=Ot?Ot(null):{},this.size=0},xt.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},xt.prototype.get=function(e){var t=this.__data__;if(Ot){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return Nt.call(t,e)?t[e]:void 0},xt.prototype.has=function(e){var t=this.__data__;return Ot?void 0!==t[e]:Mt.call(t,e)},xt.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Ot&&void 0===t?"__lodash_hash_undefined__":t,this};var Vt=Array.prototype.splice;function jt(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}jt.prototype.clear=function(){this.__data__=[],this.size=0},jt.prototype.delete=function(e){var t=this.__data__,r=Ft(t,e);return!(r<0||(r==t.length-1?t.pop():Vt.call(t,r,1),--this.size,0))},jt.prototype.get=function(e){var t=this.__data__,r=Ft(t,e);return r<0?void 0:t[r][1]},jt.prototype.has=function(e){return Ft(this.__data__,e)>-1},jt.prototype.set=function(e,t){var r=this.__data__,n=Ft(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};var Ht=Ct(ot,"Map");function Bt(e,t){var r=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?r["string"==typeof t?"string":"hash"]:r.map}function Xt(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Wt(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function r(){var n=arguments,i=t?t.apply(this,n):n[0],s=r.cache;if(s.has(i))return s.get(i);var a=e.apply(this,n);return r.cache=s.set(i,a)||s,a};return r.cache=new(Wt.Cache||Xt),r}Xt.prototype.clear=function(){this.size=0,this.__data__={hash:new xt,map:new(Ht||jt),string:new xt}},Xt.prototype.delete=function(e){var t=Bt(this,e).delete(e);return this.size-=t?1:0,t},Xt.prototype.get=function(e){return Bt(this,e).get(e)},Xt.prototype.has=function(e){return Bt(this,e).has(e)},Xt.prototype.set=function(e,t){var r=Bt(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},Wt.Cache=Xt;var qt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Gt=/\\(\\)?/g,Kt=function(){var e=Wt(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(qt,function(e,r,n,i){t.push(n?i.replace(Gt,"$1"):r||e)}),t},function(e){return 500===t.size&&t.clear(),e}),t=e.cache;return e}(),Yt=ct?ct.prototype:void 0,$t=Yt?Yt.toString:void 0;function zt(e){if("string"==typeof e)return e;if(it(e))return function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}(e,zt)+"";if(mt(e))return $t?$t.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Qt(e){return null==e?"":zt(e)}function Jt(e,t){return it(e)?e:function(e,t){if(it(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!mt(e))||Et.test(e)||!gt.test(e)||null!=t&&e in Object(t)}(e,t)?[e]:Kt(Qt(e))}function Zt(e){if("string"==typeof e||mt(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function er(e,t){for(var r=0,n=(t=Jt(t,e)).length;null!=e&&r<n;)e=e[Zt(t[r++])];return r&&r==n?e:void 0}function tr(e,t,r){var n=null==e?void 0:er(e,t);return void 0===n?r:n}var rr="object"==typeof global&&global&&global.Object===Object&&global,nr="object"==typeof self&&self&&self.Object===Object&&self,ir=(rr||nr||Function("return this")()).Symbol,sr=Object.prototype,ar=sr.hasOwnProperty,or=sr.toString,cr=ir?ir.toStringTag:void 0,ur=Object.prototype.toString,lr=ir?ir.toStringTag:void 0;var hr=function(e,t){return function(r){return e(t(r))}}(Object.getPrototypeOf,Object),dr=Function.prototype,fr=Object.prototype,_r=dr.toString,pr=fr.hasOwnProperty,vr=_r.call(Object),mr=function(){var e,t=("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")()).Symbol;return"function"==typeof t?t.observable?e=t.observable:(e=t("observable"),t.observable=e):e="@@observable",e}(),gr="@@redux/INIT";function Er(e,t,r){var n;if("function"==typeof t&&void 0===r&&(r=t,t=void 0),void 0!==r){if("function"!=typeof r)throw new Error("Expected the enhancer to be a function.");return r(Er)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var i=e,s=t,a=[],o=a,c=!1;function u(){o===a&&(o=a.slice())}function l(){return s}function h(e){if("function"!=typeof e)throw new Error("Expected listener to be a function.");var t=!0;return u(),o.push(e),function(){if(t){t=!1,u();var r=o.indexOf(e);o.splice(r,1)}}}function d(e){if(!function(e){if(!function(e){return null!=e&&"object"==typeof e}(e)||"[object Object]"!=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":lr&&lr in Object(e)?function(e){var t=ar.call(e,cr),r=e[cr];try{e[cr]=void 0;var n=!0}catch(e){}var i=or.call(e);return n&&(t?e[cr]=r:delete e[cr]),i}(e):function(e){return ur.call(e)}(e)}(e))return!1;var t=hr(e);if(null===t)return!0;var r=pr.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&_r.call(r)==vr}(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(c)throw new Error("Reducers may not dispatch actions.");try{c=!0,s=i(s,e)}finally{c=!1}for(var t=a=o,r=0;r<t.length;r++)(0,t[r])();return e}return d({type:gr}),(n={dispatch:d,subscribe:h,getState:l,replaceReducer:function(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");i=e,d({type:gr})}})[mr]=function(){var e,t=h;return(e={subscribe:function(e){if("object"!=typeof e)throw new TypeError("Expected the observer to be an object.");function r(){e.next&&e.next(l())}return r(),{unsubscribe:t(r)}}})[mr]=function(){return this},e},n}function Tr(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}var yr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function Sr(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return function(r,n,i){var s,a=e(r,n,i),o=a.dispatch,c={getState:a.getState,dispatch:function(e){return o(e)}};return s=t.map(function(e){return e(c)}),o=Tr.apply(void 0,s)(a.dispatch),yr({},a,{dispatch:o})}}}var br=new WeakMap,Ar=new WeakMap;class Ir{constructor(){a(this,br,Object.create(null)),a(this,Ar,void 0),l(this,"eventNames",()=>Object.keys(s(br,this))),l(this,"fire",(e,...t)=>{if(!e)throw new Error("Tried to fire an undefined event.");if(e in s(br,this)){const r=s(br,this)[e].slice(0);for(let e=0,n=r.length;e<n;e++)if(r[e].apply(this,t),s(Ar,this)){o(Ar,this,!1);break}}return this}),l(this,"halt",()=>(o(Ar,this,!0),this)),l(this,"on",(e,t,r)=>{const n=[].concat(e);for(let e=0,i=n.length;e<i;e++){const i=n[e];if(!i)throw new Error("Tried to listen for an undefined event.");s(br,this)[i]||(s(br,this)[i]=[]),r?s(br,this)[i].unshift(t):s(br,this)[i].push(t)}return this}),l(this,"once",(e,t,r)=>{const n=(...r)=>{this.off(e,n),t.apply(this,r)};return n.handler=t,this.on(e,n,r)}),l(this,"off",(e,t)=>{if(!e)return o(br,this,Object.create(null)),this;const r=[].concat(e);for(let e=0,n=r.length;e<n;e++){const n=r[e];if(!n)throw new Error("Tried to remove an undefined event.");if(n in s(br,this)){const e=s(br,this)[n];if(t){let r=e.indexOf(t);if(-1===r)for(let n=0,i=e.length;n<i;n++)if(e[n].handler===t){r=n;break}if(-1===r)return this;e.splice(r,1),0===e.length&&delete s(br,this)[n]}else delete s(br,this)[n]}}return this}),l(this,"prependOn",(e,t)=>this.on(e,t,!0))}static extend(e){return Object.assign(e,new Ir),e}}function wr(e){var t=this.__data__=new jt(e);this.size=t.size}wr.prototype.clear=function(){this.__data__=new jt,this.size=0},wr.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},wr.prototype.get=function(e){return this.__data__.get(e)},wr.prototype.has=function(e){return this.__data__.has(e)},wr.prototype.set=function(e,t){var r=this.__data__;if(r instanceof jt){var n=r.__data__;if(!Ht||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Xt(n)}return r.set(e,t),this.size=r.size,this};var Rr=function(){try{var e=Ct(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();function Pr(e,t,r){"__proto__"==t&&Rr?Rr(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var Dr=Object.prototype.hasOwnProperty;function Lr(e,t,r){var n=e[t];Dr.call(e,t)&&Ut(n,r)&&(void 0!==r||t in e)||Pr(e,t,r)}function kr(e,t,r,n){var i=!r;r||(r={});for(var s=-1,a=t.length;++s<a;){var o=t[s],c=n?n(r[o],e[o],o,r,e):void 0;void 0===c&&(c=e[o]),i?Pr(r,o,c):Lr(r,o,c)}return r}function Cr(e){return vt(e)&&"[object Arguments]"==pt(e)}var Or=Object.prototype,Nr=Or.hasOwnProperty,Mr=Or.propertyIsEnumerable,xr=Cr(function(){return arguments}())?Cr:function(e){return vt(e)&&Nr.call(e,"callee")&&!Mr.call(e,"callee")},Ur="object"==typeof exports&&exports&&!exports.nodeType&&exports,Fr=Ur&&"object"==typeof module&&module&&!module.nodeType&&module,Vr=Fr&&Fr.exports===Ur?ot.Buffer:void 0,jr=(Vr?Vr.isBuffer:void 0)||function(){return!1},Hr=/^(?:0|[1-9]\d*)$/;function Br(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&Hr.test(e))&&e>-1&&e%1==0&&e<t}function Xr(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}var Wr={};function qr(e){return function(t){return e(t)}}Wr["[object Float32Array]"]=Wr["[object Float64Array]"]=Wr["[object Int8Array]"]=Wr["[object Int16Array]"]=Wr["[object Int32Array]"]=Wr["[object Uint8Array]"]=Wr["[object Uint8ClampedArray]"]=Wr["[object Uint16Array]"]=Wr["[object Uint32Array]"]=!0,Wr["[object Arguments]"]=Wr["[object Array]"]=Wr["[object ArrayBuffer]"]=Wr["[object Boolean]"]=Wr["[object DataView]"]=Wr["[object Date]"]=Wr["[object Error]"]=Wr["[object Function]"]=Wr["[object Map]"]=Wr["[object Number]"]=Wr["[object Object]"]=Wr["[object RegExp]"]=Wr["[object Set]"]=Wr["[object String]"]=Wr["[object WeakMap]"]=!1;var Gr="object"==typeof exports&&exports&&!exports.nodeType&&exports,Kr=Gr&&"object"==typeof module&&module&&!module.nodeType&&module,Yr=Kr&&Kr.exports===Gr&&st.process,$r=function(){try{return Kr&&Kr.require&&Kr.require("util").types||Yr&&Yr.binding&&Yr.binding("util")}catch(e){}}(),zr=$r&&$r.isTypedArray,Qr=zr?qr(zr):function(e){return vt(e)&&Xr(e.length)&&!!Wr[pt(e)]},Jr=Object.prototype.hasOwnProperty;function Zr(e,t){var r=it(e),n=!r&&xr(e),i=!r&&!n&&jr(e),s=!r&&!n&&!i&&Qr(e),a=r||n||i||s,o=a?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],c=o.length;for(var u in e)!t&&!Jr.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||s&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Br(u,c))||o.push(u);return o}var en=Object.prototype;function tn(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||en)}function rn(e,t){return function(r){return e(t(r))}}var nn=rn(Object.keys,Object),sn=Object.prototype.hasOwnProperty;function an(e){if(!tn(e))return nn(e);var t=[];for(var r in Object(e))sn.call(e,r)&&"constructor"!=r&&t.push(r);return t}function on(e){return null!=e&&Xr(e.length)&&!yt(e)}function cn(e){return on(e)?Zr(e):an(e)}var un=Object.prototype.hasOwnProperty;function ln(e){return on(e)?Zr(e,!0):function(e){if(!Tt(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t=tn(e),r=[];for(var n in e)("constructor"!=n||!t&&un.call(e,n))&&r.push(n);return r}(e)}var hn="object"==typeof exports&&exports&&!exports.nodeType&&exports,dn=hn&&"object"==typeof module&&module&&!module.nodeType&&module,fn=dn&&dn.exports===hn?ot.Buffer:void 0,_n=fn?fn.allocUnsafe:void 0;function pn(e,t){if(t)return e.slice();var r=e.length,n=_n?_n(r):new e.constructor(r);return e.copy(n),n}function vn(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}function mn(){return[]}var gn=Object.prototype.propertyIsEnumerable,En=Object.getOwnPropertySymbols,Tn=En?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,s=[];++r<n;){var a=e[r];t(a)&&(s[i++]=a)}return s}(En(e),function(t){return gn.call(e,t)}))}:mn;function yn(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}var Sn=rn(Object.getPrototypeOf,Object),bn=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)yn(t,Tn(e)),e=Sn(e);return t}:mn;function An(e,t,r){var n=t(e);return it(e)?n:yn(n,r(e))}function In(e){return An(e,cn,Tn)}function wn(e){return An(e,ln,bn)}var Rn=Ct(ot,"DataView"),Pn=Ct(ot,"Promise"),Dn=Ct(ot,"Set"),Ln=Ct(ot,"WeakMap"),kn="[object Map]",Cn="[object Promise]",On="[object Set]",Nn="[object WeakMap]",Mn="[object DataView]",xn=It(Rn),Un=It(Ht),Fn=It(Pn),Vn=It(Dn),jn=It(Ln),Hn=pt;(Rn&&Hn(new Rn(new ArrayBuffer(1)))!=Mn||Ht&&Hn(new Ht)!=kn||Pn&&Hn(Pn.resolve())!=Cn||Dn&&Hn(new Dn)!=On||Ln&&Hn(new Ln)!=Nn)&&(Hn=function(e){var t=pt(e),r="[object Object]"==t?e.constructor:void 0,n=r?It(r):"";if(n)switch(n){case xn:return Mn;case Un:return kn;case Fn:return Cn;case Vn:return On;case jn:return Nn}return t});var Bn=Hn,Xn=Object.prototype.hasOwnProperty,Wn=ot.Uint8Array;function qn(e){var t=new e.constructor(e.byteLength);return new Wn(t).set(new Wn(e)),t}var Gn=/\w*$/,Kn=ct?ct.prototype:void 0,Yn=Kn?Kn.valueOf:void 0;function $n(e,t){var r=t?qn(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var zn=Object.create,Qn=function(){function e(){}return function(t){if(!Tt(t))return{};if(zn)return zn(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();function Jn(e){return"function"!=typeof e.constructor||tn(e)?{}:Qn(Sn(e))}var Zn=$r&&$r.isMap,ei=Zn?qr(Zn):function(e){return vt(e)&&"[object Map]"==Bn(e)},ti=$r&&$r.isSet,ri=ti?qr(ti):function(e){return vt(e)&&"[object Set]"==Bn(e)},ni="[object Arguments]",ii="[object Function]",si="[object Object]",ai={};function oi(e,t,r,n,i,s){var a,o=1&t,c=2&t,u=4&t;if(r&&(a=i?r(e,n,i,s):r(e)),void 0!==a)return a;if(!Tt(e))return e;var l=it(e);if(l){if(a=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&Xn.call(e,"index")&&(r.index=e.index,r.input=e.input),r}(e),!o)return vn(e,a)}else{var h=Bn(e),d=h==ii||"[object GeneratorFunction]"==h;if(jr(e))return pn(e,o);if(h==si||h==ni||d&&!i){if(a=c||d?{}:Jn(e),!o)return c?function(e,t){return kr(e,bn(e),t)}(e,function(e,t){return e&&kr(t,ln(t),e)}(a,e)):function(e,t){return kr(e,Tn(e),t)}(e,function(e,t){return e&&kr(t,cn(t),e)}(a,e))}else{if(!ai[h])return i?e:{};a=function(e,t,r){var n=e.constructor;switch(t){case"[object ArrayBuffer]":return qn(e);case"[object Boolean]":case"[object Date]":return new n(+e);case"[object DataView]":return function(e,t){var r=t?qn(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return $n(e,r);case"[object Map]":case"[object Set]":return new n;case"[object Number]":case"[object String]":return new n(e);case"[object RegExp]":return function(e){var t=new e.constructor(e.source,Gn.exec(e));return t.lastIndex=e.lastIndex,t}(e);case"[object Symbol]":return function(e){return Yn?Object(Yn.call(e)):{}}(e)}}(e,h,o)}}s||(s=new wr);var f=s.get(e);if(f)return f;s.set(e,a),ri(e)?e.forEach(function(n){a.add(oi(n,t,r,n,e,s))}):ei(e)&&e.forEach(function(n,i){a.set(i,oi(n,t,r,i,e,s))});var _=l?void 0:(u?c?wn:In:c?ln:cn)(e);return function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r););}(_||e,function(n,i){_&&(n=e[i=n]),Lr(a,i,oi(n,t,r,i,e,s))}),a}function ci(e){return oi(e,5)}function ui(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function li(e){return e}ai[ni]=ai["[object Array]"]=ai["[object ArrayBuffer]"]=ai["[object DataView]"]=ai["[object Boolean]"]=ai["[object Date]"]=ai["[object Float32Array]"]=ai["[object Float64Array]"]=ai["[object Int8Array]"]=ai["[object Int16Array]"]=ai["[object Int32Array]"]=ai["[object Map]"]=ai["[object Number]"]=ai[si]=ai["[object RegExp]"]=ai["[object Set]"]=ai["[object String]"]=ai["[object Symbol]"]=ai["[object Uint8Array]"]=ai["[object Uint8ClampedArray]"]=ai["[object Uint16Array]"]=ai["[object Uint32Array]"]=!0,ai["[object Error]"]=ai[ii]=ai["[object WeakMap]"]=!1;var hi=Math.max;function di(e,t,r){return t=hi(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,s=hi(n.length-t,0),a=Array(s);++i<s;)a[i]=n[t+i];i=-1;for(var o=Array(t+1);++i<t;)o[i]=n[i];return o[t]=r(a),ui(e,this,o)}}function fi(e){return function(){return e}}var _i=Rr?function(e,t){return Rr(e,"toString",{configurable:!0,enumerable:!1,value:fi(t),writable:!0})}:li,pi=Date.now,vi=function(e){var t=0,r=0;return function(){var n=pi(),i=16-(n-r);if(r=n,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(_i);function mi(e,t){return vi(di(e,t,li),e+"")}function gi(e,t,r){(void 0!==r&&!Ut(e[t],r)||void 0===r&&!(t in e))&&Pr(e,t,r)}var Ei=function(e,t,r){for(var n=-1,i=Object(e),s=r(e),a=s.length;a--;){var o=s[++n];if(!1===t(i[o],o,i))break}return e},Ti=Function.prototype,yi=Object.prototype,Si=Ti.toString,bi=yi.hasOwnProperty,Ai=Si.call(Object);function Ii(e){if(!vt(e)||"[object Object]"!=pt(e))return!1;var t=Sn(e);if(null===t)return!0;var r=bi.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&Si.call(r)==Ai}function wi(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function Ri(e,t,r,n,i){e!==t&&Ei(t,function(s,a){if(i||(i=new wr),Tt(s))!function(e,t,r,n,i,s,a){var o=wi(e,r),c=wi(t,r),u=a.get(c);if(u)gi(e,r,u);else{var l=s?s(o,c,r+"",e,t,a):void 0,h=void 0===l;if(h){var d=it(c),f=!d&&jr(c),_=!d&&!f&&Qr(c);l=c,d||f||_?it(o)?l=o:function(e){return vt(e)&&on(e)}(o)?l=vn(o):f?(h=!1,l=pn(c,!0)):_?(h=!1,l=$n(c,!0)):l=[]:Ii(c)||xr(c)?(l=o,xr(o)?l=function(e){return kr(e,ln(e))}(o):Tt(o)&&!yt(o)||(l=Jn(c))):h=!1}h&&(a.set(c,l),i(l,c,n,s,a),a.delete(c)),gi(e,r,l)}}(e,t,a,r,Ri,n,i);else{var o=n?n(wi(e,a),s,a+"",e,t,i):void 0;void 0===o&&(o=s),gi(e,a,o)}},ln)}function Pi(e,t,r,n,i,s){return Tt(e)&&Tt(t)&&(s.set(t,e),Ri(e,t,void 0,Pi,s),s.delete(t)),e}function Di(e){return mi(function(t,r){var n=-1,i=r.length,s=i>1?r[i-1]:void 0,a=i>2?r[2]:void 0;for(s=e.length>3&&"function"==typeof s?(i--,s):void 0,a&&function(e,t,r){if(!Tt(r))return!1;var n=typeof t;return!!("number"==n?on(r)&&Br(t,r.length):"string"==n&&t in r)&&Ut(r[t],e)}(r[0],r[1],a)&&(s=i<3?void 0:s,i=1),t=Object(t);++n<i;){var o=r[n];o&&e(t,o,n,s)}return t})}var Li=Di(function(e,t,r,n){Ri(e,t,r,n)}),ki=mi(function(e){return e.push(void 0,Pi),ui(Li,void 0,e)});class Ci extends Ir{static get displayName(){return"ExternalDisplay"}static get supported(){return!1}static get supportedVideoTypes(){return[]}constructor(e){super(),this._available=!1,this._active=!1,this._video=e}get active(){return this._active}get available(){return this._available}get element(){return document.createElement("div")}showPicker(){}getFile(){var e;const t=this.constructor.displayName.replace("ExternalDisplay","");if(null!=(e=this._video.externalDisplayFiles)&&e[t])return this._video.externalDisplayFiles[t];const r=this.constructor.supportedVideoTypes,n=this._video.files.filter(e=>-1!==r.indexOf(e.mime)).sort((e,t)=>e.mime===t.mime?e.priority-t.priority:r.indexOf(e.mime)-r.indexOf(t.mime));if(!n.length)throw new Error(`No files available for ${this.constructor.displayName} external display.`);return n[0]}}const Oi={ABORT:"abort",CAN_PLAY:"canplay",CAN_PLAY_THROUGH:"canplaythrough",DURATION_CHANGE:"durationchange",EMPTIED:"emptied",ENDED:"ended",ENTER_PICTURE_IN_PICTURE:"enterpictureinpicture",LEAVE_PICTURE_IN_PICTURE:"leavepictureinpicture",ERROR:"error",LOADED_DATA:"loadeddata",LOADED_METADATA:"loadedmetadata",LOAD_START:"loadstart",PAUSE:"pause",PLAY:"play",PLAYING:"playing",PROGRESS:"progress",RATE_CHANGE:"ratechange",RESIZE:"resize",SEEKED:"seeked",SEEKING:"seeking",STALLED:"stalled",SUSPEND:"suspend",TIME_UPDATE:"timeupdate",VOLUME_CHANGE:"volumechange",WAITING:"waiting",WEBKIT_BEGIN_FULLSCREEN:"webkitbeginfullscreen",WEBKIT_END_FULLSCREEN:"webkitendfullscreen",WEBKIT_PRESENTATION_MODE_CHANGED:"webkitpresentationmodechanged"},Ni={ADD_TRACK:"addtrack",REMOVE_TRACK:"removetrack",CHANGE:"change"},Mi={AVAILABLE:"externaldisplayavailable",UNAVAILABLE:"externaldisplayunavailable",ACTIVATED:"externaldisplayactivated",DEACTIVATED:"externaldisplaydeactivated"},xi={AIRPLAY_AVAILABLE:"available",AIRPLAY_UNAVAILABLE:"unavailable",AIRPLAY_ACTIVATED:"activated",AIRPLAY_DEACTIVATED:"deactivated"},Ui={SCANNER_CHANGE:"scannerchange",SCANNER_ERROR:"scannererror",FILE_ERROR:"fileerror",FILE_SRC_UPDATE:"filesrcupdate",DOWNLOAD_START:"downloadstart",DOWNLOAD_END:"downloadend",DOWNLOAD_ERROR:"downloaderror",DOWNLOAD_TIMEOUT:"downloadtimeout",DRM_AUTH_FAILURE:"drmauthfailure",DRM_AUTH_SUCCESS:"drmauthsuccess",DRM_CDM_CHANGE:"drmcdmchange",DRM_FAILURE:"drmfailure",DRM_KEY_SWITCH:"drmkeyswitch",DRM_OUTPUT_RESTRICTED:"drmoutputrestricted",EME_UNSUPPORTED:"emeunsupported",NO_SUPPORTED_CDM:"nosupportedcdm",CURRENT_FILE_CHANGE:"currentfilechange",MEDIA_URL_EXPIRED:"mediaurlexpired",MEDIA_URL_BAD_REQUEST:"mediaurlbadrequest",STREAM_CHANGE:"streamchange",STREAM_CHANGE_START:"streamchangestart",STREAM_UPDATED:"streamupdated",STREAM_BUFFER_START:"streambufferstart",STREAM_BUFFER_END:"streambufferend",AVAILABLE_STREAMS_CHANGED:"availablestreamschanged",MEDIA_CAPABILITY_STREAMS_UNSUPPORTED:"mediacapabilitystreamsunsupported",DROPPED_FRAMES:"droppedframes",BANDWIDTH:"bandwidth",STREAM_TARGET_CHANGE:"streamtargetchange",CUE_POINT:"cuepoint",BUFFER_OCCUPANCY:"bufferoccupancy",MANIFEST_TIMEOUT:"manifesttimeout",MANIFEST_LOADED:"manifestloaded",STREAMS_LOADED:"streamsloaded",TEXT_SRC_UPDATE:"texttracksrcupdate",TEXT_TRACKS_AVAILABLE:"texttracksavailable",AV_DURATION_MISMATCH:"avdurationmismatch",BUFFER_STARTED:"bufferstarted",BUFFER_ENDED:"bufferended",QUOTA_EXCEEDED_ERROR:"quotaexceedederror",CHAPTER_CUES_UPDATED:"chaptercuesupdated",APPEND_BUFFER_END:"appendbufferend",DROPPED_FRAME_PERCENT_EXCEEDED:"droppedframepercentexceeded",LOAD_SEGMENT_FAILED:"loadsegmentfailed",AUDIO_TRACK_CHANGED:"audiotrackchanged",SEGMENT_CUES_LOADED:"segmentcuesloaded",HLS_JS_ERROR:"hlsjserror"},Fi={STREAM_ONLINE:"livestreamonline",STREAM_OFFLINE:"livestreamoffline",BUFFER_GAP_JUMP:"livebuffergapjump",BUFFER_GAP_JUMP_PREVENT:"livebuffergapjumpprevent",STALL_JUMP:"livestalljump",LATENCY_UPDATED:"latencyupdated"},Vi={CAMERA_UPDATE:"cameraupdate",CAMERA_CHANGE:"camerachange",MOTION_START:"motionstart",MOTION_END:"motionend",SPATIAL_UNSUPPORTED:"spatialunsupported",WEBVR_ENTER:"entervr",WEBVR_EXIT:"exitvr",WEBVR_HARDWARE_AVAILABLE:"webvrhardwareavailable",AMBISONIC_UNSUPPORTED:"ambisonicunsupported"},ji={MEDIASESSION_PLAY:"mediasessionplay",MEDIASESSION_PAUSE:"mediasessionpause",MEDIASESSION_SEEK_FORWARD:"mediasessionseekforward",MEDIASESSION_SEEK_TO:"mediasessionseekto",MEDIASESSION_SEEK_BACKWARD:"mediasessionseekbackward"},Hi=Object.assign({},Oi,Ni,Mi,xi,Ui,Vi,Fi,ji),Bi="webkitplaybacktargetavailabilitychanged",Xi="webkitcurrentplaybacktargetiswirelesschanged";function Wi(e,t,r){return r?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function qi(){}class AirPlayExternalDisplay extends Ci{static get displayName(){return"AirPlayExternalDisplay"}static get supported(){return"WebKitPlaybackTargetAvailabilityEvent"in window}static get supportedVideoTypes(){return[b.hls,b.h264]}constructor(e){super(e),this._listenerLoadedMetadata=null,this._listenerAvailability=null,this._listenerTarget=null,this._videoElement=document.createElement("video"),this.createEventListeners(),this.addVideoEventListeners()}createEventListeners(){this._listenerLoadedMetadata=e=>{this.fire(Oi.LOADED_METADATA,e)},this._listenerAvailability=e=>{switch(e.availability){case"available":this._available||(this._available=!0,this.fire(xi.AIRPLAY_AVAILABLE));break;case"not-available":this._available&&(this._available=!1,this.fire(xi.AIRPLAY_UNAVAILABLE))}},this._listenerTarget=e=>{this._active=!!e.target.webkitCurrentPlaybackTargetIsWireless,this._active&&this._videoElement.play(),this.fire(this._active?xi.AIRPLAY_ACTIVATED:xi.AIRPLAY_DEACTIVATED)}}addVideoEventListeners(e=this._videoElement){e.addEventListener(Oi.LOADED_METADATA,this._listenerLoadedMetadata),e.addEventListener(Bi,this._listenerAvailability),e.addEventListener(Xi,this._listenerTarget)}removeVideoEventListeners(e=this._videoElement){e.removeEventListener(Oi.LOADED_METADATA,this._listenerLoadedMetadata),e.removeEventListener(Bi,this._listenerAvailability),e.removeEventListener(Xi,this._listenerTarget)}get element(){return this._videoElement}set element(e){if(!(e instanceof HTMLVideoElement))throw new TypeError("The element for AirPlay must be a <video>.");e!==this._videoElement&&(this.removeVideoEventListeners(this._videoElement),this._videoElement=e,this.addVideoEventListeners(e))}showPicker(){this._videoElement.webkitShowPlaybackTargetPicker(),this.loadMetadata().then(()=>this._videoElement.webkitShowPlaybackTargetPicker()).catch(e=>{})}loadMetadata(){const e=this;return function(e){try{var t=Promise.resolve(e());return t}catch(e){return Promise.reject(e)}}(function(){return e._videoElement.readyState>=1?Promise.resolve():Wi(new Promise(function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}(function(t,r){return e._videoElement.addEventListener(Oi.LOADED_METADATA,()=>{t()},{once:!0}),function(e){if(e&&e.then)return e.then(qi)}(function(t,r){try{var n=function(){let{src:t,mime:r}=e.getFile();const n=document.createElement("source");return n.type=r,Wi(O(t),function(t){n.src=t,e._videoElement.appendChild(n),e._videoElement.load()})}()}catch(e){return r(e)}return n&&n.then?n.then(void 0,r):n}(0,function(e){r(e)}))})))})}}const Gi=(()=>{const e=navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9]+)\.([0-9]+)\./);return!!e&&{major:parseInt(e[1],10),minor:parseInt(e[2],10)}})(),Ki=function(e){for(let t=0,r=this.length;t<r;t++)if(this[t].id===`${e}`)return this[t];return null};function Yi(e=[]){return e.item=function(e){return this[e]},e.getTrackById=Ki,e}function $i(e){const t=window.atob(e),r=t.length,n=new Uint8Array(r);for(let e=0;e<r;e++)n[e]=t.charCodeAt(e);return n}function zi(e,t,r,n){let i=0,s=0,a=0,o=0;const c=e,u=t,l=r/n;return c/u>=l?(s=u,i=(l*u).toFixed(2)):(i=c,s=(c/l).toFixed(2)),a=Math.max((c-i)/2,0),o=Math.max((u-s)/2,0),{width:i,height:s,left:a,top:o}}function Qi(e,t){let r=e;return t&&(r+=`;codecs="${t}"`),r}function Ji(e,t=3){if(e=parseFloat(e),isNaN(e))return 0;const r=Math.pow(10,t);return Math.round(e*r)/r}const Zi="telecine-snapshot",es=`[${Zi}]`,ts=(e,t)=>{let r=t.querySelector(es);r||(r=document.createElement("canvas"),r.setAttribute(Zi,""),t.appendChild(r)),r.setAttribute("width",`${t.clientWidth}px`),r.setAttribute("height",`${t.clientHeight}px`),r.style.display="";const{width:n,height:i,left:s,top:a}=zi(e.clientWidth,e.clientHeight,e.videoWidth,e.videoHeight);r.style.cssText=`position:absolute;width:${n}px;height:${i}px;left:${s}px;top:${a}px`;const o=r.getContext("2d");r.width>0&&r.height>0&&o.drawImage(e,0,0,r.width,r.height)},rs=e=>{const t=e.querySelector(es);t&&(t.style.display="none")};class TelecineError{constructor(e,t){this.name=e,this.message=t,Object.freeze(this)}}const ns=new WeakMap;class is{static fromVTTCue(e){if(ns.has(e))return ns.get(e);let t={};try{t=JSON.parse(e.text)}catch(e){}return new is(e.startTime,t)}constructor(e,t={}){const r=parseFloat(e);if(isNaN(r))throw new TypeError("Time must be a number.");if(r<0)throw new TypeError("Time must be a positive number.");this.time=e,this.data=t,this.id=Ae();try{const r="undefined"==typeof VTTCue?TextTrackCue:VTTCue;this.vttCue=new r(e,e+.25,JSON.stringify(t)),this.vttCue.id=this.id}catch(e){throw new TelecineError("CuePointsNotSupported","Cue points are not supported in this browser.")}ns.set(this.vttCue,this),Object.freeze(this)}}function ss(e,t,r){let n;try{document.removeChild({})}catch(i){n=Object.create(Object.getPrototypeOf(i),{name:{value:t,configurable:!0,writable:!0},code:{value:e,configurable:!0,writable:!0},message:{value:r,configurable:!0,writable:!0},toString:{value:()=>`${t}: DOM Exception ${e}`,configurable:!0,writable:!0}})}return Object.freeze(n)}const as=(e,t)=>{if(!e||void 0===e[t])throw ss(1,"INDEX_SIZE_ERR");return e[t]};function os(e=[],t=[]){return Object.freeze({get length(){return e.length},start:t=>as(e,t),end:e=>as(t,e),[Symbol.iterator]:()=>function(e,t){let r=0;return{[Symbol.iterator](){return this},next:()=>r<e.length?{done:!1,value:t?[e[r],t[r++]]:e[r++]}:{done:!0}}}(e,t)})}os.from=function(e){if(!(e instanceof TimeRanges))throw new TypeError("Can only create a TelecineTimeRange from a TimeRanges object.");const t=[],r=[];for(let n=0,i=e.length;n<i;n++)t.push(e.start(n)),r.push(e.end(n));return os(t,r)};const cs="DRMFailure",us="MediaUnknownError",ls="MediaUrlBadRequest",hs="PlayInterrupted",ds="TextTracksNotSupported",fs="NoSupportedCDM",_s="inline",ps="picture-in-picture";function vs(){}const ms=document.createElement("video"),gs={"application/vnd.apple.mpegurl":"application/vnd.apple.mpegurl","video/mp4":'video/mp4; codecs="avc1.64001E"',"video/webm":'video/webm; codecs="vp8, vorbis"',"video/x-flv":'video/x-flv; codecs="vp6"'},Es=function(){const e="undefined"==typeof TextTrack?{}:TextTrack;return{disabled:"DISABLED"in e?e.DISABLED:"disabled",hidden:"HIDDEN"in e?e.HIDDEN:"hidden",showing:"SHOWING"in e?e.SHOWING:"showing"}}();function Ts(e,t,r){return r?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}const ys=function(){const e=document.createElement("track");return"track"in e&&"oncuechange"in e.track}();function Ss(e,t,r){if(r)return t?t(e()):e();try{var n=Promise.resolve(e());return t?n.then(t):n}catch(e){return Promise.reject(e)}}const bs=new WeakMap;class As extends Ir{static get displayName(){return"HTMLScanner"}static get supportsMse(){return!1}static get supportsLive(){return!1}static supported(){return As.supportedVideoTypes.length>0}static get supportedVideoTypes(){const e=[];if("function"!=typeof ms.canPlayType)return e;for(const t in gs){const r=gs[t];ue.android&&t===b.hls||(ue.android&&!ue.mobileAndroid&&t===b.h264&&ue.android instanceof String?parseInt(ue.android.split(".")[0],10)>3&&e.push(t):t===b.hls&&ue.browser.chrome&&!ue.chromeHls||ms.canPlayType(r).replace(/^no$/,"")&&e.push(t))}return e}static get supportedAudioTypes(){return[]}static get supportedExternalDisplays(){return[AirPlayExternalDisplay]}static get supportsAudioTracksFromScanner(){return void 0!==ms.audioTracks&&this.supportedVideoTypes.includes(b.hls)}constructor(e,t={}){super(),this._element=e,this._options=t,this._telecineVideo=null,this._currentFile=null,this._externalDisplays=[];let r=e.querySelector("video");r||(r=document.createElement("video"),r.preload="none",this._element.appendChild(r)),r.setAttribute("tabindex","-1"),this._video=r,t.playRequest&&(this._playRequest=t.playRequest,this._playRequest.video=r),t.htmlScanner&&t.htmlScanner.controls&&(this._video.controls=!0),this._boundHandleVideoEvent=this.handleVideoEvent.bind(this),this._boundHandleAudioEvent=this.handleAudioEvent.bind(this),this.addVideoEventListeners(),this.addAudioEventListeners(),this._preload="none",this._externalDisplayActivated=!1,this._inFullscreen=!1,this._lastCurrentTime=-1,this._switchingVideo=!1,this._resetInViewTracking()}deactivate(){this._telecineVideo&&(this._telecineVideo.off(Ui.FILE_SRC_UPDATE),this._telecineVideo.off("texttracksrcupdate")),this.removeVideoEventListeners(),this.removeAudioEventListeners(),this._switchingVideo||this.removeSnapshot(),this._video.style.display="none",this._cleanUpInViewTracking()}reactivate(){this.addVideoEventListeners(),this.addAudioEventListeners(),this._video.style.display="",this._resetInViewTracking()}addVideoEventListeners(e=this._video){Object.keys(Oi).forEach(t=>{const r=Oi[t];e.addEventListener(r,this._boundHandleVideoEvent)})}addAudioEventListeners(e=this._video){var t;null!=e&&e.audioTracks&&"function"==typeof(null==(t=e.audioTracks)?void 0:t.addEventListener)&&(e.audioTracks.addEventListener(Ni.ADD_TRACK,this._boundHandleAudioEvent),e.audioTracks.addEventListener(Ni.REMOVE_TRACK,this._boundHandleAudioEvent),e.audioTracks.addEventListener(Ni.CHANGE,this._boundHandleAudioEvent))}removeVideoEventListeners(e=this._video){Object.keys(Oi).forEach(t=>{const r=Oi[t];e.removeEventListener(r,this._boundHandleVideoEvent)})}removeAudioEventListeners(e=this._video){var t;null!=e&&e.audioTracks&&"function"==typeof(null==(t=e.audioTracks)?void 0:t.removeEventListener)&&(e.audioTracks.removeEventListener(Ni.ADD_TRACK,this._boundHandleAudioEvent),e.audioTracks.removeEventListener(Ni.REMOVE_TRACK,this._boundHandleAudioEvent),e.audioTracks.removeEventListener(Ni.CHANGE,this._boundHandleAudioEvent))}play(e){return this._playRequest.start(e).catch(e=>{var t;if("sd-fallback"!==(null==(t=this._telecineVideo.drmHandler)?void 0:t.state)||"AbortError"!==e.name)throw this._onPlayError(e),e})}_onPlayError(e){this.fire(Oi.ERROR,new TelecineError(null==e?void 0:e.name,null==e?void 0:e.message))}pause(){this._playRequest.cancel(),this._video.pause()}onpause(){}ontimeupdate(){this._lastCurrentTime=this.currentTime}addTextTrack(e){let t,r;return e.src?(t=document.createElement("track"),t.kind=e.kind,t.src=e.src,t.id=`telecine-track-${e.id}`,t.srclang=e.language,t.label=e.label,this._video.appendChild(t),r=t.track):(r=this._video.addTextTrack(e.kind,e.label,e.language),this._textTracks=this._textTracks||{},this._textTracks[`telecine-track-${e.id}`]=r),this._addTextTrackListeners(e,r,t),r}_addTextTrackListeners(e,t,r){t.addEventListener("cuechange",()=>e.dispatchEvent("cuechange")),this._video.addEventListener(Oi.TIME_UPDATE,()=>{w(this._video)&&(e.mode=t.mode)});const n=()=>{const r=ue.iOS&&w(this._video);!e._modeHasBeenSet||r?e.mode=t.mode:t.mode=Es[e.mode]},i=[];if(r?r.addEventListener("load",n):n(),[Oi.LOADED_DATA,Oi.SEEKING].forEach(e=>{this._video.addEventListener(e,n),i.push([e,n])}),e._modeHasBeenSet&&(t.mode=Es[e.mode]),!ys){let r=[];const n=()=>{if(t&&"disabled"!==Es[t.mode]){if(r.length!==t.activeCues.length)return e.dispatchEvent("cuechange"),void(r=Array.from(t.activeCues));for(let n=0,i=t.activeCues.length;n<i;n++)if(t.activeCues[n].startTime!==r[n].startTime)return e.dispatchEvent("cuechange"),void(r=Array.from(e.activeCues))}};this._video.addEventListener(Oi.TIME_UPDATE,n),i.push([Oi.TIME_UPDATE,n])}return bs.set(e,i),t}removeTextTrack(e){const t=this._video.querySelector(`#telecine-track-${e.id}`);t&&this._video.removeChild(t);const r=bs.get(e);Array.isArray(r)&&r.forEach(([e,t])=>{this._video.removeEventListener(e,t)})}getCuesForTrack(e){const t=this.getTrackById(`telecine-track-${e.id}`);return t?Array.from(t.cues):[]}getActiveCuesForTrack(e){const t=this.getTrackById(`telecine-track-${e.id}`);return t&&t.activeCues?Array.from(t.activeCues):[]}setModeForTrack(e,t){const r=this.getTrackById(`telecine-track-${e.id}`);return r&&r.mode!==Es[t]&&(r.mode=Es[t],ys||"disabled"===t||e.dispatchEvent("cuechange")),this}setSrcForTrack(e,t){const r=this._video.querySelector(`#telecine-track-${e.id}`);return r&&null===r.track.cues&&(r.src=t),this}get audioTracks(){return this._video.audioTracks}enableAudioTrack(e){if(!this.constructor.supportsAudioTracksFromScanner||!this.audioTracks)return null;if(!e)return null;if(!this.audioTracks.getTrackById(e))return null;let t=null;for(let r=0;r<this.audioTracks.length;r++){const n=this.audioTracks[r].id===e;this.audioTracks[r].enabled=n,n&&(t=this.audioTracks[r])}return t}get chaptersTrack(){return this._chaptersTrack}_createChapterCue(e,t,r=null){let n;this._chaptersTrack||(this._chaptersTrack=this._video.addTextTrack("chapters"),this._chaptersTrack.mode="hidden");const i=e.timecode,s=r?r.timecode:t,a=window.VTTCue||window.TextTrackCue;try{n=new a(i,s,e.title)}catch(e){throw new TelecineError("ChaptersNotSupported","Chapters are not supported in this browser.")}n.size=(s-i)/t,n.id=i,this._chaptersTrack.addCue(n)}addChapter(e,t){const r=this.video.chapters,n={timecode:e,title:t};r.push(n),r.sort((e,t)=>e.timecode-t.timecode);const i=r[r.indexOf(n)+1];this._createChapterCue(n,this.video.duration,i),this._updateChapterCues(this._chaptersTrack,this.video.duration)}removeChapter(e){try{this._chaptersTrack.removeCue(e)}catch(e){throw new TelecineError("ChaptersNotSupported","Chapters are not supported in this browser.")}const t=this.video.chapters.find(t=>t.timecode===e.timecode);this.video.chapters.splice(t,1),this._updateChapterCues(this._chaptersTrack,this.video.duration)}_updateChapterCues(e,t){for(let r=0;r<e.cues.length;r++){let n=e.cues[r],i=e.cues[r+1];const s=i?i.startTime:t;n.endTime=s,n.size=(s-n.startTime)/t}this.fire(Ui.CHAPTER_CUES_UPDATED)}addChapters(e,t){0!==e.length&&t&&(e=e.filter(e=>this._isValidChapter(e,t))).sort((e,t)=>e.timecode-t.timecode).forEach((r,n)=>this._createChapterCue(r,t,e[n+1]))}addCuePoint(e,t={}){if(this._cuePointTrack||(this._cuePointTrack=this._video.addTextTrack("metadata"),this._cuePointTrack.mode="hidden",this._cuePointTrack.addEventListener("cuechange",e=>{Array.from(e.target.activeCues).forEach(e=>{this.fire(Ui.CUE_POINT,is.fromVTTCue(e))})}),this._video.addEventListener(Oi.CAN_PLAY,e=>{this._cuePointTrack.mode="hidden"})),e=parseFloat(e),isNaN(e))throw new TypeError("Time must be a number.");if(e<0||e>=this.duration)throw new TypeError("Time must be a positive number less than the duration of the video.");const r=new is(e,t);return this._cuePointTrack.addCue(r.vttCue),r}removeCuePoint(e){if(!e)throw new TelecineError("InvalidCuePoint","The specified cue point is not valid.");return this._cuePointTrack.removeCue(e.vttCue),!0}removeAllCuePoints(){return this._cuePointTrack&&this._cuePointTrack.length&&Array.from(this._cuePointTrack.cues).forEach(e=>{this._cuePointTrack.removeCue(e)}),!0}get manifest(){return this._manifest}get manifestLoaded(){return!!this._manifest}get buffered(){return os.from(this._video.buffered)}get cuePoints(){var e,t;return null!=(e=this._cuePointTrack)&&e.cues&&"function"==typeof(null==(t=this._cuePointTrack)?void 0:t.cues[Symbol.iterator])?Array.from(this._cuePointTrack.cues).map(e=>is.fromVTTCue(e)):[]}get currentFile(){return this._currentFile}set currentFile(e){const t=!this._video.paused,r=this.currentTime,n=!this._currentFile||e.video.id!==this._currentFile.video.id;if(n||this.takeSnapshot(),this._currentFile=e,n&&(this._video.preload=this._preload),this.constructor===As&&this._video.readyState>0&&(this._video.currentTime=0),(ue.iOS||ue.android)&&this._currentFile.video.title){let e=this._currentFile.video.title;this._currentFile.video.subtitle&&(e=`${e} ${this._currentFile.video.subtitle}`),this._video.setAttribute("title",e)}else this._video.removeAttribute("title");this.setVideoSrc(this._currentFile.src,n),this.fire(Ui.CURRENT_FILE_CHANGE,e),ue.iOS&&!n&&this.play().catch(this._onPlayError.bind(this)),this.constructor!==As||n?t&&this.play().catch(this._onPlayError.bind(this)):(this.seekToTime(r).then(e=>(t&&this.play().catch(this._onPlayError.bind(this)),e)).catch(()=>{}),this.once(Oi.CAN_PLAY,()=>this.removeSnapshot()),this.once(Oi.PLAYING,()=>this.removeSnapshot()))}get currentTime(){return this._video.currentTime}set currentTime(e){this.seekToTime(e)}get disableRemotePlayback(){return this._video.disableRemotePlayback}set disableRemotePlayback(e){this._video.disableRemotePlayback=e,e?this._video.setAttribute("disableRemotePlayback",""):this._video.removeAttribute("disableRemotePlayback")}get duration(){return this._video.duration}get ended(){return this._video.ended}get externalDisplayAvailable(){return this._externalDisplays.some(e=>e.available)}get externalDisplayActive(){return this._externalDisplays.some(e=>e.active)}get loop(){return this._video.loop}set loop(e){this._video.loop=e}get isLowerProfileAvailable(){return null}get muted(){return this._video.muted}set muted(e){this._video.muted=e}get playsinline(){return this._video.playsinline}set playsinline(e){this._video.playsinline=e,e?this._video.setAttribute("playsinline",""):this._video.removeAttribute("playsinline")}get paused(){return this._video.paused}get defaultPlaybackRate(){return this._video.defaultPlaybackRate}set defaultPlaybackRate(e){this._video.defaultPlaybackRate=e}get playbackRate(){return this._video.playbackRate}set playbackRate(e){this._video.playbackRate=e}get played(){return this._video.played}get seekable(){return this._video.seekable}get seeking(){return this._video.seeking}get preload(){return this._preload}set preload(e){this._video.preload=e,this._preload=e}get autoPictureInPicture(){return this._video.autoPictureInPicture}set autoPictureInPicture(e){this._video.autoPictureInPicture=e}get disablePictureInPicture(){return this._video.disablePictureInPicture}set disablePictureInPicture(e){this._video.disablePictureInPicture=e}get pictureInPictureActive(){return this._video.webkitPresentationMode===ps||!!document.pictureInPictureElement}get isPlayRequestActive(){var e,t;return null!==(e=null==(t=this._playRequest)?void 0:t.active)&&void 0!==e&&e}requestPictureInPicture(){const e=this;return Ss(function(){return Ts(function(t,r){var n=function(){if(e._video.readyState<1)return function(e){if(!void 0)return e&&e.then?e.then(vs):Promise.resolve()}(e._initPreload())}();return n&&n.then?n.then(r):r()}(0,function(){switch(ue.pictureInPictureSupportType){case"pip-api":return e._video.requestPictureInPicture();case"webkit-presentation-mode":return e._video.webkitSetPresentationMode(ps);default:throw new Error("Picture-in-picture is not supported by this browser")}}))})}_initPreload(){return this.preload="auto",new Promise(e=>{this.once(Oi.LOADED_METADATA,e)})}exitPictureInPicture(){const e=this;return Ss(function(){switch(ue.pictureInPictureSupportType){case"pip-api":return Ts(document.exitPictureInPicture());case"webkit-presentation-mode":return Ts(e._video.webkitSetPresentationMode(_s));default:throw new Error("Picture-in-picture is not supported by this browser")}return Ts()})}isInView(){var e,t;return null===(e=null==(t=this._playerInViewTracker)?void 0:t.isInView)||void 0===e||e}get pictureInPictureEnabled(){if(this.disablePictureInPicture)return!1;switch(ue.pictureInPictureSupportType){case"pip-api":return document.pictureInPictureEnabled;case"webkit-presentation-mode":return!0;default:return!1}}get video(){return this._telecineVideo}get videoElement(){return this._video}set video(e){if(this.reactivate(),this._telecineVideo!==e){if(this._telecineVideo&&(this._telecineVideo.off(Ui.FILE_SRC_UPDATE),this._telecineVideo.off("texttracksrcupdate")),this.removeAllCuePoints(),this._telecineVideo=e,this._files=this.filterFiles(this._telecineVideo),this._telecineVideo.on(Ui.FILE_SRC_UPDATE,e=>{e===this._currentFile&&this._updateCurrentFile()}),this._telecineVideo.on("texttracksrcupdate",e=>{this.video.currentScanner&&this.video.currentScanner.setSrcForTrack(e,e.src)}),this._options.externalDisplays&&this._options.externalDisplays.length){this._externalDisplays=[];let t=this.constructor.supportedExternalDisplays;Array.isArray(t)||(t=[]);const r=t.map(e=>e.displayName);this._options.externalDisplays.filter(e=>e.supported&&-1!==r.indexOf(e.displayName)).forEach(t=>{const r=new t(e),n=t.displayName.replace("ExternalDisplay","");r.on(Oi.LOADED_METADATA,e=>this.fire(Oi.LOADED_METADATA,e)),r.on("available",()=>this.fire(Mi.AVAILABLE,{type:n})),r.on("unavailable",()=>this.fire(Mi.UNAVAILABLE,{type:n})),r.on("activated",()=>{"function"==typeof this.onexternaldisplayactivated&&this.onexternaldisplayactivated(r),this.fire(Mi.ACTIVATED,{type:n})}),r.on("deactivated",()=>{"function"==typeof this.onexternaldisplaydeactivated&&this.onexternaldisplaydeactivated(r),this.fire(Mi.DEACTIVATED,{type:n})}),this._externalDisplays.push(r)})}this._updateCurrentFile(),ue.iOS&&this._externalDisplays.forEach(e=>{"AirPlay"===e.constructor.displayName&&(e.element=this._video)}),this.initDrm()}}get videoWidth(){return this._video.videoWidth}get videoHeight(){return this._video.videoHeight}get volume(){return F(this._video.volume)}set volume(e){this._video.volume=U(e)}get readyState(){return this._video.readyState}onerror(){if(!this._video.error)return!1;switch(this._video.error.code){case this._video.error.MEDIA_ERR_SRC_NOT_SUPPORTED:return this._fireVideoError("MediaSrcNotSupportedError","The media was not suitable."),this._switchToNextFile(),!1;case this._video.error.MEDIA_ERR_DECODE:return-1!==this._lastCurrentTime&&ue.iOS?(this._video.load(),this.currentTime=this._lastCurrentTime,this._lastCurrentTime=-1,!1):(this._fireVideoError("MediaDecodeError","The media could not be decoded."),this._switchToNextFile(),!1);case this._video.error.MEDIA_ERR_NETWORK:return this._fireVideoError("MediaNetworkError","A network error occurred while fetching the media."),!1;case this._video.error.MEDIA_ERR_ABORTED:return this._fireVideoError("MediaAbortedError","The user agent aborted the fetching of the media."),!1;default:return this._fireVideoError(us,"An unknown error occurred."),!1}}_fireVideoError(e,t){this.fire(Oi.ERROR,new TelecineError(e,t))}onended(){if(this._video.paused||this._video.pause(),this.currentTime<this._video.duration)return!1}onwaiting(){return!1}onwebkitbeginfullscreen(){this._inFullscreen=!0}onwebkitendfullscreen(){this._video.webkitPresentationMode===_s&&!0===this._video.controls&&(this._video.controls=!1),this._inFullscreen=!1}onwebkitpresentationmodechanged(){this.fire(this.pictureInPictureActive?Oi.ENTER_PICTURE_IN_PICTURE:Oi.LEAVE_PICTURE_IN_PICTURE)}filterFiles(e){return e.files.filter(t=>!(t.mime===b.hls&&ue.chromeHls&&e.metadata.drm||-1===this.constructor.supportedVideoTypes.indexOf(t.mime)))}shouldHandleVideoEvent(e){return!0}handleVideoEvent(e){e.target===this._video&&!1!==this.shouldHandleVideoEvent(e)&&("function"==typeof this[`on${e.type}`]&&!1===this[`on${e.type}`](e)||this.fire(e.type))}handleAudioEvent(){this.fire(Ui.AUDIO_TRACK_CHANGED)}swapVideo(e,t){const r=e.paused;this.removeVideoEventListeners(e),this.removeAudioEventListeners(e),e.parentElement.replaceChild(t,e),e.pause(),this._playRequest&&(this._playRequest.video=t),t.currentTime=e.currentTime,r||t.play(),this.addVideoEventListeners(t),this.addAudioEventListeners(t),this._video=t}onexternaldisplayactivated(e){this._externalDisplayActivated||(this._video!==e.element&&(this._originalVideo=this._video,this.swapVideo(this._video,e.element)),this._externalDisplayActivated=!0)}onexternaldisplaydeactivated(e){this._externalDisplayActivated&&(this._originalVideo&&(this.swapVideo(e.element,this._originalVideo),this._originalVideo=null),this._externalDisplayActivated=!1)}setVideoSrc(e){this._video.src=e}canSeekTo(e){const t=this.duration;if(t&&e>t&&(e=t),this._video.seekable.length>0)for(let t=0,r=this._video.seekable.length;t<r;t++)if(this._video.seekable.start(t)<=e&&this._video.seekable.end(t)>=e)return!0;return!1}seekToTime(e){return this.canSeekTo(e)?(this._video.currentTime=e,Promise.resolve(this._video.currentTime)):new Promise(t=>{const r=()=>{this.canSeekTo(e)&&(Object.keys(Oi).forEach(e=>{const t=Oi[e];this._video.removeEventListener(t,r)}),this._video.currentTime=e,t(this._video.currentTime))};Object.keys(Oi).forEach(e=>{const t=Oi[e];this._video.addEventListener(t,r)})})}takeSnapshot(){ts(this._video,this._element)}removeSnapshot(){rs(this._element)}getTrackById(e){if(this._textTracks&&this._textTracks[e])return this._textTracks[e];if("function"==typeof this._video.textTracks.getTrackById)return this._video.textTracks.getTrackById(e);const t=document.getElementById(e);return t?t.track:null}initDrm(){const e=this._telecineVideo.drmHandler;e&&e.init(this)}showExternalDisplayPicker(e){if(!this._externalDisplays.length)throw new TelecineError("ExternalDisplayUnavailable","No external displays are available.");if(!e)return void this._externalDisplays[0].showPicker();const t=this._externalDisplays.filter(t=>t.constructor.displayName.replace("ExternalDisplay","")===e)[0];if(!t)throw new TelecineError("InvalidExternalDisplay","The specified external display is not available.");t.showPicker()}setCaptionsShouldDisplay(e){}setCaptionsShouldLoad(e){}_pickFile(){if(this._files.length<1)return null;const e=this._files.slice(0).sort((e,t)=>e.priority-t.priority);return e[0]}_updateCurrentFile(){const e=this._pickFile();e?this.currentFile=e:this.fire(Ui.SCANNER_ERROR,{reason:"all files failed"})}_isValidChapter(e,t){return void 0!==e.timecode&&e.timecode>=0&&e.timecode<=t&&void 0!==e.title}_switchToNextFile(){const e=this._files.indexOf(this._currentFile);this._files.splice(e,1),this._updateCurrentFile()}_cleanUpInViewTracking(){var e;null==(e=this._playerInViewTracker)||e.cleanup()}_resetInViewTracking(){this._cleanUpInViewTracking(),this._playerInViewTracker=pe(this._element)}}function Is(e,t=[]){if(0===e.length)return 0;let r=0,n=0;for(let i=0;i<e.length;i++){const s=t[i]||1;n+=s,r+=e[i]*s}return r/n}function ws(e){const t=p(e).sort((e,t)=>e-t),r=Math.floor(t.length/2);return t.length%2?t[r]:(t[r-1]+t[r])/2}class Rs extends Error{}function Ps(e,t,r){return r?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}const Ds=Ls(function(e,t){const r=this;return function(e,t){var i=function(){if(!s(Bs,r))return Ps(n(zs,r,la).call(r),function(e){o(Bs,r,new e({keepOriginalTimestamps:!0}))})}();return i&&i.then?i.then(t):t()}(0,function(){return new Promise(n=>{s(Bs,r).on("data",t=>{s(Bs,r).off("data");let i=new Uint8Array(t.initSegment.byteLength+t.data.byteLength);i.set(t.initSegment,0),i.set(t.data,t.initSegment.byteLength),n(e.data.isInitSegmentRequest?t.initSegment:i)}),s(Bs,r).push(new Uint8Array(t)),s(Bs,r).flush()})})});function Ls(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}const ks=Ls(function(){const e=this;return function(){var t=function(){if(s(Xs,e))return function(e){if(!void 0)return e&&e.then?e.then(Cs):Promise.resolve()}(s(Xs,e))}();if(t&&t.then)return t.then(Cs)}()});function Cs(){}var Os=new WeakMap,Ns=new WeakMap,Ms=new WeakMap,xs=new WeakMap,Us=new WeakMap,Fs=new WeakMap,Vs=new WeakMap,js=new WeakMap,Hs=new WeakMap,Bs=new WeakMap,Xs=new WeakMap,Ws=new WeakMap,qs=new WeakMap,Gs=new WeakMap,Ks=new WeakMap,Ys=new WeakMap,$s=new WeakMap,zs=new WeakSet;class Qs extends Ir{constructor(e={}){super(),c(this,zs),a(this,Os,void 0),a(this,Ns,void 0),a(this,Ms,100),a(this,xs,void 0),a(this,Us,void 0),a(this,Fs,void 0),a(this,Vs,new Set),a(this,js,void 0),a(this,Hs,!1),a(this,Bs,void 0),a(this,Xs,void 0),a(this,Ws,!1),a(this,qs,[]),a(this,Gs,[]),a(this,Ks,[]),a(this,Ys,[]),a(this,$s,[]),o(Os,this,V("Fetcher","color: #586e75"));const{parallel:t=1,retryAbortErrors:r=!0,retryCount:i=3,timeout:s=0}=e;o(Ns,this,t),o(xs,this,r),o(Us,this,i),o(Fs,this,s),n(zs,this,Zs).call(this)}getPercentileSpeed(e=5,t=.8){return function(e,t){if(0===e.length)return 0;const r=p(e).sort((e,t)=>e-t);if(t<=0)return r[0];if(t>=1)return r[r.length-1];const n=r.length*t,i=Math.floor(n),s=i+1,a=n%1;return s>=r.length?r[i]:r[i]*(1-a)+r[s]*a}(s($s,this).slice(-e),t)}getAverageSpeed(e=5,t=[]){return Is(s($s,this).slice(-e),t)}getHarmonicAverageSpeed(e=5){return function(e){if(0===e.length)return 0;let t=0;for(let r=0;r<e.length;r++)t+=1/e[r];return e.length/t}(s($s,this).slice(-e))}getMedianSpeed(e=5){return ws(s($s,this).slice(-e))}getResponseSpeeds(){return s($s,this)}getProgressSpeeds(){return s(Ys,this)}getFailedSegments(){return s(Gs,this)}getSuccessfulSegments(){return s(Ks,this)}resetResponseSpeeds(){s($s,this).length=0}get pendingFetches(){const e=[];return s(Vs,this).forEach(t=>{const r=s(js,this).get(t);r&&(r.elapsedTime=Ee()-t.data.requestSendTime,e.push(r))}),e}add(e){return new Promise((t,r)=>{const i=n(zs,this,ra).call(this,e,t,r);n(zs,this,ea).call(this,i),s(Hs,this)&&!s(Ws,this)&&n(zs,this,ta).call(this)})}abort(e=null){s(qs,this).filter(t=>!e||e===t.stream).forEach(e=>{e.reject(new Rs("Stream manually aborted")),this.fire("downloadabort",e.identifier)}),o(qs,this,s(qs,this).filter(t=>e&&e!==t.stream)),s(Vs,this).forEach(t=>{e&&e!==t.stream||t.request.abort()})}start(){s(Hs,this)||(o(Hs,this,!0),n(zs,this,ta).call(this))}stop(){o(Hs,this,!1)}saveResponseSpeeds(e,t,r){if(!e.includeWithBandwidthChecks)return;const i=n(zs,this,oa).call(this,e,t,r),a=r<15e4&&ue.navigatorConnectionDownlink?Math.max(R(),i):i;s($s,this).push(a),s($s,this).length>100&&s($s,this).shift()}}function Js(e){let t=0;for(;t<s(qs,this).length&&!(s(qs,this)[t].priority>e.priority);t++);s(qs,this).splice(t,0,e)}function Zs(){if(o(js,this,new WeakMap),window.addEventListener("online",()=>{this.start(),s(Xs,this)&&(s(Xs,this).resolve(),o(Xs,this,null))}),window.addEventListener("offline",()=>{this.stop(),this.abort(),o(Xs,this,ve())}),ue.navigatorConnectionDownlink){const e=R();s($s,this).push(e)}}function ea(e){e.hasOwnProperty("priority")?n(zs,this,Js).call(this,e):s(qs,this).push(e)}function ta(){if(!s(Hs,this))return;o(Ws,this,!0);const e=s(Ns,this)-s(Vs,this).size;for(let t=0;t<e;t++)n(zs,this,ia).call(this)}function ra(e,t,r){let n=e;return"object"==typeof e&&e.id&&(n=e.id),Object.assign({},e,{identifier:n,resolve:t,reject:r})}function na(){0!==s(Vs,this).size||0!==s(qs,this).length?s(Vs,this).size<s(Ns,this)&&n(zs,this,ta).call(this):o(Ws,this,!1)}function ia(){if(0===s(qs,this).length)return void o(Ws,this,!1);const t=s(qs,this).shift(),{url:r,byteRange:i,isInitSegmentRequest:a,identifier:c,stream:u,timeout:l}=t,h={stream:u,data:{url:r,isInitSegmentRequest:a,requestSendTime:Ee(),uuid:Ae()}};let d=s(Fs,this);"number"==typeof l&&l>=0&&(d=l);const f={url:r,type:e.SEGMENT,responseType:rt.ARRAY_BUFFER,retry:s(Us,this),hooks:{beforeRetry:[n(zs,this,ks).bind(this)]},onDownloadProgress:n(zs,this,sa).call(this,c,h),headers:i&&{Range:`bytes=${i}`},retryAbortErrors:s(xs,this),timeout:d};this.fire("downloadstart",c),h.request=Ye(f).then(n(zs,this,aa).call(this,h,t)).catch(n(zs,this,ua).call(this,h,t)),s(Vs,this).add(h)}function sa(e,t){let r=0,n=0,i=Ee();return a=>{if(a.lengthComputable){const o=8*(a.loaded-n),c=Ee(),u=c-i,l={startTime:i,length:u,bitrate:o/(u/1e3),index:r};r>0&&(s(Ys,this).length>=s(Ms,this)&&s(Ys,this).shift(),s(Ys,this).push(l)),i=c,n=a.loaded,r+=1,s(js,this).set(t,{bytesTotal:a.total,bytesLoaded:a.loaded,percent:a.loaded/a.total,identifier:e}),this.fire("progress",e)}}}function aa(e,t){const r=this,i=Ee(),{identifier:a,resolve:o}=t;return Ls(function(c){let u=Ee()-i;return Ps(c.arrayBuffer(),function(i){return Object.prototype.hasOwnProperty.call(c,"perfTimings")&&Object.prototype.hasOwnProperty.call(c.perfTimings,"responseStart")&&(t.perfTimings=c.perfTimings),e.data.duration=Ee()-e.data.requestSendTime,s(Vs,r).delete(e),s(js,r).delete(e),r.saveResponseSpeeds(t,u,i.byteLength),r.fire("downloadend",a,{request:e,response:c}),s(Ks,r).push({url:e.data.url,status:200,duration:e.data.duration}),Ps(n(zs,r,ca).call(r,e,i),function(e){o(i=e),n(zs,r,na).call(r)})})})}function oa(e,t,r){const n=2e5,i=t/1e3,s=e.perfTimings;let a=r/i;const o=s&&r<=16e3;if(e.excludeConnectTime&&r>16e3&&r<=n){const e=(50*Math.max(0,1-r/n)+150)/1e3;a=r/Math.max(.1,i-e)}else if(o){const e=s.fetchStart||s.workerStart||s.requestStart||0;a=r/(i-Math.max(0,s.responseStart-e)/1e3)}return 8*a}function ca(e,t){return e.data.url&&e.data.url.split("?")[0].endsWith(".ts")?n(zs,this,Ds).call(this,e,t):Promise.resolve(new Uint8Array(t))}function ua(e,t){const{identifier:r,reject:i,size:a}=t;return t=>{const o=Ee()-e.data.requestSendTime;if(e.data.duration=o,t instanceof we)s(Gs,this).push({url:e.data.url,status:"abort",duration:o}),this.fire("downloadabort",r);else if(t instanceof Re){const n=t.response.status;s(Gs,this).push({url:e.data.url,status:n,duration:o}),this.fire("downloaderror",r,n)}else if(t instanceof De){if(s(Gs,this).push({url:e.data.url,status:"timeout",duration:o}),"number"==typeof a&&a>0&&t.timeoutMs>0){let e=8*a/(t.timeoutMs/1e3);e*=.5,s(Os,this).call(this,"Adding degraded speed of",e,"after timeout of",t.timeoutMs,"ms"),s($s,this).push(e)}this.fire("downloadtimeout",r,{timeoutMs:t.timeoutMs})}s(js,this).delete(e),s(Vs,this).delete(e),i(t),n(zs,this,na).call(this)}}function la(){return import("./mux-mp4.module.js").then(({default:e})=>e)}var ha=new WeakMap,da=new WeakMap,fa=new WeakMap,_a=new WeakMap,pa=new WeakMap,va=new WeakMap,ma=new WeakMap,ga=new WeakMap,Ea=new WeakMap,Ta=new WeakMap,ya=new WeakMap,Sa=new WeakMap,ba=new WeakMap,Aa=new WeakMap,Ia=new WeakMap,wa=new WeakMap,Ra=new WeakMap,Pa=new WeakMap,Da=new WeakMap,La=new WeakMap,ka=new WeakMap,Ca=new WeakMap,Oa=new WeakMap,Na=new WeakSet;class Ma extends Ir{constructor(e,t){super(),c(this,Na),a(this,ha,void 0),a(this,da,void 0),a(this,fa,void 0),a(this,_a,void 0),a(this,pa,void 0),a(this,va,void 0),a(this,ma,-1),a(this,ga,!1),a(this,Ea,!1),a(this,Ta,{}),a(this,ya,void 0),a(this,Sa,!0),a(this,ba,null),a(this,Aa,!0),a(this,Ia,!1),a(this,wa,!1),a(this,Ra,void 0),a(this,Pa,null),a(this,Da,void 0),a(this,La,null),a(this,ka,[]),a(this,Ca,void 0),a(this,Oa,[]),o(va,this,V("Buffer","color: #586e75")),o(pa,this,t),o(Da,this,e),o(ha,this,n(Na,this,Ua).bind(this)),o(da,this,n(Na,this,Ba).bind(this)),o(fa,this,n(Na,this,Ha).bind(this)),o(_a,this,n(Na,this,Ga).bind(this)),s(Da,this).on("durationset",s(ha,this))}get activeStream(){return s(ka,this)[s(ma,this)]||null}get activeStreamIndex(){return s(ma,this)}get endTime(){if(!s(La,this))return void s(va,this).warn("SourceBuffer is not set.");const e=s(La,this).buffered;return e.length>0?e.end(e.length-1):void 0}get sourceBuffer(){return s(La,this)}set sourceBuffer(e){o(La,this,e),n(Na,this,Fa).call(this),this.fire("sourcebufferattach")}get streams(){return s(ka,this)}addStream(e){e.on("segmentadd",s(_a,this));const t=s(ka,this).push(e)-1;e.index=t,-1===s(ma,this)&&(n(Na,this,ja).call(this,t),o(Ia,this,!0))}getBufferState(){return s(Ta,this)}setBufferState(e){o(Ta,this,e)}streamIndexAtTime(e){if(s(Ta,this)[void 0])return this.activeStreamIndex;const t=n(Na,this,xa).call(this,e)-1,r=s(Ta,this)[t];return(null==r?void 0:r.stream)||-1}switchTo(e,t=!0,r={}){let i;i="number"==typeof e?e:e.index;let a=s(ma,this)!==i;const c=a;if(!a&&s(Ia,this)&&(a=!0),a){o(Ia,this,!1);const e=s(ma,this),r=s(ka,this)[e];this.fire("streamchangestart",e,i),r&&c&&t&&r.abort(),o(Ca,this,i),n(Na,this,ja).call(this,i)}return n(Na,this,Ga).call(this),new Promise(e=>{a?o(Pa,this,()=>{s(Ca,this)===i&&(o(Pa,this,null),e(),this.fire("streamchange",i,r))}):e()})}isTimeInBuffer(e){if(!s(La,this))return s(va,this).warn("SourceBuffer is not set."),!1;for(let t=0;t<s(La,this).buffered.length;t++){const r=s(La,this).buffered.start(t),n=s(La,this).buffered.end(t);if(r<=e&&n>=e)return!0}return!1}hasAppendedFinalSegment(){return void 0!==s(ya,this)&&this.isTimeInBuffer(s(ya,this))}clear(){s(ka,this).forEach(e=>e.clear())}remove(e,t=s(Da,this).mediaSource.duration){return new Promise(r=>{s(Oa,this).push([e,t,r]),n(Na,this,Ga).call(this)})}removeEventListeners(){s(La,this)&&(s(La,this).removeEventListener("updateend",s(fa,this)),n(Na,this,Va).call(this,s(La,this))&&s(La,this).removeEventListener("bufferedchange",s(da,this)))}removeSorcerer(){s(Da,this).off("durationset",s(ha,this)),o(Da,this,null)}}function xa(e){let t=Math.floor(e/6);return e>6&&e%6>=2?t+=1:e<8&&(t=1),t}function Ua(){const e=s(Da,this).mediaSource.duration,t=n(Na,this,xa).call(this,e);for(let e=0;e<t;e++)s(Ta,this)[e]={segment:e,stream:null,type:s(pa,this)}}function Fa(){s(La,this)?(s(La,this).addEventListener("updateend",s(fa,this)),n(Na,this,Va).call(this,s(La,this))&&s(La,this).addEventListener("bufferedchange",s(da,this))):s(va,this).warn("SourceBuffer is not set.")}function Va(e){return"undefined"!=typeof ManagedSourceBuffer&&e instanceof ManagedSourceBuffer}function ja(e){o(Aa,this,!0),o(ma,this,e),s(Da,this).setStreamIndex(e)}function Ha(){n(Na,this,Wa).call(this),n(Na,this,qa).call(this),n(Na,this,Ga).call(this)}function Ba(e){var t;(null==(t=e.removedRanges)?void 0:t.length)>0&&s(va,this).call(this,"Browser removed %s buffer:",s(pa,this),(e=>{const t=[];for(let r=0;r<e.length;r++)t.push(`${e.start(r)}-${e.end(r)}`);return t.join(", ")})(e.removedRanges))}function Xa(){if(s(La,this))try{const e=s(La,this).buffered,t=s(Da,this)._video.buffered;if(e.length&&t.length){const r=e.start(0),n=t.start(0);r<n&&s(Da,this).removeBuffer(0,n)}}catch(e){s(va,this).error("Error failed to handle mismatch between video and sourceBuffer.")}else s(va,this).warn("SourceBuffer is not set.")}function Wa(){if(s(Ea,this)&&this.endTime)return o(Ea,this,!1),o(ya,this,this.endTime),s(Da,this).checkEndOfStream(),void n(Na,this,Xa).call(this);this.activeStream&&!this.activeStream.hasNextSegment()&&void 0!==s(ya,this)&&s(ya,this)>0&&"open"===s(Da,this).readyState&&s(Da,this).checkEndOfStream()}function qa(){s(ba,this)&&(this.fire("appendbufferend",s(ba,this)),o(ba,this,null),s(Pa,this)&&s(Pa,this).call(this))}function Ga(){if(!s(La,this))return s(va,this).log("SourceBuffer is not set. Waiting for sourcebufferattach event."),void this.on("sourcebufferattach",s(_a,this));this.activeStream&&"closed"!==s(Da,this).readyState&&(s(La,this).updating||(s(Oa,this).length?n(Na,this,Ka).call(this):s(wa,this)||s(ga,this)||(s(Aa,this)?n(Na,this,Ya).call(this):n(Na,this,$a).call(this))))}function Ka(){const e=s(La,this),t=s(Oa,this).shift();if(!t||!e)return void s(va,this).warn("No entries to remove or sourceBuffer is not set.");const[r,i,a]=t,c=()=>{e.removeEventListener("updateend",c),a(),void 0!==s(Ra,this)&&clearTimeout(s(Ra,this)),o(Ra,this,setTimeout(()=>{o(wa,this,!1),n(Na,this,Ga).call(this)},5e3))};e.addEventListener("updateend",c),e.remove(r,i)}function Ya(){o(Aa,this,!1),o(ga,this,!0),this.activeStream?this.activeStream.getInitSegment().then(e=>(o(ba,this,null),s(La,this)&&e&&s(La,this).appendBuffer(e),o(ga,this,!1),e)).catch(e=>{s(va,this).error("Error appending init segment to the buffer:",e),o(Aa,this,!0),o(ga,this,!1)}):s(va,this).error("No active stream to append init segment.")}function $a(){if(!this.activeStream||!s(La,this))return void s(va,this).error("No active stream or sourceBuffer to append segment.");const e=this.activeStream.getNextSegment();if(!e)return;const t=this.activeStream.getIdForSegment(e);this.activeStream.isFinal(e)&&o(Ea,this,!0),o(ba,this,t),this.fire("appendbufferstart",t);try{s(La,this).appendBuffer(e),s(Ta,this)[t.segment]=t,s(Sa,this)&&(o(Sa,this,!1),this.fire("initialbufferstart"))}catch(t){if("QuotaExceededError"===t.name){o(wa,this,!0),this.fire("quotaexceedederror",s(La,this).buffered),s(va,this).error("Error QuotaExceededError.");const t=6;if(s(Da,this)._video.currentTime>t){const e=0,r=s(Da,this)._video.currentTime-t;s(va,this).call(this,`Removing buffer from ${e} to ${r}`),s(Da,this).removeBuffer(e,r)}this.activeStream.dequeueSegment(e)}}}function za(){}var Qa=new WeakMap,Ja=new WeakMap,Za=new WeakMap,eo=new WeakMap,to=new WeakMap,ro=new WeakMap,no=new WeakMap;class io extends Ir{static isValidSegmentUrl(e){return"string"==typeof e||"object"==typeof e&&"url"in e&&"byteRange"in e&&"string"==typeof e.url&&"string"==typeof e.byteRange}constructor(e,t="",r=new Qs){super(),l(this,"codec",void 0),l(this,"index",NaN),a(this,Qa,void 0),a(this,Ja,new WeakMap),a(this,Za,void 0),a(this,eo,void 0),a(this,to,!0),a(this,ro,[]),a(this,no,{}),o(Qa,this,V("Stream","color: #586e75")),o(eo,this,e),this.codec=t,o(Za,this,r),s(Za,this).start()}get pendingFetches(){return s(Za,this).pendingFetches}getIdForSegment(e){return io.isValidSegmentUrl(e)?s(no,this)[e]:s(Ja,this).get(e).id}getSegmentUrl(e){return"object"==typeof e&&"url"in e?e.url:e}getSegmentByteRange(e){return"object"==typeof e&&"byteRange"in e?e.byteRange:void 0}isFinal(e){return s(Ja,this).get(e).final}addSegment(e,{identifier:t=null,isFinalSegment:r=!1,loadOnly:n=!1,priority:i=0,includeWithBandwidthChecks:a=!0,excludeConnectTime:o=!1,timeout:c=null,size:u=null}={}){if(s(to,this)&&this.getInitSegment(),io.isValidSegmentUrl(e)){s(no,this)[e]=t||e;const l=this.getIdForSegment(e);return this.fire("queued",l),s(Za,this).add({byteRange:this.getSegmentByteRange(e),excludeConnectTime:o,id:l,includeWithBandwidthChecks:a,isInitSegmentRequest:!1,priority:i,size:u,stream:this,timeout:c,url:this.getSegmentUrl(e)}).then(i=>{s(Ja,this).set(i,{id:t||e,final:r}),s(ro,this).push(i),this.fire("bufferqueueadd",l),n||this.fire("segmentadd")})}return s(Ja,this).set(e,{id:t,final:r}),s(ro,this).push(e),this.fire("bufferqueueadd",t),Promise.resolve()}clear(){o(ro,this,[])}abort(){const e=this;return function(e){try{var t=Promise.resolve(e());return t}catch(e){return Promise.reject(e)}}(function(){return function(e){return e&&e.then||(e=Promise.resolve(e)),e}(function(t,r){var n=function(){if(s(to,e))return function(e){if(e&&e.then)return e.then(za)}(function(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}(function(){return function(e){if(!void 0)return e&&e.then?e.then(za):Promise.resolve()}(e.getInitSegment())},function(t){s(Qa,e).error("Error getting init segment:",t)}))}();return n&&n.then?n.then(r):r()}(0,function(){s(Za,e).abort(e)}))})}hasNextSegment(){return s(ro,this).length>0}getNextSegment(){return s(ro,this).shift()}dequeueSegment(e){s(ro,this).unshift(e)}getInitSegment(){const e=this.getSegmentUrl(s(eo,this));return e?(o(to,this,!1),io.isValidSegmentUrl(e)?s(Za,this).add({byteRange:this.getSegmentByteRange(s(eo,this)),id:null,isInitSegmentRequest:!0,priority:0,stream:this,url:e}).then(e=>(o(eo,this,e),s(eo,this))):Promise.resolve(s(eo,this))):Promise.resolve(null)}}var so=new WeakMap,ao=new WeakMap,oo=new WeakMap,co=new WeakMap,uo=new WeakMap,lo=new WeakMap,ho=new WeakMap,fo=new WeakMap,_o=new WeakMap,po=new WeakMap,vo=new WeakMap,mo=new WeakSet;class go{constructor(e,t=-1){c(this,mo),l(this,"streamIndex",void 0),a(this,so,void 0),a(this,ao,void 0),a(this,oo,void 0),a(this,co,void 0),a(this,uo,!1),a(this,lo,void 0),a(this,ho,{}),a(this,fo,{}),a(this,_o,0),a(this,po,0),a(this,vo,!1),o(co,this,e),this.streamIndex=t,o(so,this,this.start.bind(this)),o(ao,this,this.stop.bind(this)),o(oo,this,n(mo,this,So).bind(this))}init(){n(mo,this,Eo).call(this)}start(){o(uo,this,!0),n(mo,this,yo).call(this)}stop(){o(uo,this,!1)}destroy(){this.stop(),n(mo,this,To).call(this)}getDroppedFrameRate(e,t=-1,r="average"){const n=s(ho,this)[t];if(!n||n.length<e)return 0;const i=n.slice(-e);return"median"===r?ws(i):Is(i)}getDroppedFrameTotal(){return{dropped:n(mo,this,bo).call(this),total:n(mo,this,Ao).call(this)}}}function Eo(){s(vo,this)||(s(co,this).addEventListener("playing",s(so,this)),s(co,this).addEventListener("pause",s(ao,this)),s(co,this).addEventListener("ended",s(ao,this)),document.addEventListener("visibilitychange",s(oo,this)),o(vo,this,!0))}function To(){s(co,this).removeEventListener("playing",s(so,this)),s(co,this).removeEventListener("pause",s(ao,this)),s(co,this).removeEventListener("ended",s(ao,this)),document.removeEventListener("visibilitychange",s(oo,this)),o(vo,this,!1)}function yo(){if(!s(uo,this)||-1===this.streamIndex)return;if(ue.browser.safari&&(document.hidden||"hidden"===document.visibilityState))return;void 0!==s(lo,this)&&clearTimeout(s(lo,this));const e=n(mo,this,bo).call(this),t=e-s(_o,this);o(_o,this,e);const r=n(mo,this,Io).call(this),i=r-s(po,this);o(po,this,r),s(ho,this)[this.streamIndex]||(s(ho,this)[this.streamIndex]=[]),s(fo,this)[this.streamIndex]||(s(fo,this)[this.streamIndex]=[]),s(ho,this)[this.streamIndex].length>100&&s(ho,this)[this.streamIndex].shift(),s(fo,this)[this.streamIndex].length>100&&s(fo,this)[this.streamIndex].shift(),s(ho,this)[this.streamIndex].push(t),s(fo,this)[this.streamIndex].push(i),o(lo,this,setTimeout(()=>{n(mo,this,yo).call(this)},1e3))}function So(){!ue.browser.safari||document.hidden&&"hidden"===document.visibilityState||n(mo,this,yo).call(this)}function bo(){return"function"==typeof s(co,this).getVideoPlaybackQuality?s(co,this).getVideoPlaybackQuality().droppedVideoFrames:s(co,this).webkitDroppedFrameCount||0}function Ao(){return"function"==typeof s(co,this).getVideoPlaybackQuality?s(co,this).getVideoPlaybackQuality().totalVideoFrames:s(co,this).webkitDecodedFrameCount||0}function Io(){if("function"==typeof s(co,this).getVideoPlaybackQuality){const e=s(co,this).getVideoPlaybackQuality();return e.totalVideoFrames-e.droppedVideoFrames}return s(co,this).webkitDecodedFrameCount||0}var wo=new WeakMap,Ro=new WeakMap,Po=new WeakMap,Do=new WeakMap,Lo=new WeakMap,ko=new WeakMap,Co=new WeakMap,Oo=new WeakMap,No=new WeakMap,Mo=new WeakMap,xo=new WeakMap;class Uo extends Ir{constructor(e,t={}){super(),l(this,"_video",void 0),l(this,"allowSegmentRequests",void 0),a(this,wo,void 0),a(this,Ro,void 0),a(this,Po,void 0),a(this,Do,void 0),a(this,Lo,void 0),a(this,ko,void 0),a(this,Co,void 0),a(this,Oo,void 0),a(this,No,void 0),a(this,Mo,void 0),a(this,xo,void 0),l(this,"isInstanceofManagedMediaSource",e=>"undefined"!=typeof ManagedMediaSource&&e instanceof ManagedMediaSource),o(ko,this,V("MediaSorcerer","color: #586e75")),this._video=e,o(Oo,this,t),this.allowSegmentRequests=!0;const r=s(Oo,this).disableMMS;o(Co,this,new(B(r))),s(ko,this).log("Media Source API: "+this._mediaSourceAPIName(s(Co,this)));const{fetcherTimeout:n=0,fetcherRetryAbortErrors:i=!0}=s(Oo,this);o(No,this,new go(e)),o(Lo,this,new Qs({parallel:1,timeout:n,retryAbortErrors:i})),o(wo,this,this._onMSSourceClose.bind(this)),o(Ro,this,this._onMSSourceOpen.bind(this)),o(Do,this,{audio:null,video:null}),o(Po,this,[]),o(xo,this,null),this._attachEvents()}setStreamIndex(e){s(No,this).streamIndex=e}get activeStreamIndex(){return 1===s(Po,this).length&&this.video?this.video.activeStreamIndex:(s(ko,this).warn("The activeStreamIndex property on MediaSorcerer only works with single streams"),-1)}get mediaSource(){return s(Co,this)}get pendingFetches(){return s(Lo,this).pendingFetches}get readyState(){return s(Co,this).readyState}get streams(){return 1===s(Po,this).length&&this.video?this.video.streams:(s(ko,this).warn("The streams property on MediaSorcerer only works with single streams"),!1)}get audio(){return s(Do,this).audio?s(Do,this).audio:(s(ko,this).warn("No audio streams have been added to MediaSorcerer"),!1)}get video(){return s(Do,this).video?s(Do,this).video:(s(ko,this).warn("No video streams have been added to MediaSorcerer"),!1)}getCurrentSpeed({type:e="average",howMany:t=10,weights:r=[],percentile:n}={}){switch(e){case"harmonicAverage":return s(Lo,this).getHarmonicAverageSpeed(t);case"percentile":return s(Lo,this).getPercentileSpeed(t,n);case"median":return s(Lo,this).getMedianSpeed(t);case"average":return s(Lo,this).getAverageSpeed(t,r)}}getResponseSpeeds(){return s(Lo,this).getResponseSpeeds()}getFailedSegments(){return s(Lo,this).getFailedSegments()}getSuccessfulSegments(){return s(Lo,this).getSuccessfulSegments()}getDroppedFrameRate(e,t=this.activeStreamIndex,r="average"){return s(No,this).getDroppedFrameRate(e,t,r)}getDroppedFrameTotal(){return s(No,this).getDroppedFrameTotal()}clear(){s(Po,this).forEach(e=>e.clear())}initFrameDropper(){s(No,this).init()}streamIndexAtTime(e,t){const r=s(Do,this)[t];return r?r.streamIndexAtTime(e):-1}removeBuffer(e=0,t=this._video.duration){if(e>=(t=t||0))return Promise.resolve();const r=s(Po,this).map(r=>r.remove(e,t));return Promise.all(r)}setLiveSeekableRange(e,t){var r;"open"===(null==(r=s(Co,this))?void 0:r.readyState)&&s(Co,this).setLiveSeekableRange(e,t)}addStream(e,t){const r=this._getCodecType(e);if(!s(Do,this)[r]){const t=new Ma(this,r);s(Do,this)[r]=t,s(Po,this).push(t),s(Mo,this).then(()=>{let n;try{n=s(Co,this).addSourceBuffer(e)}catch(e){if(22!==e.code)return s(ko,this).error(e),void this.fire("srcnotsupported",e);n=s(Do,this)[r]}if(s(Oo,this).duration){const e=.1;n.appendWindowEnd=s(Oo,this).duration+e}t.sourceBuffer=n}).catch(e=>{s(ko,this).error(e)}),["appendbufferstart","appendbufferend","streamchange","streamchangestart","initialbufferstart","quotaexceedederror"].forEach(e=>{t.on(e,(...t)=>{this.fire.apply(this,[e].concat(t))})})}const n=new io(t,e,s(Lo,this));["queued","bufferqueueadd"].forEach(e=>{n.on(e,t=>{this.fire(e,t)})});const i=s(Do,this)[r];return i&&i.addStream(n),n}checkEndOfStream(){if(!s(Po,this).every(e=>e.hasAppendedFinalSegment()))return;const e=()=>{this._video.removeEventListener("timeupdate",e),this.endOfStream()};this._video.addEventListener("timeupdate",e)}abortFetches(){s(Lo,this).abort()}endOfStream(){if(!s(Po,this).every(e=>e.isTimeInBuffer(this._video.currentTime))){const e=1;if(!(ue.browser.firefox&&this._video.currentTime<e))return}"open"===s(Co,this).readyState&&(this._sourceBuffersAreUpdating()||(s(ko,this).log("Firing MediaSource.endOfStream()"),s(Co,this).endOfStream(),this.fire("endofstream")))}destroy(){this.clear(),this._removeEventListeners(),this.off(),s(No,this).destroy(),s(Lo,this).abort();const e=this._video.querySelectorAll("source");(this._video.src||e.length>0)&&(this._video.removeAttribute("src"),e.forEach(e=>{this._video.removeChild(e)}),this._video.load())}_mediaSourceAPIName(e){return this.isInstanceofManagedMediaSource(e)?"ManagedMediaSource":"MediaSource"}_attachEvents(){o(Mo,this,new Promise(e=>{o(xo,this,e),s(Co,this).addEventListener("sourceopen",s(Ro,this)),s(Co,this).addEventListener("sourceclose",s(wo,this))})),["downloadstart","downloadend","downloadabort","downloaderror","downloadtimeout","progress"].forEach(e=>{s(Lo,this).on(e,(...t)=>{this.fire.apply(this,[e].concat(t))})}),this.isInstanceofManagedMediaSource(s(Co,this))&&(s(Co,this).addEventListener("startstreaming",()=>{s(ko,this).log("startstreaming event fired"),this.allowSegmentRequests=!0}),s(Co,this).addEventListener("endstreaming",()=>{s(ko,this).log("endstreaming event fired"),this.allowSegmentRequests=!1}))}_sourceBuffersAreUpdating(){for(let e=0;e<s(Co,this).sourceBuffers.length;e++)if(s(Co,this).sourceBuffers[e].updating)return!0;return!1}_onMSSourceOpen(){s(ko,this).log("MediaSource open"),s(Co,this).removeEventListener("sourceopen",s(Ro,this)),URL.revokeObjectURL(this._video.src),this._video.querySelectorAll("source").forEach(e=>{var t;0===(null==(t=e.src)?void 0:t.indexOf("blob"))&&URL.revokeObjectURL(e.src)}),s(Oo,this).duration&&(s(Co,this).duration=s(Oo,this).duration,this.fire("durationset")),s(xo,this)&&s(xo,this).call(this)}_onMSSourceClose(){s(ko,this).log("MediaSource closed"),s(Co,this).removeEventListener("sourceclose",s(wo,this)),this.fire("sourceclose")}_removeEventListeners(){s(Po,this).forEach(e=>e.removeEventListeners())}_getCodecType(e){return 0===e.indexOf("audio")?"audio":"video"}}class Fo{get displayName(){return"Brain"}constructor(e){this.scanner=e,this.STREAM_TYPE_VIDEO="video",this.STREAM_TYPE_AUDIO="audio"}destroy(){}shouldPowerUp(e,t){return!1}shouldPowerDown(e,t){return!1}canPowerUp(e,t){return 1!==e.length&&t<e.length-1}canPowerDown(e,t){return 1!==e.length&&t>0}filterStreams(e){return e}}class Vo extends Fo{get displayName(){return"MediaSource"}constructor(e,t={}){super(e),this._options=t,this.blacklisted=[],this.whitelisted=[],this.SEGMENT_DURATION=6,this._bufferTargetSeconds=t.bufferTarget||6}isTimeInBuffer(e,t,r){return this._timesAreInRange(e,e,t,r,1)}getDistanceFromBuffer(e,t){let r=e;for(let n=0;n<t.length;n++)if(t.start(n)<=e&&t.end(n)>=e){r=t.end(n);break}return r-e}blacklist(e){this.blacklisted[e]=1}lock(e=[]){this.whitelisted=e}filterStreams(e,t,r,n=null){const i=[];let s,a=!1;for(let o=0;o<e.length;o++)if(s&&s[0]===e[o].width&&s[1]===e[o].height)i.push(e[o]);else{if(a)break;this.blacklisted[o]&&-1===this.whitelisted.indexOf(o)||this.whitelisted.length&&-1===this.whitelisted.indexOf(o)||(this.whitelisted.length?i.push(e[o]):(this._getScaleFromDimensions(t,r,e[o].width,e[o].height,n)>=(r<1e3/(window.devicePixelRatio||1)?1.75:1)&&(a=!0),i.push(e[o]),s=[e[o].width,e[o].height]))}return i}getCurrentSpeed(e="average"){let t=3,r=[1,2,5];return this._options.tests&&this._options.tests.harmonic_average&&this._options.tests.harmonic_average.group&&(e="harmonicAverage",t=this._getMaxLoadableSegmentsAuto(),r=[]),this.scanner.sorcerer.getCurrentSpeed({type:e,howMany:t,weights:r})}shouldUseSurroundSound(e,t){return"240p"!==e[t].quality}getAudioIndexFromVideo(e,t,r){if(0===t.length)return!1;if(!e[r])return 0;const n=t.filter(({channels:e})=>e>2);if(n.length>0&&this.shouldUseSurroundSound(e,r)){const e=n[n.length-1];return t.indexOf(e)}return t.length>1&&0===r&&e[r].height<=360&&e.length>1?"mp4a.40.2"===t[0].codecs&&t[0].bitrate<8e4&&"240p"!==e[r].quality?1:0:t.length-1}_getVisibleDimensions(e,t,r,n){const i=r/n,s=e-t*i,a=t-e/i;let o=e-s,c=t-a;return s>0&&(c=t),a>0&&(o=e),[o,c]}_getScaleFromDimensions(e,t,r,n,i=null){const s=this._getVisibleDimensions(e,t,r,n);let a=r*n;i&&(a*=i);const o=window.devicePixelRatio||1;return a/(s[0]*s[1]*o*o)}_getMaxLoadableSegmentsAuto(){const e=function(e,t){return e&&e.tests&&e.tests[t]?e.tests[t]:null}(this._options,"lookahead_count");return e&&e.group&&e.data.count?e.data.count:e&&e.data.segment_lookahead_count?e.data.segment_lookahead_count:3}getBufferTarget(){return this._bufferTargetSeconds}_getSecondsToLoadAhead(e,t,r,n=!1){if(n)this._bufferTargetSeconds=1*this.SEGMENT_DURATION;else if(1===this.whitelisted.length){const e=11e6,t=r&&r.bitrate>e;this._bufferTargetSeconds=t?30:15*this.SEGMENT_DURATION}else this._bufferTargetSeconds=this._getMaxLoadableSegmentsAuto()*this.SEGMENT_DURATION;return this._bufferTargetSeconds}_timesAreInRange(e,t,r,n,i=0){if(!r)return!1;t=Math.min(t,n);for(let n=0;n<r.length;n++){const s=r.start(n),a=r.end(n),o=Ji(s)-i,c=Ji(a)+i;if(o<=e&&c>=t){if(t<s||e>a)continue;return!0}}return!1}_hasSeparateStreams(e){return e.video.length>0&&e.audio.length>0}_isSegmentInBuffer(e,t,r,n){let i=1;return this._hasSeparateStreams(n)&&(i=.1),this._timesAreInRange(e.start,e.end,t,r,i)}}class jo extends Vo{get displayName(){return"Skyfire"}constructor(e,t={}){super(e,t),this.BANDWIDTH_UPSWITCH_THRESHOLD=.85,this.BANDWIDTH_DOWNSWITCH_THRESHOLD=.9,this.DEFAULT_TIMEOUT=8e3,this.SEGMENT_RELATIVE_TIMEOUT_RATIO=4/3,this.MINIMUM_TIMEOUT=1e3,this.FRAME_DROP_WINDOW_SECONDS=10}shouldPowerUp(e,t,r){r&&this._options.startingBandwidthThreshold&&(this.BANDWIDTH_UPSWITCH_THRESHOLD=this._options.startingBandwidthThreshold);let n=e.indexOf(t);if(-1===n&&(n=0),!this.canPowerUp(e,n))return Promise.resolve({index:!1,reasonForSwitch:null});const i=this.getCurrentSpeed();if(!i)return Promise.resolve({index:!1,reasonForSwitch:null});const s=this.getStreamFromSpeed(i,e,this.BANDWIDTH_UPSWITCH_THRESHOLD);return s===n||!r&&s>n&&ge(this.scanner.currentTime,this.scanner._video.buffered)<1.5*this.SEGMENT_DURATION?Promise.resolve({index:!1,reasonForSwitch:null}):Promise.resolve({index:s,reasonForSwitch:3})}shouldPowerDown(e,t){const r=e.indexOf(t);if(-1===r){const t=this.isTimeInBuffer(this.scanner._video.duration,this.scanner._video.buffered,this.scanner._video.duration);return this.whitelisted.length||this.blacklisted.length||!t?Promise.resolve({index:e.length-1,reasonForSwitch:6}):Promise.resolve({index:!1,reasonForSwitch:null})}if(!this.canPowerDown(e,r))return Promise.resolve({index:!1,reasonForSwitch:null});const n=this.getCurrentSpeed();if(!n)return Promise.resolve({index:!1,reasonForSwitch:null});if(this.hasTooManyDroppedFrames(r,t,this._options.droppedFrameSwitchPercent))return this.blacklist(r),Promise.resolve({index:r-1,reasonForSwitch:2});const i=this.getStreamFromSpeed(n,e,this.BANDWIDTH_DOWNSWITCH_THRESHOLD);return i===r?Promise.resolve({index:!1,reasonForSwitch:null}):Promise.resolve({index:i,reasonForSwitch:1})}hasTooManyDroppedFrames(e,t,r){return this.scanner.sorcerer.getDroppedFrameRate(this.FRAME_DROP_WINDOW_SECONDS,e,"median")/t.framerate*100>=r}getTimeEstimateToLoad(e,t){var r;const n=null==t||null==(r=t.segments)?void 0:r[e];if(!n)return 3;const i=this.getCurrentSpeed(),s=n.end-n.start;return n.size?(8*n.size+t.audioBitrate*s)/i*1.3:s*(t.avg_bitrate+t.audioBitrate)/i*1.3}canPlayFromTimeInStream(e,t){if(!this.isTimeInBuffer(e,this.scanner._video.buffered,this.scanner._video.duration))return!1;if(!t)return!1;const r=this.getSegmentsToLoad(!1,this.STREAM_TYPE_VIDEO,t);if(0===r.length)return!0;const n=ge(e,this.scanner._video.buffered);return this.getTimeEstimateToLoad(r[0],t)<n}getSegmentsToLoad(e,t=this.STREAM_TYPE_VIDEO,r,n=!1){const i=this.scanner._video;if(i.webkitCurrentPlaybackTargetIsWireless)return[];const s=this.scanner.currentTime,a=[],o=s+this._getSecondsToLoadAhead(s,i.duration,r,n),c=this.scanner.sorcerer[t].activeStreamIndex,u=this.scanner._streams[t][c];if(!u)return a;const l=this.scanner.sorcerer[t].sourceBuffer;let h=null;l&&(h=l.buffered);for(let t=0;t<u.segments.length;t++){const r=u.segments[t];if(r.end<s||r.start>o)continue;const n=s>=r.start&&s<r.end,i=this._isSegmentInBuffer(r,h,this.scanner._video.duration,this.scanner._streams);!e&&i||e&&i&&n||(n||o>=r.start)&&a.push(t)}return a}getSegmentRelativeTimeout(e,t,r){var n;const i=null==t?void 0:t.avg_bitrate,s=null==(n=e[0])?void 0:n.avg_bitrate;if(!i||!s||!r)return this.DEFAULT_TIMEOUT;if(i===s)return this.DEFAULT_TIMEOUT;const a=r*this.SEGMENT_RELATIVE_TIMEOUT_RATIO;return Math.max(this.MINIMUM_TIMEOUT,Math.min(this.DEFAULT_TIMEOUT,a))}getStreamFromSpeed(e,t,r=this.BANDWIDTH_UPSWITCH_THRESHOLD){let n=0;for(let i=n;i<t.length;i++)e*r>t[i].avg_bitrate+t[i].audioBitrate&&(n=i);return n}}class Ho{constructor(e,t){this._video=e,this._getCurrentStream=t}start(){return clearInterval(this._checkGapInterval),this._checkGapInterval=setInterval(this._checkGap.bind(this),200),this._checkGap()}stop(){clearInterval(this._checkGapInterval)}onSegmentAppended(){this._checkGap()}_checkGap(){const e=this._video.buffered,t=this._video.currentTime,r=this._getGapIndex(e,t);if(0===this._video.readyState)return!1;if(this._video.paused)return!1;const n=this._video.duration;if(t>=n)return this._video.currentTime=n-.1,!0;if(e.length<=r)return!1;const i=e.start(r);return!(i>=n)&&!(i-t>.5||0!==r||(this.stop(),this._correctFirstSegmentStart("audio",i),this._correctFirstSegmentStart("video",i),this._video.currentTime=i,0))}_getGapIndex(e,t){if(!e||!e.length)return null;let r=0;for(;r<e.length;r++){const n=e.start(r),i=e.end(r);if(n>t&&(0===r||i-t<=.1))break}return r>=0?r:null}_correctFirstSegmentStart(e,t){const r=this._getCurrentStream(0,e);r&&r.segments&&r.segments[0]&&(r.segments[0].start=t)}}const Bo="br",Xo="bl",Wo="pr",qo="sid",Go="cid",Ko="sf",Yo="st",$o="ot",zo="HLSLiveScanner",Qo="HlsJsScanner",Jo="HTMLScanner",Zo="MediaSourceScanner",ec="NativeHLSLiveScanner";class tc{constructor(e,t={}){this._scanner=e,this.sessionId=t.sessionId,this.clipId=t.clipId}getLogAsQueryParam(e,t){return this._buildCMCDQueryParam(this._getLog(e,t))}_getLog(e,t){let r={};return Object.assign(r,this._getStaticSessionData()),Object.assign(r,this._getDynamicSessionData(e,t)),r}_buildCMCDQueryParam(e){return P({CMCD:this._getObjectAsAlphabetizedString(e)})}_getStaticSessionData(){return{[qo]:`"${this.sessionId}"`,[Go]:`"${this.clipId}"`,[Yo]:this._getStreamType(),[Ko]:this._getStreamingFormat()}}_getDynamicSessionData(e,t){return{[Wo]:this._scanner.playbackRate,[Bo]:this._scanner.getBitrateAtTime(this._scanner.currentTime,t,"max")/1e3,[$o]:this._getObjectType(t),[Xo]:this._getBufferLength(e)}}_getObjectType(e){switch(e){case"audio":return"a";case"video":return"v";default:return"av"}}_getBufferLength(e){return Math.round(1e3*(parseFloat(e.end)-parseFloat(e.start)))}_getStreamType(){switch(this._scanner.displayName){case zo:case ec:case Qo:return"l";default:return"v"}}_getStreamingFormat(){switch(this._scanner.displayName){case zo:case ec:case Qo:return'"hls"';default:return'"dash"'}}_getObjectAsAlphabetizedString(e){let t=[],r="";for(var n=0,i=Object.entries(e);n<i.length;n++){const[e,r]=i[n];t.push({key:e,value:r})}return t.sort((e,t)=>e.key.localeCompare(t.key)).forEach(({key:e,value:t})=>{r+=`${e}=${t},`}),r.replace(/,\s*$/,"")}}function rc(e,t,r){return r?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}const nc=["supported"];function ic(e,t){var r=e();return r&&r.then?r.then(t):t(r)}const sc=new Map;function ac(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}const oc=V("MediaCapabilities","color: white; background-color: green"),cc=ac(function(e){let t;const r=hc(e);return sc.get(r)||ic(function(){if(ue.mediaCapabilities){const n=e.codecs.replace(/,.+/,""),i={type:"media-source",video:{contentType:`${e.mime_type}; codecs=${n}`,width:e.width,height:e.height,bitrate:e.bitrate,framerate:e.framerate}};return rc(navigator.mediaCapabilities.decodingInfo(i),function(e){t=e,sc.set(r,t)})}},function(){return t})}),uc=ac(function(e=[]){let t=!1,r=e,n=[],i=[];return ic(function(){if(ue.mediaCapabilities)return function(){if(0!==e.length)return function(s,a){try{var o=rc(Promise.all(e.map(function(e){return rc(cc(e))})),function(s){if(s){if(r=function(e,t){return e.filter((e,r)=>nc.every(e=>t[r][e])||(oc(`Stream ${e.quality} is not supported`,t[r]),!1))}(e,s),0===r.length)return oc("No compatible streams found. Returning all available streams as safeguard."),t=!0,{compatibleStreams:e,incompatibleStreams:n,incompatibleStreamsAttributes:i};r.length<e.length?(n=e.filter(e=>-1===r.indexOf(e)),i=n.map(lc),oc("Some streams are not supported. Returning compatible streams.")):oc("All streams are supported.")}})}catch(e){return a(e)}return o&&o.then?o.then(void 0,a):o}(0,function(e){oc("Error checking stream capabilities",e)});oc("No streams to check for MediaCapabilities support")}();oc("MediaCapabilities API not supported")},function(e){return t?e:{compatibleStreams:r,incompatibleStreams:n,incompatibleStreamsAttributes:i}})});function lc(e){const t=hc(e),r=sc.get(t);return r?nc.filter(e=>!r[e]):[]}function hc(e){return`${e.mime_type};${e.codecs};${e.width};${e.height};${e.bitrate};${e.framerate}`}function dc(){}function fc(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}function _c(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}function pc(e,t,r){return r?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}const vc=_c(function(e,t,r){const n=function(e){const t=e.audio||[],r=e.video||[];return[{video:"HW_SECURE_ALL",audio:"SW_SECURE_CRYPTO"},{video:"HW_SECURE_DECODE",audio:"SW_SECURE_CRYPTO"},{video:"HW_SECURE_CRYPTO",audio:"SW_SECURE_CRYPTO"},{video:"SW_SECURE_DECODE",audio:"SW_SECURE_CRYPTO"},{video:"SW_SECURE_CRYPTO",audio:"SW_SECURE_CRYPTO"}].map(e=>{const n={persistentState:"optional",sessionTypes:["temporary"],videoCapabilities:[],audioCapabilities:[]};return r.length&&(n.videoCapabilities=r.map(t=>({contentType:t,robustness:e.video}))),t.length&&(n.audioCapabilities=t.map(t=>({contentType:t,robustness:e.audio}))),n})}(r);return Promise.all(Object.keys(e).map(_c(function(r){const i=e[r].id;let s=null;return function(e,t){return e&&e.then?e.then(t):t()}(fc(function(){return function(){var e=function(){if(!t)return pc(navigator.requestMediaKeySystemAccess(i,n),function(e){return pc(e.createMediaKeys(),function(e){s=e})});s=new window.WebKitMediaKeys(i)}();if(e&&e.then)return e.then(dc)}()},function(e){}),function(){return{name:i,mediaKeys:s}})})))}),mc=["embed.criterionchannel.com","embed.criterionchannel.vhx.tv"];const gc=_c(function(e,t){return function(e){if(e&&e.then)return e.then(dc)}(fc(function(){return function(e){return e&&e.then?e.then(dc):Promise.resolve()}(t.setServerCertificate($i(e)))},function(e){}))});function Ec(e,t,r){return r?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}const Tc="video";function yc(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}const Sc="audio";class bc extends As{static get displayName(){return"MediaSourceScanner"}static get supportsMse(){return!0}static get supportsLive(){return!1}static supported(e){const t=B(e);return void 0!==t&&t.isTypeSupported}static get supportedVideoTypes(){return[b.dash,b.dashMpd]}constructor(e,t={}){super(e,t),this.reset(),this.manifestLoadDurations=[],this._preserveCurrentTime=!1,this._preloadStreamIndex=null,this._drmSetupError=null}deactivate(){super.deactivate(),this.sorcerer&&this.sorcerer.destroy(),this.reset()}reset(){this._waitingOnSet=new Set,this._streamsForSegment={},ue.browser.safari&&(this._gapJumper=new Ho(this._video,this._getCurrentStream.bind(this))),this.resetBrain(),this._setupCMCDLogger(),this._ready=!1,this._startedPlaying=!1,this._manifest=null,this._streams={},this._streams[Sc]=[],this._streams[Tc]=[],this._audioStreams=[],this._onReady=null,this._baseUrl=null,this._lastTargetStreamId=null,this._timeToSeekTo=null,this._seekInProgressPromise=null,this._resolveSeek=null,this._resolveStartPreload=null,this._reloadingExistingVideo=!1,this._lastStreamIndex=null,this._checkSwitchUp=!1,this._clearBufferAtTime=!1,this._preloadStream=null,this._removeBufferPromise=null,this._ranIntoBuffer=!1,this._restrictedStreamIndexes=[],this._switching={},this._lastDownloadBitrate=0,this._preloadSegmentStreamIndex=null,this._preserveCurrentTime=!1,this._preloadStreamIndex=null,this._drmSetupError=null,clearInterval(this._loadSegmentsInterval),clearTimeout(this._slowLoadSegmentTimeout)}resetBrain(){const e=this._options.mediaSourceScanner||{};e.tests=this._options.tests,this._brain&&this._brain.destroy(),this._brain=new jo(this,e)}preloadStream(){if(this._preloadStream)return this._preloadStream;let e=0,t=1;this._streams.audio.length&&(t=2);let r=this._getStartingStreamIndex(),n=0;const i=this._brain.getSegmentsToLoad(!1,Tc,r);i.length>0&&(n=i[0]);let s=()=>{};const a=(e=!1)=>{e&&(r=this.sorcerer.video.activeStreamIndex),this._preloadSegmentStreamIndex=r,this._restartLoadSegmentsIntervalWithBackoff(!0)},o=r=>{e+=1,e<t||(r.segment===n&&1!==this._restrictedStreamIndexes.length&&null===this._preloadStreamIndex?this._getStreamIndexToLoadAndSwitchReason(!0).then(t=>{let{index:n,reasonForSwitch:i}=t,o={reasonForSwitch:i};if(!1!==n&&n>r.stream){if(this.sorcerer.video.switchTo(n,!1,o),this._streams.audio.length){const e=this._brain.getAudioIndexFromVideo(this._streams.video,this._streams.audio,n);this.sorcerer.audio.switchTo(e,!1)}return e=0,void a(!0)}s()}).catch(console.error):s())};return this._preloadStream=new Promise(e=>{s=()=>{const t=this._getCurrentStream(r).segments[0].end,n=this._getDuration(!0);if(this.currentTime>=n&&(this.currentTime=n),this.currentTime>t&&(this.sorcerer.clear(),this._waitingOnSet=new Set),this.sorcerer.video.switchTo(r,!1),this._streams.audio.length){const e=this._brain.getAudioIndexFromVideo(this._streams.video,this._streams.audio,r);this.sorcerer.audio.switchTo(e,!1)}this.sorcerer.off("bufferqueueadd",o),this._preloadSegmentStreamIndex=null,this._ready=!0,e()},this.sorcerer.on("bufferqueueadd",o),a()}),this._preloadStream}loadManifest(t){const r=this;return function(e){try{var t=Promise.resolve(e());return t}catch(e){return Promise.reject(e)}}(function(){return Ec(r.video.metadata.p2pReady,function(){const n=Date.now();return ue.browser.ie&&t&&-1!==t.indexOf("archive_playlist")?(setTimeout(()=>{r._fireVideoError(us,"An unknown error occurred.")},250),new Promise(()=>{})):Ye({url:t,timeout:1e4,type:e.MANIFEST}).then(e=>(e.url&&e.url!==t&&-1!==e.url.indexOf("live-archive")&&(r._baseUrl=e.url.split("/").slice(0,-2).join("/")),r.manifestLoadDurations.push({url:t,status:e.status,duration:Date.now()-n}),r.fire(Ui.MANIFEST_LOADED),e.text())).then(yc(function(e){let n;return function(i,s){var a=function(){if(-1!==t.indexOf(".mpd"))return Ec(r._loadMediaManifest(),function({parseMPD:i}){const s=r._telecineVideo.enabledAudioTrack,a={audioLang:null==s?void 0:s.language};n=i(e,t,a)});n=JSON.parse(e)}();return a&&a.then?a.then(s):s()}(0,function(){return n})})).catch(e=>{if(r.manifestLoadDurations.push({url:t,status:e.response&&e.response.status,duration:Date.now()-n}),r.reset(),e instanceof Re&&410===e.response.status)return r.fire(Ui.MEDIA_URL_EXPIRED),new Promise(()=>{});throw e instanceof Re&&400===e.response.status?r.fire(Ui.MEDIA_URL_BAD_REQUEST,e.response.url):e instanceof De&&r.fire(Ui.MANIFEST_TIMEOUT),e})})})}setVideoSrc(e,t,r=!0){if(r&&!t&&this._onReady){if(("metadata"===this._preload||"none"===this._preload&&!this.paused)&&!this._ready)return void this._onReady.then(()=>{const t=this.paused;this.setVideoSrc(e,t,!1)}).catch(console.error);const t=this._telecineVideo.drmHandler;if(t&&"sd-fallback"===t.state&&!t.hasFallbackSourceUpdated)return void this._onReady.then(()=>{this.setVideoSrc(e,!0,!1)}).catch(console.error);if("auto"===this._preload)return void this._onReady.then(()=>{this.setVideoSrc(e,!1,!1)}).catch(console.error)}t&&this.reset(),t||!this.paused||this.sorcerer||(t=!0);let n=this._initializeManifest;t&&(n=this._initialize);const i=e.split("/");i.pop();const s=`${i.join("/")}/`;this._reloadingExistingVideo=!t,this._onReady=this._startPreload(e,this._preload).then(this.loadManifest.bind(this)).then(e=>"string"==typeof this._baseUrl&&-1!==this._baseUrl.indexOf("live-archive")?e:(this._baseUrl=s,{manifest:e,isConfigRefresh:!t})).then(n.bind(this)),t&&"auto"===this._preload&&(this._onReady=this._addCallbackToPromise(this._onReady,this.preloadStream.bind(this),!1)),this._onReady=this._addCatchToPromise(this._onReady)}get preload(){return this._preload}set preload(e){this._handlePreloadChanged(this._preload,e),this._preload=e}get videoElement(){return this._video}get videoWidth(){const e=this._getCurrentStream();return e?e.width:this._video.videoWidth}get videoHeight(){const e=this._getCurrentStream();return e?e.height:this._video.videoHeight}get restrictedStreamIndexes(){return this._restrictedStreamIndexes}set restrictedStreamIndexes(e){this._restrictedStreamIndexes.join(",")!==e.join(",")&&(this._restrictedStreamIndexes=e,this._onReady.then(()=>this.lockStreamIndexes()).catch(console.error))}get preloadStreamIndex(){return this._preloadStreamIndex}set preloadStreamIndex(e){this._preloadStreamIndex=e;const t=null!==e?[this._preloadStreamIndex]:this._restrictedStreamIndexes;this._brain.lock(t)}get currentTime(){return null!==this._timeToSeekTo?this._timeToSeekTo:this._video.currentTime}set currentTime(e){(this._startedPlaying||0!==e)&&(this._hasAudioVideoMismatch&&this._audioDuration&&e>this._audioDuration-1&&!this._brain.isTimeInBuffer(e,this._video.buffered,this._video.duration)&&(e=this._audioDuration-1),this.seekToTime(e))}get downloadSpeed(){return this._lastDownloadBitrate}get brainDebug(){const e=this.sorcerer&&this._brain&&this._brain.getCurrentSpeed?this._brain.getCurrentSpeed():null;let t=this.sorcerer&&this.sorcerer.getResponseSpeeds?this.sorcerer.getResponseSpeeds():null;return t=t?t.slice(-20):[],{currentSpeed:e,responseSpeeds:t}}get isLowerProfileAvailable(){return this.sorcerer?this.sorcerer[Tc].activeStreamIndex>0:null}get videoStreams(){return this._streams[Tc]}getBufferTarget(){if(this._brain&&this._brain.getBufferTarget)return this._brain.getBufferTarget()}getBitrateAtTime(e,t="video",r="average"){if(!this.sorcerer)return 0;const n=this.sorcerer.streamIndexAtTime(e,t),i=this._streams[t][n];var s;return i?null!==(s=i["average"===r?"avg_bitrate":"bitrate"])&&void 0!==s?s:i.bitrate:0}lockStreamIndexes(){const e=this._restrictedStreamIndexes.map(e=>this._streams[Tc].indexOf(this._streams[Tc][e])),t=!this.paused;if(t&&(this._ignorePauseEvent=!0,this._video.pause()),this._switching[Tc]=!1,this._brain.lock(e),!this._startedPlaying&&"auto"!==this._preload)return;const r=Math.max(this.currentTime-7,0),n=Math.min(this.currentTime+7,this._video.duration);this.sorcerer.removeBuffer(r,n).then(()=>{!this._startedPlaying&&"auto"===this._preload||this.ended?this._loadSegments():(this.seekToTime(this.currentTime),t&&this.paused&&(this._ignorePlayEvent=!0,this._video.play()))}).catch(console.error)}seekToTime(e){if(e===this.currentTime)return Promise.resolve();if(null===this._timeToSeekTo||(this._lastSeekReject&&(this._lastSeekReject(),this._lastSeekReject=null),this._seekInProgressPromise=null,this._timeToSeekTo=null,this._resolveSeek=null),this._timeToSeekTo=e,this._handleScrubbing(),this._ready)for(const e in this._streams)if(this._streams[e].length>0){const t=this.sorcerer[e].activeStreamIndex;this.sorcerer[e].streams[t].abort()}return this._seekInProgressPromise=this._getSeekReadyPromiseForTime(e),Promise.all([this._onReady,this._removeBufferPromise]).then(()=>{this._loadSegments()}).catch(console.error),this._paused&&0===e&&this.fire(Oi.SEEKING),this._onReady.then(()=>this._seekInProgressPromise).catch(e=>{})}takeSnapshot(){this._switchingVideo&&super.takeSnapshot()}initDrm(){}onstalled(){return!1}onseeked(e){this._startedPlaying&&this._restartLoadSegmentsIntervalWithBackoff()}onended(e){return super.onended(e),!0}onseeking(e){this._startedPlaying}_handleScrubbing(){this._scrubStart(),clearTimeout(this._scrubTimeout),this._scrubTimeout=setTimeout(()=>{this._scrubEnd()},200)}_scrubStart(){this._scrubbing||(this._scrubbing=!0)}_scrubEnd(){this._scrubbing=!1}ontimeupdate(e){if(!this.sorcerer)return!1;if(super.ontimeupdate(),this._gapJumper&&this._gapJumper.stop(),0===this.currentTime)return this._startedPlaying;if(this._timeToSeekTo)return!1;if(this._startedPlaying||(this._startedPlaying=!0),this._clearBufferAtTime&&this.currentTime>=this._clearBufferAtTime){const e=2;this.sorcerer.removeBuffer(0,this._clearBufferAtTime-e),this._clearBufferAtTime=!1}const t=this.sorcerer.getDroppedFrameTotal();this.fire(Ui.DROPPED_FRAMES,t);const r=this.sorcerer.getResponseSpeeds(),n=this._streams[Tc][this.sorcerer.video.activeStreamIndex],i=this._options.tests&&this._options.tests.download_bitrate;if((!i||!i.group)&&n&&this._brain.getCurrentSpeed){const e={speed:this._brain.getCurrentSpeed(),bitrate:n.avg_bitrate,speeds:r};this.fire(Ui.BANDWIDTH,e)}const s=this._video.buffered.length;if(!s)return!0;const a=this._video.buffered.end(s-1);return Math.ceil(a)===Math.ceil(this._video.duration)||(Math.abs(this.currentTime-a)<.2?(this._ranIntoBuffer||(this.fire(Ui.STREAM_BUFFER_START,{hasLowerStreamIndex:this.sorcerer[Tc].activeStreamIndex>0}),this._ranIntoBuffer=!0),!1):void 0)}_isEnded(){return!!this.ended||Math.ceil(this.currentTime)===Math.ceil(this._video.duration)}_loadSegmentsIntervalTick(){if(!this.sorcerer)return!1;if("closed"===this.sorcerer.readyState)return!1;if(this._video.webkitCurrentPlaybackTargetIsWireless)return!1;if(this._isEnded())return!1;if(null!==this._preloadSegmentStreamIndex){try{this._loadPreloadSegments()}catch(e){return this._handleLoadSegmentFailures(e),!1}return!0}if(0===this.currentTime&&!this._ready)return this._startedPlaying;const e=this._loadSegments();return e&&"function"==typeof e.catch&&e.catch(this._handleLoadSegmentFailures.bind(this)),!0}_handleLoadSegmentFailures(e){e.code===DOMException.INVALID_STATE_ERR?this.fire(Ui.SCANNER_ERROR,{reason:e}):this.fire(Ui.LOAD_SEGMENT_FAILED,new TelecineError(`${Ui.LOAD_SEGMENT_FAILED} - ${e.name}`,e.message)),clearInterval(this._loadSegmentsInterval)}onprogress(){this._brain.canPlayFromTimeInStream(this.currentTime,this._getCurrentStream())&&this._ranIntoBuffer&&(this.fire(Ui.STREAM_BUFFER_END),this._ranIntoBuffer=!1)}onwaiting(){return!this._gapJumper||!this._gapJumper.start()}onerror(){return!!this._video.error&&(this._video.error.code===this._video.error.MEDIA_ERR_DECODE?(this.fire(Ui.SCANNER_ERROR,{reason:`encountered media decode error. Message: "${this._video.error.message}"`}),!1):this._video.error.code===this._video.error.MEDIA_ERR_SRC_NOT_SUPPORTED?(this._preserveCurrentTime=!0,this.fire(Ui.SCANNER_ERROR,{reason:`encountered media source not supported error. Message: "${this._video.error.message}"`}),!1):super.onerror())}pause(){super.pause()}play(){return null!==this._drmSetupError?(this._fireVideoError(cs,{text:null,code:this._drmSetupError}),Promise.reject()):(this._restartLoadSegmentsIntervalWithBackoff(),super.play(()=>(this._resolveStartPreload&&this._resolveStartPreload(),(!this._reloadingExistingVideo&&!this._ready&&"auto"!==this._preload||this._video.webkitCurrentPlaybackTargetIsWireless)&&(this._onReady=this._addCallbackToPromise(this._onReady,this.preloadStream.bind(this))),this._onReady.then(()=>Promise.resolve(this._seekInProgressPromise)))))}onpause(){return this._ignorePauseEvent?(this._ignorePauseEvent=!1,!1):(super.onpause(),!0)}onplay(){return!this._ignorePlayEvent||(this._ignorePlayEvent=!1,!1)}_addCallbackToPromise(e,t,r=!0){let n=e.then(t);return r&&(n=this._addCatchToPromise(n)),n}_addCatchToPromise(e){return e.catch(e=>(this.fire(Ui.FILE_ERROR,{reason:e}),new Promise(()=>{})))}_handleBufferForSeek(){this._ready&&this._streams[Tc][this.sorcerer.video.activeStreamIndex].bitrate/1e3>12e3&&(this._removeBufferPromise=this.sorcerer.removeBuffer())}_startPreload(e,t){return new Promise(r=>{var n;"none"!==t||this._reloadingExistingVideo&&!this.paused||"sd-fallback"===(null==(n=this._telecineVideo.drmHandler)?void 0:n.state)?r(e):this._resolveStartPreload=()=>{r(e),this._resolveStartPreload=null}})}_getSeekReadyPromiseForTime(e=this._timeToSeekTo){return new Promise(t=>{const r=this._startedPlaying&&0===e,n=this._brain.canPlayFromTimeInStream(e,this._getCurrentStream());r||n?t(e):(this._handleBufferForSeek(),this._resolveSeek=t)}).then(e=>{this._timeToSeekTo=null,this._seekInProgressPromise=null;const t=new Promise((e,t)=>{this._lastSeekReject=t;const r=()=>{e(this._video.currentTime),this._video.removeEventListener("seeked",r)};this._video.addEventListener("seeked",r)});return this._video.currentTime=e,t})}_handlePreloadChanged(e,t){"auto"!==e&&"auto"===t&&(this._onReady=this._addCallbackToPromise(this._onReady,this.preloadStream.bind(this))),e!==t&&"none"!==t&&this._resolveStartPreload&&this._resolveStartPreload()}_avDurationDifference(e){const t=e.audio.reduce((e,t)=>e+t.duration,0),r=e.video.reduce((e,t)=>e+t.duration,0),n=t/e.audio.length,i=r/e.video.length;return n+4<i?i-n:0}_checkAVMismatch(e){if(!e.audio)return;const t=this._avDurationDifference(e);t>0&&(this._hasAudioVideoMismatch=!0,this.fire(Ui.AV_DURATION_MISMATCH,t),this._audioDuration=e.audio.reduce((e,t)=>Math.max(e,t.duration),0))}_processVideoStreams(e){const t=this;return new Promise(yc(function(r){return Ec(uc(e),function({compatibleStreams:e,incompatibleStreams:n,incompatibleStreamsAttributes:i}){n.length&&(t.fire(Ui.AVAILABLE_STREAMS_CHANGED),t.fire(Ui.MEDIA_CAPABILITY_STREAMS_UNSUPPORTED,{incompatibleStreams:n,incompatibleStreamsAttributes:i})),r(e)})}))}_manifestContainsSegmentSizes(e){return e.video.every(e=>e.segments.every(e=>"size"in e))}_initializeManifest(e){const t=this;return new Promise(yc(function(r,n){const{manifest:i,isConfigRefresh:s}=e;return i.video||t.fire(Ui.SCANNER_ERROR,{reason:"no video streams found in manifest"}),t._manifest=i,t._checkAVMismatch(i),Ec(t._processVideoStreams(i.video),function(e){t._streams[Tc]=t._sortVideoStreams(e);const n=(e=>{if(!e||!e.length)return[];const t=(e=>e.filter(e=>"opus"===e.codecs&&(!e.ambisonic_order||!ue.browser.chromium||e.ambisonic_order<=1)))(e),r=e.filter(e=>"opus"!==e.codecs);return ue.browser.safari||ue.iOS||ue.iPadOS||!B().isTypeSupported('audio/mp4; codecs="opus"')||!t.length?r:t})(i.audio);t._streams[Sc]=t._sortAudioStreams(n);for(let e=0;e<t._streams[Tc].length;e++){let r=0;if(i.audio){const n=t._brain.getAudioIndexFromVideo(t._streams.video,t._streams.audio,e),i=t._streams[Sc][n];i&&(r=i.avg_bitrate)}t._streams[Tc][e].audioBitrate=r}s||t._initDrm(t._streams[Tc],t._streams[Sc],t._manifest.key_info),t._manifestContainsSegmentSizes(i)||t.resetBrain(),t.fire(Ui.STREAMS_LOADED,t._streams),r()})}))}_setUpSorcerer(e,t){if(this.sorcerer&&this.sorcerer.destroy(),this.sorcerer=new Uo(e,t),this.sorcerer.isInstanceofManagedMediaSource(this.sorcerer.mediaSource)){const t=document.createElement("source");t.type="video/mp4",t.src=URL.createObjectURL(this.sorcerer.mediaSource),e.appendChild(t);const{src:r,mime:n}=this._telecineVideo.externalDisplayFiles.AirPlay,i=document.createElement("source");i.type=n,i.src=r,e.appendChild(i)}else e.src=URL.createObjectURL(this.sorcerer.mediaSource);this.successfulSegments=this.sorcerer.getSuccessfulSegments(),this.failedSegments=this.sorcerer.getFailedSegments(),this._restartLoadSegmentsIntervalWithBackoff()}_restartLoadSegmentsIntervalWithBackoff(e=!1){this._restartLoadSegmentsInterval(500),clearTimeout(this._slowLoadSegmentTimeout),this._slowLoadSegmentTimeout=setTimeout(()=>{this._restartLoadSegmentsInterval(5e3)},6e4),e&&this._loadSegmentsIntervalTick()}_restartLoadSegmentsInterval(e){clearInterval(this._loadSegmentsInterval),this._loadSegmentsInterval=setInterval(()=>{this._loadSegmentsIntervalTick()},e)}_getDuration(e=!1){let t=e?1/0:0;for(const r in this._streams)this._streams[r].length&&(t=Math[e?"min":"max"](t,this._streams[r][0].duration));return t}_initialize(e){return this._initializeManifest(e).then(()=>{this._setUpSorcerer(this._video,{duration:this._getDuration(),fetcherTimeout:8e3,fetcherRetryAbortErrors:!1,disableMMS:this._options.disableMMS}),this.sorcerer.on("srcnotsupported",()=>{this.fire(Ui.SCANNER_ERROR,{reason:"this codec is not supported for mediasource playback"})}),this._video.addEventListener(Xi,e=>{const t=!this._video.webkitCurrentPlaybackTargetIsWireless,r="closed"===this.sorcerer.readyState;t&&r&&this.fire(Ui.SCANNER_ERROR,{reason:"MediaSource was closed during AirPlay, falling back to Native HLS playback."})});const e=this._getStartingStreamIndex();for(const e in this._streams)this._streams[e].forEach((t,r)=>{let n=this._getSegmentUrl(r,"init",e);this._useRangeRequests(r,e)&&this._streams[e][r].init_segment_range&&(n={url:n,byteRange:this._getRangeForSegment(r,"init",e)}),this.sorcerer.addStream(`${t.mime_type}; codecs="${this._streams[e][r].codecs}"`,n)});this.sorcerer.video.switchTo(e,!0,{reasonForSwitch:7}),this.sorcerer.on("queued",this._handleQueued.bind(this)),this.sorcerer.on("downloadabort",this._handleAborted.bind(this)),this.sorcerer.on("appendbufferend",this._handleAppendBufferEnd.bind(this)),this.sorcerer.on("downloadstart",this._handleDownloadStart.bind(this)),this.sorcerer.on("downloadend",this._handleDownloadEnd.bind(this)),this.sorcerer.on("downloaderror",this._handleDownloadError.bind(this)),this.sorcerer.on("downloadtimeout",this._handleDownloadTimeout.bind(this)),this.sorcerer.on("quotaexceedederror",this._handleQuotaExceededError.bind(this)),this.sorcerer.video.on("streamchange",this._handleStreamChange.bind(this)),this.sorcerer.video.on("streamchangestart",this._handleStreamChangeStart.bind(this)),this.sorcerer.mediaSource.addEventListener("sourceended",()=>{this.fire(Oi.PROGRESS)})})}_getStartingStreamIndex(){if(null!==this._preloadStreamIndex)return this._preloadStreamIndex;let e=this._streams[Tc],t=this.sorcerer.video.activeStreamIndex>0?this.sorcerer.video.activeStreamIndex:0;this._restrictedStreamIndexes.length&&(e=this._restrictedStreamIndexes.map(e=>this._streams[Tc][e]),t=this._restrictedStreamIndexes.includes(this.sorcerer.video.activeStreamIndex)?this._restrictedStreamIndexes.indexOf(this.sorcerer.video.activeStreamIndex):0);const r=this._brain.getCurrentSpeed();r&&(t=this._brain.getStreamFromSpeed(r,e));const n=e[t];return this._streams[Tc].indexOf(n)}_sortVideoStreams(e){const t=e.slice(0);return t.sort(function(e,t){const r=e.width*e.height*e.avg_bitrate,n=t.width*t.height*t.avg_bitrate;return e.width===t.width&&e.height===t.height?e.framerate-t.framerate:r-n}),t}_sortAudioStreams(e){const t=e.slice(0);return t.sort(function(e,t){return e.avg_bitrate*e.channels-t.avg_bitrate*t.channels}),t}_useRangeRequests(e,t){return!!this._streams[t][e].segments[0].range}_getRangeForSegment(e,t,r){return"init"===t?this._streams[r][e].init_segment_range:this._streams[r][e].segments[t].range}_getSegmentPriority(e,t,r=Tc){return"init"===t?0:this._streams[r][e].segments[t].start}_getSegmentUrl(e,t,r=Tc,n=!1){if("init"===t&&!this._streams[r][e].init_segment_url)return function(e){return $i(e).buffer}(this._streams[r][e].init_segment);let i=this._baseUrl;const s=this._manifest.base_url&&-1!==this._manifest.base_url.indexOf("//");if(s&&(i=this._manifest.base_url),this._manifest.base_url&&!s&&(i+=this._manifest.base_url),this._streams[r][e].base_url&&(i+=this._streams[r][e].base_url),this._useRangeRequests(e,r))return i;if("init"===t)return i+=this._streams[r][e].init_segment_url,i;const a=this._streams[r][e].segments[t];a.url&&(i+=a.url);const o="akfire_interconnect_quic"===this._telecineVideo.currentFile.metadata.cdn,c=-1===i.indexOf("?")?"?":"&";return n&&this.CMCDLogger&&o&&(i+=`${c}${this.CMCDLogger.getLogAsQueryParam(a,r)}`),i}_key(e,t,r){return`${e}:${t}:${r}`}_isFinalSegment(e,t,r){return t===this._streams[r][e].segments.length-1}_getCurrentlyLoadingStreamsForSegment(e,t){const r=[],n=this._streamsForSegment[e];if(!n)return r;for(let i=0;i<n.length;i++)this._waitingOnSet.has(this._key(n[i],e,t))&&r.push(n[i]);return r}getCurrentStream(e="video"){return this._getCurrentStream(0,e)}_getCurrentStream(e=0,t=Tc){return void 0!==this.sorcerer&&(e=this.sorcerer[t].activeStreamIndex),this._streams[t][e]}_getStreamIndexToLoadAndSwitchReason(e){let t=this._streams[Tc];const r=this.video&&this.video.metadata.percentShown?this.video.metadata.percentShown:null;if(t=this._brain.filterStreams(t,this._video.clientWidth,this._video.clientHeight,r),0===t.length)return Promise.resolve({index:!1,reasonForSwitch:null});if(this._switching[Tc])return Promise.resolve({index:!1,reasonForSwitch:null});const n=t[t.length-1];if(n.id!==this._lastTargetStreamId){this._lastTargetStreamId=n.id;const e={index:this._streams[Tc].indexOf(n),streams:this._streams[Tc]};this.fire(Ui.STREAM_TARGET_CHANGE,e)}const i=this._getCurrentStream();return this._brain.shouldPowerUp(t,i,e).then(e=>!1===e.index?this._brain.shouldPowerDown(t,i).then(e=>!1===e.index?{index:e.index,reasonForSwitch:e.reasonForSwitch}:{index:this._streams[Tc].indexOf(t[e.index]),reasonForSwitch:e.reasonForSwitch}):{index:this._streams[Tc].indexOf(t[e.index]),reasonForSwitch:e.reasonForSwitch})}_loadSegmentsForType(e=Tc){return this.sorcerer.allowSegmentRequests?this._getStreamIndexToLoadAndSwitchReason(!1).then(t=>{let{index:r,reasonForSwitch:n}=t,i={reasonForSwitch:n};e===Sc&&(!1===r&&(r=this.sorcerer[Tc].activeStreamIndex),r=this._brain.getAudioIndexFromVideo(this._streams.video,this._streams.audio,r),this.sorcerer[Sc].activeStreamIndex===r&&(r=!1));let s=!1;!1!==r&&(s=r>this.sorcerer[e].activeStreamIndex,this._switching[e]=!0,this.sorcerer[e].switchTo(r,!0,i).then(()=>{this._switching[e]=!1}).catch(console.error));let a=s;const o="auto"===this._preload&&!this._startedPlaying,c=this._brain.getSegmentsToLoad(a,e,this._getCurrentStream(),o),u=this.sorcerer[e].activeStreamIndex;for(let t=0;t<c.length;t++){const r=this._getSegmentUrl(u,c[t],e,!0),n=this._getCurrentlyLoadingStreamsForSegment(c[t],e);if(n.length>1)continue;if(1===n.length&&u<=n[0])continue;const i=this._isFinalSegment(u,c[t],e),s={stream:u,segment:c[t],type:e},a=this.sorcerer[e].streams[u];let o=r;this._useRangeRequests(u,e)&&(o={url:o,byteRange:this._getRangeForSegment(u,c[t],e)});const l=this._getSegmentPriority(u,c[t],e),h=e===Tc;let d=null;0===u&&e===Tc&&(d=16e3);let f=null;try{f=this._streams[e][u].segments[c[t]].size}catch(e){}a.addSegment(o,{identifier:s,isFinalSegment:i,priority:l,includeWithBandwidthChecks:h,timeout:d,size:f}).catch(e=>{})}}).catch(e=>{throw e}):Promise.resolve()}_loadPreloadSegments(){for(const e in this._streams){if(0===this._streams[e].length)continue;let t=0;const r=this._brain.getSegmentsToLoad(!1,e,this._getCurrentStream());r.length>0&&(t=r[0]);let n=this._preloadSegmentStreamIndex;e===Sc&&(n=this._brain.getAudioIndexFromVideo(this._streams.video,this._streams.audio,this._preloadSegmentStreamIndex));const i=this._key(n,t,e);if(this._waitingOnSet.has(i))continue;const s=this._getSegmentUrl(n,t,e),a=this._isFinalSegment(n,t,e),o=this.sorcerer[e].streams[n],c={stream:n,segment:t,type:e},u=!0;let l=s;this._useRangeRequests(n,e)&&(l={url:l,byteRange:this._getRangeForSegment(n,t,e)}),o.addSegment(l,{identifier:c,isFinalSegment:a,loadOnly:u,priority:0}).catch(e=>{})}}_loadSegments(){const e=this._video.webkitCurrentPlaybackTargetIsWireless,t="closed"===this.sorcerer.readyState;return e||t?Promise.resolve():this._onReady&&this._onReady.then(()=>{const e=[];for(const t in this._streams)this._streams[t].length>0&&e.push(this._loadSegmentsForType(t));return Promise.all(e)})}_handleQueued(e){this._waitingOnSet.add(this._key(e.stream,e.segment,e.type)),this._streamsForSegment[e.segment]||(this._streamsForSegment[e.segment]=[]),-1===this._streamsForSegment[e.segment].indexOf(e.stream)&&this._streamsForSegment[e.segment].push(e.stream)}_clearWaitingOn(e){(this._streamsForSegment[e.segment]||[]).forEach(t=>{this._waitingOnSet.delete(this._key(t,e.segment,e.type))})}_handleAborted(e){this._streamsForSegment[e.segment]&&this._clearWaitingOn(e)}_handleAppendBufferEnd(e){this.fire(Ui.APPEND_BUFFER_END,{identifier:e}),this.preloadStreamIndex=null,this._restartLoadSegmentsIntervalWithBackoff(),this._checkSwitchUp&&e.stream===this._lastStreamIndex&&(this._checkSwitchUp=!1,this._clearBufferAtTime=this._streams[Tc][e.stream].segments[e.segment].start),this._streamsForSegment[e.segment]&&this._clearWaitingOn(e);const t=this._brain.canPlayFromTimeInStream(this._timeToSeekTo,this._getCurrentStream());null!==this._timeToSeekTo&&this._resolveSeek&&t&&(this._resolveSeek(this._timeToSeekTo),this._resolveSeek=null),this._gapJumper&&this._gapJumper.onSegmentAppended()}_handleDownloadStart(e){this.fire(Ui.DOWNLOAD_START,{identifier:e})}_handleDownloadEnd(e,t){this.fire(Ui.DOWNLOAD_END,{identifier:e,data:t})}_handleDownloadError(e,t){this._clearWaitingOn(e);let r=Ui.DOWNLOAD_ERROR;410===t&&(r=Ui.MEDIA_URL_EXPIRED),502===t&&this.video.metadata.drm&&(r=Ui.DRM_FAILURE),this.fire(r,{identifier:e,status:t})}_handleDownloadTimeout(e,t){this.fire(Ui.DOWNLOAD_TIMEOUT,{identifier:e,data:t}),this._streamsForSegment[e.segment]&&this._clearWaitingOn(e),e.type===Tc?this._switching[Tc]=!1:e.type===Sc&&(this._switching[Sc]=!1)}_handleQuotaExceededError(e){this.fire(Ui.QUOTA_EXCEEDED_ERROR,{buffered:e})}_handleStreamChangeStart(e,t){const r={previousStreamIndex:this._manifest.video.indexOf(this._streams[Tc][e]),index:this._manifest.video.indexOf(this._streams[Tc][t]),streams:this._manifest.video};this.fire(Ui.STREAM_CHANGE_START,r)}_handleStreamChange(e,t){var r;if(null==(r=this._manifest)||!r.video)return;e>this._lastStreamIndex&&this.currentTime>0&&(this._checkSwitchUp=!0),this._lastStreamIndex=e;const n={index:this._manifest.video.indexOf(this._streams[Tc][e]),streams:this._manifest.video,metadata:t};this.fire(Ui.STREAM_CHANGE,n)}_initDrm(e=[],t=[],r={}){const n=this._telecineVideo.drmHandler;if(!n)return;const i=function(e,t){const r={audio:e.map(e=>`${e.mime_type};codecs="${e.codecs}"`),video:[]};for(let e=0;e<t.length;e++){const[n,i]=t[e].codecs.split(",");r.video[e]=`${t[e].mime_type};codecs="${n}"`,i&&r.audio.push(`audio/mp4;codecs="${i}"`)}return r}(t,e);n.init(this,i,r).catch(e=>(e===fs&&(this._drmSetupError=e,this.fire(Ui.NO_SUPPORTED_CDM)),Promise.reject(e))),n.setFallbackCallback(()=>{this.paused||(this._video.pause(),this.once(Ui.CURRENT_FILE_CHANGE,()=>{this.play()}))})}_setupCMCDLogger(){var e;(null!=(e=this._options.tests)&&null!=(e=e.cmcd)&&e.group||this._options.enableCMCD)&&(this.CMCDLogger=new tc(this,this._options.sessionMetadata))}_loadMediaManifest(){return import("./media-manifest.module.js")}}class Ac{constructor(e){this._scanner=e,this._currentTime=0,this._latencyInterval=setInterval(this._onLatencyInterval.bind(this),500)}get latency(){return this._latency}get liveSyncPosition(){const e=this._estimateLiveEdge(),t=this._scanner.presentationDelay,r=this._scanner.getCurrentStream();return null===e||null===t||null===r?0:e-t-this.edgeStalled}get edgeStalled(){const e=this._scanner.getCurrentStream();if(!e)return 0;const t=3*(this._scanner.lowLatencyMode&&e.partTargetDuration||e.targetDuration);return Math.max(e.age-t,0)}destroy(){clearInterval(this._latencyInterval)}_onLatencyInterval(){const e=this._scanner.videoElement,t=this._scanner.getCurrentStream();if(!e||!t)return;this._currentTime=e.currentTime;const r=this._computeLatency();null!==r&&(this._latency=r,this._scanner.fire(Fi.LATENCY_UPDATED,r),this._scanner.lowLatencyMode&&(ue.browser.ie||ue.browser.safari||null!==this._scanner.presentationDelay&&(e.playbackRate=1)))}_estimateLiveEdge(){const e=this._scanner.getCurrentStream();return e?e.edge+e.age:null}_computeLatency(){const e=this._estimateLiveEdge();return null===e||0===this._currentTime?null:e-this._currentTime}_getForwardBufferLength(){const e=this._scanner.videoElement,t=this._scanner.getCurrentStream();if(!e||!t)return 0;const r=e.buffered.length;return r?e.buffered.end(r-1):t.edge-this._currentTime}}const Ic=[1,2,5];class wc extends jo{get displayName(){return"Live"}constructor(e,t={}){super(e,t),this._UPSHIFT_BANDWIDTH_THRESHOLD=.4,this._DOWNSHIFT_BANDWIDTH_THRESHOLD=.6,this.consecutiveStreamIndex={},this.isNewPlayback=!0}optimalStream(e,t){var r,n;this.isNewPlayback&&((null==(n=this.scanner.sorcerer)?void 0:n.getResponseSpeeds().length)>=2&&(this.isNewPlayback=!1));if(1===e.length)return{index:0,reasonForSwitch:6};if(this.isNewPlayback){let t=0,r=0,n=this.scanner.videoElement.clientHeight,i=[];for(let s=0;s<e.length;s++){let a=e[s].height;i.push(a),a<n&&a>r&&(t=s,r=e[s].height)}return t=Math.max(0,t-1),{index:t,reasonForSwitch:4}}const i=this.getCurrentSpeed();let s=t,a=t;for(let t=0;t<e.length;t++)i*this._UPSHIFT_BANDWIDTH_THRESHOLD>e[t].bandwidth&&(s=t),i*this._DOWNSHIFT_BANDWIDTH_THRESHOLD>e[t].bandwidth&&(a=t);const o=t<s?s:a;this._clearConsecutiveStreamIndexes(o),this.consecutiveStreamIndex[o]++;const c=this.scanner.lowLatencyMode?.5:1.5,u=this.scanner.segmentLength*c,l=this.scanner.videoElement,h=l.buffered,d=null==(r=this._options.mediaSourceScanner)?void 0:r.droppedFrameSwitchPercent;return h&&0!==h.length?h.end(h.length-1)-l.currentTime<u?{index:0!==t?t-1:0,reasonForSwitch:1}:t>0&&!isNaN(d)&&this.hasTooManyDroppedFrames(t,this.scanner.getCurrentStream(),d)?(this.blacklist(t),this.scanner.fire(Ui.DROPPED_FRAME_PERCENT_EXCEEDED),{index:t-1,reasonForSwitch:2}):this.consecutiveStreamIndex[o]>2&&o!==t?{index:o,reasonForSwitch:3}:{index:t,reasonForSwitch:null}:{index:0,reasonForSwitch:5}}getCurrentSpeed(){var e;return null==(e=this.scanner.sorcerer)?void 0:e.getCurrentSpeed({type:"average",howMany:5,weights:Ic})}_clearConsecutiveStreamIndexes(e){this.consecutiveStreamIndex[e]||(this.consecutiveStreamIndex[e]=0);for(const t in this.consecutiveStreamIndex)this.consecutiveStreamIndex.hasOwnProperty(t)&&parseInt(t,10)!==e&&(this.consecutiveStreamIndex[t]=0)}getAvailabilityStart(e,t){return this._getSegmentAvailabilityStart(e,t.edge)}getAvailabilityEnd(e,t){return this._getSegmentAvailabilityEnd(e,t.edge)}canPlayFromTimeInStream(e,t){return!!t&&this.isTimeInBuffer(e,this.scanner._video.buffered,this.scanner._video.duration)}getSegmentsToLoad(e,t,r){var n,i,s;const{currentTime:a,liveTailTime:o,sorcerer:c,bufferTarget:u,atLiveEdge:l}=this.scanner,h=null==(n=c[t])||null==(n=n.sourceBuffer)?void 0:n.buffered,d=null!=h&&h.length?h.start(h.length-1):0,f=me(Math.max(a,d),h);if(!e&&f>=u)return[];const _=Math.max(a,o),v=l?r.edge:_,m=this._getSegmentAvailabilityStart(v,r.edge),g=this._getSegmentAvailabilityEnd(v,r.edge),E=this.scanner.lowLatencyMode&&(null==(i=r.parts)?void 0:i.length),T=[].concat(p(r.segments),p(null!==(s=r.parts)&&void 0!==s?s:[])),y=(E?r.parts:T).filter(t=>!!t.uri&&(e||!this.scanner.isSegmentAdded(t))&&!(t.end<m||t.start>g));return E&&y.forEach((e,t)=>{for(;e=e.dependentOn;)y.includes(e)||this.scanner.isStreamSegmentAdded(e)||y.splice(t,0,e)}),c[t].activeStreamIndex,y}_getSegmentAvailabilityStart(e,t){const r=t-this._getPresentationDelay();return Math.max(0,Math.min(e,r))}_getSegmentAvailabilityEnd(e,t){const r=e+this.scanner.bufferTarget;return Math.min(r,t)}_getPresentationDelay(){return this.scanner.presentationDelay||this.scanner.manifest.presentationDelay}}const Rc=["disabled","hidden","showing"],Pc=["subtitles","captions","descriptions","chapters","metadata"],Dc=["ar","fa","he","iw","ku","ps","sd","ur","yi"],Lc=new WeakMap,kc=new WeakMap;class TelecineTextTrack extends Ir{constructor({kind:e,src:t=null,label:r="",language:n="",id:i=Ae(),provenance:s=""},a){if(super(),-1===Pc.indexOf(e))throw ss(12,"SYNTAX_ERR","Syntax Error");Object.defineProperties(this,{kind:{value:e,enumerable:!0},label:{value:r,enumerable:!0},language:{value:n,enumerable:!0},id:{value:`${i}`,enumerable:!0},rtl:{value:-1!==Dc.indexOf(n.substr(0,2)),enumerable:!0},provenance:{value:s,enumerable:!0}}),this.video=a,this.src=t,this._modeHasBeenSet=!1,Lc.set(this,"disabled")}dispatchEvent(e){this.fire(e,{target:this})}get mode(){return Lc.get(this)}set mode(e){if(Rc.indexOf(e)>-1){if(this._modeHasBeenSet=!0,Lc.get(this)===e)return;Lc.set(this,e),this.video.currentScanner&&this.video.currentScanner.setModeForTrack(this,e),this.dispatchEvent("modechange")}}get src(){return kc.get(this)}set src(e){kc.set(this,e),this.video.fire(Ui.TEXT_SRC_UPDATE,this)}get cues(){return this.video.currentScanner?this.video.currentScanner.getCuesForTrack(this):[]}get activeCues(){return this.video.currentScanner?this.video.currentScanner.getActiveCuesForTrack(this):[]}get trackElement(){return document.getElementById(`telecine-track-${this.id}`)}}function Cc(e){var t=/^(?:(\d{2,}):)?(\d{2}):(\d{2})[,.](\d{3})$/.exec(e);if(!t)return-1;var r=parseInt(t[4],10)/1e3;return r+=parseInt(t[3],10),t[2]&&(r+=60*parseInt(t[2],10)),t[1]&&(r+=60*parseInt(t[1],10)*60),r}function Oc(e){var t=0,r=e.split(/(?:(?:\r\n|\n){2,})/),n=[],i=null;do{0===t&&/^\uFEFF?WEBVTT(?: .*)?/.test(r[t])&&t++,(i=/^(?:(.*)(?:\r\n|\n))?([\d:,.]+) --> ([\d:,.]+)(.*)?(?:\r\n|\n)([\s\S]*)/.exec(r[t]))&&n.push({startTime:Cc(i[2]),endTime:Cc(i[3]),text:i[5]}),t++}while(t<r.length);return n}function Nc(e,t,r){return r?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function Mc(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}function xc(e,t){return e&&e.then?e.then(t):t(e)}function Uc(e,t,r){if(r)return t?t(e()):e();try{var n=Promise.resolve(e());return t?n.then(t):n}catch(e){return Promise.reject(e)}}function Fc(){}function Vc(e,t){var r=e();return r&&r.then?r.then(t):t(r)}function jc(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}function Hc(e,t){if(!t)return e&&e.then?e.then(Fc):Promise.resolve()}const Bc=ue.browser.ie||ue.browser.edge?.5:.2,Xc=8e3;class Wc extends As{static get displayName(){return"HLSLiveScanner"}static get supportsMse(){return!0}static get supportsLive(){return!0}static supported(e){const t=B(e);return void 0!==t&&t.isTypeSupported}static get supportedVideoTypes(){return[b.hlsLive]}constructor(e,t={}){var r,n,i,s,a,o;super(e,t),this._playInitiated=!1,this._captionsVisible=!1,this._captionsLoading=!1,this._atLiveEdge=!0,this._atLiveTail=!1,this._STREAM_SWITCH_CHECK_INTERVAL=2e3,this._DOWN_SHIFT_CHECK_INTERVAL=1e4,this.reset(),this.defaultPresentationDelay=null!==(r=t.presentationDelay)&&void 0!==r?r:t.lowLatencyMode?3:12,this.defaultBufferTarget=t.lowLatencyMode?3:12,this.bufferTarget=this.defaultBufferTarget,this.presentationDelay=this.defaultPresentationDelay,this.lowLatencyMode=null!==(n=t.lowLatencyMode)&&void 0!==n&&n,this.disableDeltaUpdates=null!==(i=t.disableDeltaUpdates)&&void 0!==i&&i,this._preloadStreamIndex=null,Object.defineProperty(this,"eventIsLowLatency",{value:null!==(s=t.lowLatencyMode)&&void 0!==s&&s,writable:!1}),Object.defineProperty(this,"eventHasDVREnabled",{value:null!==(a=t.dvrEnabled)&&void 0!==a&&a,writable:!1}),this._timeoutTest=null==(o=this._options.tests)||null==(o=o.llhls_timeout)?void 0:o.group,window.addEventListener("online",()=>{this.play()})}deactivate(){super.deactivate(),this.reset()}reset(){var e,t,r;null==(e=this._sorcerer)||e.destroy(),null==(t=this._manifestLoader)||t.stop(),null==(r=this._latencyController)||r.destroy(),this._videoReady=ve(),this._sorcerer=null,this._streams={},this._streams.video=[],this._streams.audio=[],this._lastStreamIndex=0,this._isOnline=!1,this._hasLiveEventEnded=!1,this._timeSinceLastStreamSwitchCheck=0,this._timeSinceLastDownShift=Number.NEGATIVE_INFINITY,this._lastStallCurrentTime=-1,this._timeToSeekTo=null,this._resolveSeek=null,this._abr=new wc(this,this._options),this._latencyController=new Ac(this),this._restrictedStreamIndexes=[],this._preloadStreamIndex=null,this._switching={},this._segmentsAdded={},this._captionsAddedToTextTrack={},this._captionsAddedToTranscript={},this._fetchedCues={}}endLive(){var e;this._isOnline=!1,this._hasLiveEventEnded=!0,this.eventHasDVREnabled&&!this.atLiveEdge||(null==(e=this._manifestLoader)||e.stop(),this._sorcerer&&(this._sorcerer.abortFetches(),this._sorcerer.endOfStream()),this.eventHasDVREnabled||super.deactivate(),this.fire(Oi.ENDED))}_signalOnline(){this._isOnline||(this._isOnline=!0,this.fire(Fi.STREAM_ONLINE))}_signalOffline(){this._isOnline&&(this._isOnline=!1,this.fire(Fi.STREAM_OFFLINE))}_setConnection(e){e?this._signalOnline():this._signalOffline()}_loadManifest(e){const t=this;return Uc(function(){if(t._hasLiveEventEnded)return Nc();t._manifestLoader&&(t._manifestLoader.stop(),t._manifestLoader.off());let r=[t._loadMediaManifest()];return t.video.metadata.p2pReady&&r.push(t.video.metadata.p2pReady),Nc(Promise.allSettled(r),function([r]){const{M3U8Loader:n,PLAYLIST_UPDATE:i,PLAYLIST_ERROR:s,convertTsCodecs:a}=r.value;return t._manifestLoader=new n({disableDeltaUpdates:t.disableDeltaUpdates}),t._manifestLoader.lowLatencyMode=t.lowLatencyMode,t._manifestLoader.dvrEnabled=t.eventHasDVREnabled,t._manifestLoader.on(i,t._onPlaylistUpdate.bind(t)),t._manifestLoader.on(s,e=>{t._signalOffline()}),xc(Mc(function(){const r=t.video.metadata.playlistRefreshUrl;return Nc(t._manifestLoader.start(e,r),function(e){t._manifest=e,t._signalOnline()})},function(e){throw t._signalOffline(),t.endLive(),e}),function(e){t._streams.video=qc(function(e){return e.filter(t=>t.codecs.split(".")[0]===e[0].codecs.split(".")[0])}(function(e){const t=e.slice(0);return t.sort(function(e,t){const r=e.width*e.height*e.avg_bitrate,n=t.width*t.height*t.avg_bitrate;return e.width===t.width&&e.height===t.height?e.framerate-t.framerate:r-n}),t}(t._manifest.video))),t._streams.audio=qc(m(g(t._streams.video,({audio:e})=>e)));const{index:r,reasonForSwitch:n}=t._getStream("video",!0);let i={reasonForSwitch:n};return Nc(t._manifestLoader.switchTo("video",r),function(){let e,n=[];if(t._streams.audio.length){let{index:r}=t._getStream("audio",!0);e=r,n.push(t._manifestLoader.switchTo("audio",e))}if(t.manifest.captions&&t.manifest.captions.length>0){const{index:e}=t._getStream("subtitles",!0);n.push(t._manifestLoader.switchTo("subtitles",e))}return Nc(Promise.all(n),function(){var n,s;null==(n=t._sorcerer)||n.destroy(),t._sorcerer=new Uo(t._video,{fetcherRetryAbortErrors:!1,fetcherTimeout:Xc,disableMMS:t._options.disableMMS}),t._sorcerer.initFrameDropper(),t._streams.video.forEach(e=>{t._sorcerer.addStream(a(Qi(t._manifestLoader.activeStream("video").mimeType,e.codecs)),e.initSegment)}),t._streams.audio.forEach(e=>{t._sorcerer.addStream(a(Qi(t._manifestLoader.activeStream("audio").mimeType,e.codecs)),e.initSegment)}),t.fire(Ui.STREAMS_LOADED,t._streams),t.manifest.captions&&t.manifest.captions.length>0&&(t.manifest.captions.forEach(t._loadTextTrack.bind(t)),t.fire(Ui.TEXT_TRACKS_AVAILABLE)),t._setUpMediaSorcererEvents(),t._sorcerer.video.switchTo(r,!1,i),t._streams.audio.length&&(null==(s=t._sorcerer.audio)||s.switchTo(e,!1))})})})})})}_refreshManifest(){const e=this;return Uc(function(){return Nc(function(e){if(e&&e.then)return e.then(Fc)}(Mc(function(){return Nc(e._manifestLoader.update(),function(){e._signalOnline()})},function(){e._signalOffline()})))})}_setUpMediaSorcererEvents(){this._sorcerer.video.on("streamchange",this._handleStreamChange.bind(this)),this._sorcerer.video.on("streamchangestart",this._handleStreamChangeStart.bind(this)),this._sorcerer.on("downloadend",this._handleDownloadEnd.bind(this)),this._sorcerer.on("downloadtimeout",this._handleDownloadTimeout.bind(this)),this._sorcerer.on("downloadabort",this._handleDownloadAbort.bind(this)),this._sorcerer.on("appendbufferend",this._handleBufferAppend.bind(this))}_handleDownloadEnd(e,t){if(e&&e.isInitSegmentRequest)return;const r=this._getCurrentStream();t.extraContext={liveAvail:{start:this._abr.getAvailabilityStart(this.currentTime,r),end:this._abr.getAvailabilityEnd(this.currentTime,r)}},this.fire(Ui.DOWNLOAD_END,{identifier:e,data:t})}_handleDownloadTimeout(e,t){e&&e.isInitSegmentRequest||(this._key(e),this._clearSegment(e),this._switching[e.type]=!1,this.fire(Ui.DOWNLOAD_TIMEOUT,{identifier:e,data:t}))}_handleDownloadAbort(e){e&&e.isInitSegmentRequest||(this._key(e),this._clearSegment(e))}_handleStreamChangeStart(e,t){const r={previousStreamIndex:this._streams.video.indexOf(this._streams.video[e]),index:this._streams.video.indexOf(this._streams.video[t]),streams:this._streams.video};this.fire(Ui.STREAM_CHANGE_START,r)}_handleStreamChange(e,t={}){this.fire(Ui.STREAM_CHANGE,{index:e,streams:this._streams.video,metadata:t})}_firstBufferAheadIndex(e,t){for(let r=0;r<(null==t?void 0:t.length);r++)if(t.start(r)>e)return r}_handleBufferAppend(e){var t;const{type:r,stream:n}=e,i=this.sorcerer[r].sourceBuffer.buffered,s=this._getSegmentById(e);if(s&&i.length&&(this._streams[r][n].playlist.timeOffset=i.end(i.length-1)-(s.end-s.timeOffset)),null===this._timeToSeekTo||!this._resolveSeek)return;const a=this._firstBufferAheadIndex(this.currentTime,i),o=null!==(t=null==i?void 0:i.start(a))&&void 0!==t?t:0,c=me(o,i);if(void 0!==a&&c>this.bufferTarget)return Number((o-this.currentTime).toFixed(3)),void(this.currentTime=o);this._timeToSeekTo<this.liveTailTime&&(this._timeToSeekTo=this.liveTailTime),this._abr.canPlayFromTimeInStream(this._timeToSeekTo,this._getCurrentStream())&&(this._resolveSeek(this._timeToSeekTo),this._resolveSeek=null)}_key({type:e,segment:t,part:r}){return`${e}_${t}_${r}`}_getSegmentById({type:e,stream:t,segment:r,part:n}){const i=this._streams[e][t].getSegmentBySN(r);return(null==i?void 0:i.getPart(n))||i}_clearSegment(e){if(e.part>0){const t=f(f({},e),{},{part:e.part-1});this._clearSegment(t)}const t=this._key(e);delete this._segmentsAdded[t]}isSegmentAdded(e){return!!this._segmentsAdded[this._key(e)]}isStreamSegmentAdded(e){const t=this._key(e),r=this._sorcerer[e.type].activeStreamIndex;return!!this._segmentsAdded[t]&&this._segmentsAdded[t].stream===r}_onPlaylistUpdate(e,t){const r=this;return Uc(function(){const{type:n}=e;var i,s;if(r.eventHasDVREnabled&&(null==(i=r._sorcerer)||i.setLiveSeekableRange(r.liveTailTime,r.liveEdgeTime)),r.fire(Ui.STREAM_UPDATED,e),"subtitles"===n)return(r._captionsVisible||r._captionsLoading)&&(null==(s=r.manifest.captions)?void 0:s.length)>0&&r._addTextTrackCue(),Nc();t||r._loadSegmentsForType(n);const a=r._hasNewSegments(n)||!r._atDurationEnd();return r._setConnection(a),r._checkForPlaybackGap(),(r.lowLatencyMode||r.video.metadata.p2pReady)&&r._checkForPlaybackStall(),Nc()})}_loadTextTrack({label:e,language:t},r){if(!this._captionsTrack){const n=new TelecineTextTrack({label:e,id:r,kind:"captions",language:t},this._telecineVideo);this._telecineVideo.textTracks=Yi([n]),this._captionsTrack=this.addTextTrack(n)}}_getSegmentIdentifier(e){return`${e.type}_${e.mediaSequenceNumber}`}_getVideoTimeOffset(){return this._getCurrentStream("video").playlist.timeOffset}_shouldAddSegmentCuesToTextTrack(e){const t=this._getSegmentIdentifier(e),r=this._captionsAddedToTextTrack[t],n=this._getVideoTimeOffset(),i=e.end+n>=this.currentTime&&e.start+n<=this.currentTime+this.bufferTarget;return this._captionsVisible&&!r&&i}_shouldAddSegmentCuesToTranscript(e){const t=this._getSegmentIdentifier(e),r=this._captionsAddedToTranscript[t],n=this._getVideoTimeOffset(),i=e.end+n>=this.liveEdgeTime-e.duration&&e.start+n<=this.liveEdgeTime+this.bufferTarget;return this._captionsLoading&&!r&&i}_getSegmentCues(e){const t=this;return Uc(function(){const r=t._getSegmentIdentifier(e);return Nc(Vc(function(){if(!t._fetchedCues[r])return Nc(Ye(e.url).text(),function(e){const n=Oc(e),i=function(e){const t=e.match(/=MPEGTS:(\d+),/);return(t&&t[1]||0)/9e4}(e),s=n.map(e=>(e.startTime=i+e.startTime,e.endTime=i+e.endTime,new(window.VTTCue||window.TextTrackCue)(e.startTime,e.endTime,e.text)));t._fetchedCues[r]=s})},function(){return t._fetchedCues[r]}))})}_addTextTrackCue(){const e=this;return Uc(function(){return Nc(e._videoReady,function(){e.manifest.captions&&e.manifest.captions[0].segments.forEach(jc(function(t){const r=e._getSegmentIdentifier(t),n=e._shouldAddSegmentCuesToTextTrack(t),i=e._shouldAddSegmentCuesToTranscript(t);return function(){var s=function(){if(n||i)return Nc(e._getSegmentCues(t),function(t){n&&(e._captionsAddedToTextTrack[r]=!0,t.forEach(t=>{e._captionsTrack.addCue(t)})),i&&(e._captionsAddedToTranscript[r]=!0,e.fire(Ui.SEGMENT_CUES_LOADED,t))})}();if(s&&s.then)return s.then(Fc)}()}))})})}_hasNewSegments(e){var t;const r=this._getCurrentStream(e),n=3*(this.lowLatencyMode?3:1);return(null==(t=r.playlist)?void 0:t.misses)<n}_loadSegments(){const e=this;return Uc(function(){return Nc(e._videoReady,function(){const t=e._video.webkitCurrentPlaybackTargetIsWireless,r="closed"===e._sorcerer.readyState;if(!t&&!r)for(const t in e._streams)e._streams[t].length>0&&e._loadSegmentsForType(t)})})}_loadSegmentsForType(e){const t=this;return Uc(function(){return Nc(t._videoReady,function(){if(!t._sorcerer.allowSegmentRequests)return;const{index:r,reasonForSwitch:n}=t._getStream(e);let i;return Vc(function(){if(r>=0&&r!==t.sorcerer[e].activeStreamIndex)return i=r>t.sorcerer[e].activeStreamIndex,t._switching[e]=!0,Nc(t._manifestLoader.switchTo(e,r),function(){let i={reasonForSwitch:n};t.sorcerer[e].switchTo(r,!0,i).then(()=>{t._switching[e]=!1}).catch(console.error)})},function(){return Nc(A(0),function(){const r=t.lowLatencyMode&&void 0!==i,n=t._sorcerer[e].activeStreamIndex,s=t._getCurrentStream(e,n),a=t._abr.getSegmentsToLoad(r,e,s),o=t._getSegmentTimeoutMs();a.forEach(r=>{const i=t._key(r),a={type:e,stream:n,segment:r.segment,part:r.part},c="video"===e&&!r.hint;let u=o;if(r.hint&&t._playInitiated&&r.start>t.currentTime){const e=1e3*(r.start-t.currentTime);u=Math.min(Xc,e+o)}const l=s.avg_bitrate/8*r.duration,h=t.sorcerer[e].streams[n],d=t._preventExpiredSegmentUsage(r);h.addSegment(d,{identifier:a,includeWithBandwidthChecks:c,priority:r.programDateTime,excludeConnectTime:t.lowLatencyMode,timeout:t._timeoutTest||t.lowLatencyMode?u:Xc,size:t._timeoutTest||t.lowLatencyMode?l:void 0}).catch(e=>{e instanceof Rs||e instanceof we||t._clearSegment(a)}),t._segmentsAdded[i]=a})})})})})}_preventExpiredSegmentUsage(e){var t;let r=null==e?void 0:e.url;const n=null==(t=this._manifestLoader)?void 0:t.baseUrl;return n&&r&&!r.startsWith(n)&&(r=`${n}${e.uri}`),r}_getStream(e,t=!1){var r;let n;if(this._switching[e])return{index:-1,reasonForSwitch:null};if("subtitles"===e)return n=this._manifestLoader.activeStream("video"),{index:n.subtitles[n.currentRenditions.subtitles].index,reasonForSwitch:null};if("audio"===e)return n=this._manifestLoader.activeStream("video"),{index:n.audio[n.currentRenditions.audio].index,reasonForSwitch:null};if(!t&&Se(this._timeSinceLastStreamSwitchCheck)<this._STREAM_SWITCH_CHECK_INTERVAL)return{index:this._lastStreamIndex,reasonForSwitch:null};this._timeSinceLastStreamSwitchCheck=Ee();const i=null==(r=this.video)||null==(r=r.metadata)?void 0:r.percentShown,s=this._abr.filterStreams(this._streams.video,this._video.clientWidth,this._video.clientHeight,i);if(0===s.length)return{index:this._lastStreamIndex,reasonForSwitch:null};const{index:a,reasonForSwitch:o}=this._abr.optimalStream(s,this._lastStreamIndex),c=s[a],u=this._streams.video.indexOf(c);if(u>=0&&(t||u!==this._lastStreamIndex)){if(u>this._lastStreamIndex&&Se(this._timeSinceLastDownShift)<this._DOWN_SHIFT_CHECK_INTERVAL)return{index:this._lastStreamIndex,reasonForSwitch:o};u<this._lastStreamIndex&&(this._timeSinceLastDownShift=Ee());const e={index:u,streams:this._streams.video};return this.fire(Ui.STREAM_TARGET_CHANGE,e),this._lastStreamIndex=u,{index:u,reasonForSwitch:o}}return{index:this._lastStreamIndex,reasonForSwitch:o}}getCurrentStream(e="video"){return this._getCurrentStream(e)}_getCurrentStream(e="video",t=0){return void 0!==this._sorcerer&&null!==this._sorcerer&&(t=this._sorcerer[e].activeStreamIndex),this._streams[e][t]}_checkForPlaybackStall(){if(this._video.currentTime===this._lastStallCurrentTime&&Ee()-this._lastStallCheckTime>=1e3&&this._shouldBeMakingProgress()){const e=`Jumping forward 0.1s because of stall at time of ${this._video.currentTime}`;this.fire(Fi.STALL_JUMP,{msg:e}),this._video.currentTime+=.1}this._lastStallCurrentTime=this._video.currentTime,this._lastStallCheckTime=Ee()}_shouldBeMakingProgress(){return this._video.readyState!==this._video.HAVE_NOTHING&&!!this._video.buffered.length&&!this._video.paused&&this._hasContentFor(this._video.buffered,this._video.currentTime)}_hasContentFor(e,t){for(let r=0;r<e.length;r++)if(!(t<e.start(r)-.1||t>e.end(r)-.5))return!0;return!1}_checkForPlaybackGap(){const e=this.buffered;if(!e.length)return;const t=e.length,r=this._video.currentTime;let n,i,s,a;try{n=function(e,t){if(!e||!e.length)return null;if(1===e.length&&e.end(0)-e.start(0)<1e-6)return null;let r;for(let n=0;n<e.length;n++)if(e.start(n)>t&&(0===n||e.end(n-1)-t<=.5)){r=n;break}return r>=0?r:null}(e,r)}catch(e){throw DOMException,e}if(null===n)return;if(this._video.readyState===this._video.HAVE_NOTHING)return;if(this._video.paused)return;if(t<=n)return;try{i=e.start(n),s=e.end(t-1)}catch(e){throw DOMException,e}const o=i-r,c=s-i,u=this.lowLatencyMode?1:2;if(c>0&&c<=this.segmentLength*u)return a=`Preventing jump too close to buffered end time. Would have jumped to: ${i}. Last buffered end time ${s}.`,void this.fire(Fi.BUFFER_GAP_JUMP_PREVENT,{msg:a});0===n?(a=`Jumping forward ${o} seconds because of gap before start time of ${i}`,this.fire(Fi.BUFFER_GAP_JUMP,{msg:a})):(a=`Jumping forward ${o} seconds because of gap starting at ${e.end(n-1)} and ending at ${i}`,this.fire(Fi.BUFFER_GAP_JUMP,{msg:a})),this._video.currentTime=i+.1}_atDurationEnd(){const e=this.buffered;return!!(e&&e.length&&this._video.currentTime+Bc>e.end(e.length-1))}setVideoSrc(e){const t=this;return Uc(function(){return Nc(t._startPreload(t._preload),function(){return Nc(t._loadManifest(e),function(){return Vc(function(){if(t.sorcerer.isInstanceofManagedMediaSource(t.sorcerer.mediaSource)){const e=document.createElement("source");e.type="video/mp4",e.src=URL.createObjectURL(t.sorcerer.mediaSource),t._video.appendChild(e);let{src:r,mime:n}=t._telecineVideo.externalDisplayFiles.AirPlay;const i=document.createElement("source");return i.type=n,Nc(O(r),function(e){i.src=e,t._video.appendChild(i)})}t._video.src=URL.createObjectURL(t.sorcerer.mediaSource)},function(){t._videoReady.resolve()})})})})}get preload(){return this._preload}set preload(e){this._preload!==e&&"none"!==e&&this._preloadReady.resolve(),this._preload=e}_startPreload(e){const t=this;return Uc(function(){return t._preloadReady=ve(),"none"===e&&t.paused||t._preloadReady.resolve(),Nc(t._preloadReady)})}get latency(){var e;return null==(e=this._latencyController)?void 0:e.latency}get lowLatencyMode(){return this._lowLatencyMode}set lowLatencyMode(e){this._lowLatencyMode=e,this._manifestLoader&&(this._manifestLoader.lowLatencyMode=e)}get downloadSpeed(){return this._abr.getCurrentSpeed()}getBitrateAtTime(e,t="video",r="average"){if(!this._sorcerer)return 0;const n=this._sorcerer.streamIndexAtTime(e,t),i=this._streams[t][n];var s;return i?null!==(s=i["average"===r?"avg_bitrate":"bitrate"])&&void 0!==s?s:i.bitrate:0}onprogress(){this._checkForPlaybackGap()}ondurationchange(){this._checkForPlaybackGap()}ontimeupdate(){if(!this._sorcerer)return;if(super.ontimeupdate(),null!==this._timeToSeekTo)return;this.atLiveTail=this._isNearLiveTail(this._video.currentTime),this._shouldSnapToLiveEdge(this._video.currentTime)?this.atLiveEdge=!0:(this._video.playbackRate<1||this._hasDriftedBehindLiveEdge())&&(this.atLiveEdge=!1),this.fire(Ui.DROPPED_FRAMES,this._sorcerer.getDroppedFrameTotal());const e=this._getCurrentStream();if(e){const t={speed:this._abr.getCurrentSpeed(),bitrate:e.avg_bitrate,speeds:this._sorcerer.getResponseSpeeds()};this.fire(Ui.BANDWIDTH,t)}!this._isOnline&&this._atDurationEnd()&&this.fire(Fi.STREAM_OFFLINE),!this.lowLatencyMode&&Se(this._timeSinceLastStreamSwitchCheck)>this._STREAM_SWITCH_CHECK_INTERVAL&&this._loadSegments()}get restrictedStreamIndexes(){return this._restrictedStreamIndexes}set restrictedStreamIndexes(e){this._restrictedStreamIndexes.join(",")!==e.join(",")&&(this._restrictedStreamIndexes=e,this._abr.lock(this._restrictedStreamIndexes))}get preloadStreamIndex(){return this._preloadStreamIndex}set preloadStreamIndex(e){this._preloadStreamIndex=e;const t=null!==e?[this._preloadStreamIndex]:this._restrictedStreamIndexes;this._abr.lock(t)}get videoWidth(){return this._stream?this._stream.width:this._video.videoWidth}get videoHeight(){return this._stream?this._stream.height:this._video.videoHeight}get currentTime(){return null!==this._timeToSeekTo?this._timeToSeekTo:this._video.currentTime}set currentTime(e){this._video.readyState<=this._video.HAVE_NOTHING||(this.eventHasDVREnabled&&this._playInitiated?this._shouldSnapToLiveEdge(e)?(this.atLiveEdge=!0,this.seekToTime(this.liveEdgeTime)):(this.atLiveEdge=!1,this.seekToTime(Math.max(e,this.liveTailTime))):this._video.currentTime=e)}get liveEdgeTime(){return this._latencyController.liveSyncPosition}get atLiveEdge(){return this._atLiveEdge}set atLiveEdge(e){this.atLiveEdge!==e&&this.eventHasDVREnabled&&(this._atLiveEdge=e,this._video.playbackRate>1&&e&&(this._video.playbackRate=1),this.lowLatencyMode=!!this.eventIsLowLatency&&e,this.bufferTarget=e?this.defaultBufferTarget:18,e&&(this.presentationDelay=this.defaultPresentationDelay))}get atLiveTail(){return this._atLiveTail}set atLiveTail(e){this.atLiveTail!==e&&this.eventHasDVREnabled&&(this._atLiveTail=e,this._video.playbackRate<1&&e&&(this._video.playbackRate=1))}get liveTailTime(){var e,t;const r=null!==(e=null==(t=this._getCurrentStream())||null==(t=t.segments)||null==(t=t[0])?void 0:t.start)&&void 0!==e?e:0;return Math.max(r,0)}get ended(){return this._hasLiveEventEnded}get isLowerProfileAvailable(){return this._sorcerer?this._sorcerer.video.activeStreamIndex>0:null}get sorcerer(){return this._sorcerer}get segmentLength(){var e,t;return this.lowLatencyMode&&(null==(e=this._manifestLoader)||null==(e=e.activeStream("video"))?void 0:e.partTargetDuration)||(null==(t=this._manifestLoader)||null==(t=t.activeStream("video"))?void 0:t.targetDuration)}_shouldSnapToLiveEdge(e){return e>=this.liveEdgeTime-1*this.segmentLength}_hasDriftedBehindLiveEdge(e){return e>=this.liveEdgeTime-2*this.segmentLength}_isNearLiveTail(e){return e<=this.liveTailTime+2*this.segmentLength}_getSeekReadyPromiseForTime(e=this._timeToSeekTo){return new Promise(t=>{this._abr.canPlayFromTimeInStream(e,this._getCurrentStream())?t(e):this._resolveSeek=t}).then(e=>(this._timeToSeekTo=null,this._seekInProgressPromise=null,this._video.currentTime=e,new Promise((e,t)=>{this._lastSeekReject=t;const r=()=>{e(this._video.currentTime),this._video.removeEventListener("seeked",r)};this._video.addEventListener("seeked",r)})))}seekToTime(e){if(!this.eventHasDVREnabled||e===this.currentTime)return Promise.resolve();let t;if(null===this._timeToSeekTo||(this._lastSeekReject&&(this._lastSeekReject(),this._lastSeekReject=null),this._seekInProgressPromise=null,this._timeToSeekTo=null,this._resolveSeek=null),this._timeToSeekTo=e,!this._abr.canPlayFromTimeInStream(e,this._getCurrentStream()))try{this._segmentsAdded={};for(const e in this._streams)if(this._streams[e].length>0){const t=this.sorcerer[e].activeStreamIndex;this.sorcerer[e].streams[t].abort()}t=this._sorcerer.removeBuffer()}catch(e){}return this._seekInProgressPromise=this._getSeekReadyPromiseForTime(e),Promise.all([this._videoReady,t]).then(()=>(this._loadSegments(),this._seekInProgressPromise)).catch(e=>{})}onpause(){var e;super.onpause(),this.eventHasDVREnabled?this.atLiveEdge=!1:(null==(e=this._manifestLoader)||e.stop(),this._sorcerer&&(this._sorcerer.abortFetches(),this._segmentsAdded={},this._sorcerer.removeBuffer().catch(()=>{})))}onplay(){this.eventHasDVREnabled||this._playInitiated&&this._refreshManifest()}pause(){this.eventHasDVREnabled&&(this.atLiveEdge=!1),super.pause()}play(){const e=this;return super.play(jc(function(){return e._preloadReady.resolve(),null!==e._timeToSeekTo?Promise.resolve(e._seekInProgressPromise):Vc(function(){if(e._playInitiated&&!e.eventHasDVREnabled)return e._segmentsAdded={},xc(Mc(function(){return Hc(e._sorcerer.removeBuffer())},function(e){}),function(){return Hc(e._refreshManifest())})},function(){return Nc(e._videoReady,function(){return e._loadSegments(),Nc(e._bufferAvailable(),function(){const t=Math.max(e._latencyController.liveSyncPosition,e._video.buffered.start(0));return e._atLiveEdge?e.currentTime=t:e.currentTime=e._video.currentTime,e._playInitiated=!0,Promise.resolve()})})})}))}_bufferAvailable(){return new Promise(e=>{const t=()=>{this.buffered.length&&(this._sorcerer.off("appendbufferend",t),this.preloadStreamIndex=null,e())};this._sorcerer.on("appendbufferend",t),t()})}_getSegmentTimeoutMs(){return this._abr.getSegmentRelativeTimeout(this._streams.video,this._getCurrentStream("video"),1e3*this.segmentLength)}_loadMediaManifest(){return import("./media-manifest.module.js")}setCaptionsShouldDisplay(e){this._captionsVisible=e}setCaptionsShouldLoad(e){this._captionsLoading=e}}function qc(e){return e.forEach((e,t)=>{e.index=t}),e}function Gc(e,t){return e.bitrate-t.bitrate}const Kc=(e,t)=>({audio:e.map((t,r)=>{var n;return f(f({},t),{},{avg_bitrate:t.bitrate,codec:t.audioCodec,codecs:t.audioCodec,id:t.attrs.URI,index:e.length-r,isDefault:t.default,label:t.name,language:t.attrs.LANGUAGE,segments:[],type:null!==(n=t.attrs.TYPE)&&void 0!==n?n:"audio",uri:t.attrs.URI})}).sort(Gc),video:t.map((e,r)=>f(f({},e),{},{avg_bitrate:e.bitrate,bitrate:e.bitrate,codec:e.videoCodec,codecs:e.videoCodec,framerate:parseInt(e.attrs["FRAME-RATE"]),height:e.height,id:r,index:t.length-r,label:e.name||`${e.height}p`,segments:[],width:e.width})).sort(Gc)});function Yc(e){const t={};for(var r,n=u(e.split("\r\n").map(e=>null==e?void 0:e.trim()).filter(Boolean));!(r=n()).done;){const e=r.value,[n,i]=e.split(": ");t[n]=i}return t}function $c(e){var t,r;return null!=(t=e.characteristics)&&t.includes("public.machine-generated")?"PROVENANCE_AI_GENERATED":null!=(r=e.characteristics)&&r.includes("com.vimeo.provenance.user-uploaded-machine-generated")?"PROVENANCE_USER_UPLOADED_AI_GENERATED":"PROVENANCE_USER_UPLOADED"}function zc(e){var t,r;let n="translation";return e.default?n="main":null!=(t=e.characteristics)&&t.includes("public.accessibility.describes-video")?n="descriptions":null!=(r=e.characteristics)&&r.includes("public.auxiliary-content")&&(n="commentary"),n}function Qc(e,t,r){return r?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function Jc(){const e=function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}(function(){return function(e,n){try{var i=function(){if(r)return Qc(Ye(r).json(),function(e){return Qc(O(e.url.hls),function(e){t=function(e){return e.split("/").slice(0,-2).join("/")}(e)})})}()}catch(e){return}return i&&i.then?i.then(void 0,n):i}(0,function(e){})});let t=null,r=null;return{setPlaylistRefreshUrl(e){r=e},createCustomLoader:({baseLoader:r})=>function({baseLoader:r}){return class extends r{load(r,n,i){var s;const a=function(e,t){return!!e&&e-t<Date.now()}(N(null!==(s=t)&&void 0!==s?s:r.url),12e4),o="type"in r&&"level"===r.type;a&&o&&e(),r.url=function(e,t){if(!t)return e;const r=e.split("/"),n=t.split("/");return t+"/"+r.slice(n.length).join("/")}(r.url,t),super.load(r,n,i)}}}({baseLoader:r})}}function Zc(e,t){return Array.from(e).indexOf(t)}function eu(e,t,r){return r?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function tu(e,t,r){if(r)return t?t(e()):e();try{var n=Promise.resolve(e());return t?n.then(t):n}catch(e){return Promise.reject(e)}}function ru(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}function nu(){}function iu(e){if(e&&e.then)return e.then(nu)}class su extends Ir{static get displayName(){return"HlsJsScanner"}static get supportsMse(){return!0}static get supportsLive(){return!0}static get hlsJsVersion(){var e;return null==(e=window.Hls)?void 0:e.version}static supported(e){var t;return null==(t=window.Hls)?void 0:t.isSupported()}static get supportedVideoTypes(){return[b.hlsLive]}static get supportsAudioTracksFromScanner(){return!0}constructor(e,t){var r;super(),l(this,"_airPlayAvailable",void 0),l(this,"_airPlayVideoElement",void 0),l(this,"_brain",void 0),l(this,"_captionsLoading",void 0),l(this,"_captionsTrack",void 0),l(this,"_captionsVisible",void 0),l(this,"_currentFile",void 0),l(this,"_customLoader",void 0),l(this,"_debugMode",void 0),l(this,"_enableMultiAudioLive",void 0),l(this,"_eventHandlers",void 0),l(this,"_eventStartTimeOffset",void 0),l(this,"_externalDisplayActivated",void 0),l(this,"_files",void 0),l(this,"_hls",void 0),l(this,"_hlsConfig",void 0),l(this,"_hlsEventHandlers",void 0),l(this,"_listenerAirPlay",void 0),l(this,"_listenerCaptionsCue",void 0),l(this,"_listenerWebKitFullscreenEnter",void 0),l(this,"_listenerWebKitFullscreenExit",void 0),l(this,"_options",void 0),l(this,"_originalVideo",void 0),l(this,"_playerInViewTracker",void 0),l(this,"_pollingTimeoutId",void 0),l(this,"_preload",void 0),l(this,"_streamOnline",void 0),l(this,"_streams",void 0),l(this,"_telecineVideo",void 0),l(this,"_totalFrames",void 0),l(this,"_video",void 0),l(this,"_videoWrapper",void 0),l(this,"_AirPlayListenerAvailability",void 0),l(this,"_AirPlayListenerLoadedMetadata",void 0),l(this,"_AirPlayListenerTarget",void 0),l(this,"hlsJsError",(e,t)=>{this.fire(Ui.HLS_JS_ERROR,t),t.fatal&&this._handleFatalError(t.type)}),l(this,"handleManifestLoaded",(e,t)=>{this._streams=Kc(t.audioTracks,t.levels),this.fire(Ui.STREAMS_LOADED,this._streams),this._streamOnline=!0,this.fire(Fi.STREAM_ONLINE),this._loadAirPlayMetadata().catch(e=>{})}),l(this,"handleLevelLoaded",(e,t)=>{let r="";-1===this._hls.currentLevel&&this._onStreamChange(t),0===this._eventStartTimeOffset&&this._setEventStartTimeOffset();const n=this._options.lowLatencyMode?9:3,i=t.details.misses<n;(!t.details.live||this._streamOnline&&!i)&&(this._streamOnline=!1,this.fire(Fi.STREAM_OFFLINE)),!this._streamOnline&&i&&(this._streamOnline=!0,this.fire(Fi.STREAM_ONLINE))}),l(this,"handleLevelSwitched",(e,t)=>{this._onStreamChange(t)}),l(this,"_onStreamChange",e=>{const t=this._streams.video.findIndex(t=>t.bitrate===this._hls.levels[e.level].bitrate);this.fire(Ui.STREAM_CHANGE,{index:t,streams:this._streams.video,metadata:null})}),l(this,"handleFPSDrop",(e,{currentDropped:t,currentDecoded:r,totalDroppedFrames:n})=>{this._totalFrames=this._totalFrames+t+r,this.fire(Ui.DROPPED_FRAMES,{dropped:n,total:this._totalFrames})}),l(this,"handleNonNativeTextTracksFound",(e,t)=>{t.tracks.forEach((e,t)=>{var r;return this.loadTextTrack(e.label,null==(r=e.subtitleTrack)?void 0:r.lang,t)}),this.fire(Ui.TEXT_TRACKS_AVAILABLE)}),l(this,"handleCuesParsed",(e,t)=>{t.cues&&(this._video.textTracks.length>0&&t.cues.forEach(e=>{this._video.textTracks[0].cues.getCueById(e.id)||this._video.textTracks[0].addCue(e)}),(this._captionsVisible||this._captionsLoading)&&this.fire(Ui.SEGMENT_CUES_LOADED,t.cues))}),l(this,"handleFragmentLoaded",(e,t)=>{var r;const{frag:n}=t;if(!n)return;const i=this.getCurrentStream("video");var s;i&&this.fire(Ui.BANDWIDTH,{speed:(null==(s=this._hls)?void 0:s.bandwidthEstimate)||0,bitrate:i.avg_bitrate||0});const a=null==(r=t.networkDetails)||null==r.getAllResponseHeaders?void 0:r.getAllResponseHeaders();this.fire(Ui.DOWNLOAD_END,(({frag:e,liveEdge:t,liveTail:r,headers:n})=>{var i,s;return{identifier:{type:"main"===e.type?"video":e.type,stream:e.level,segment:e.sn},data:{request:{data:{url:e.url,duration:(null==(i=e.stats)?void 0:i.loading.end)-(null==(s=e.stats)?void 0:s.loading.start)}},response:{headers:n?Yc(n):{},arrayBuffer:()=>({byteLength:e.byteLength})},extraContext:{liveAvail:{start:r,end:t}}}}})({frag:n,liveEdge:this.liveEdgeTime,liveTail:this.liveTailTime,headers:a}))}),l(this,"handleAudioTracksUpdated",(e,t)=>{this.fire(Ui.AUDIO_TRACK_CHANGED)}),l(this,"handleBufferAppended",(e,t)=>{var r;const n="initSegment"===(null==t||null==(r=t.frag)?void 0:r.sn);"video"!==t.type||n||null===this.preloadStreamIndex||(this.preloadStreamIndex=null)}),this._videoWrapper=e,this._options=t,this._video=e.querySelector("video"),this._airPlayAvailable=!1,this._airPlayVideoElement=null,this._captionsLoading=!1,this._captionsTrack=null,this._captionsVisible=!1,this._currentFile=null,this._customLoader=null,this._debugMode=null!==(r=this._options.hlsJsDebugMode)&&void 0!==r?r:null,this._enableMultiAudioLive=this._options.enableMultiAudioLive,this._eventHandlers={},this._eventStartTimeOffset=0,this._externalDisplayActivated=!1,this._files=[],this._hls=null,this._hlsEventHandlers={},this._listenerAirPlay=null,this._listenerCaptionsCue=null,this._listenerWebKitFullscreenEnter=null,this._listenerWebKitFullscreenExit=null,this._originalVideo=this._video,this._playerInViewTracker=null,this._streamOnline=!1,this._telecineVideo=null,this._totalFrames=0,this._streams={video:[],audio:[]},this._video||(this._video=document.createElement("video"),this._video.preload="none",this._videoWrapper.appendChild(this._video)),this._updatePlayRequestVideo(),this.reactivate()}deactivate(){this._detachEventProxies(this._video),this._detachHlsJsEvents(),this._cleanUpAirPlay(),this._detachAirPlayEvents(),this._cleanUpInViewTracking(),this._hls&&(this._hls.destroy(),this._hls=null)}reactivate(){this._initHlsJs(),this._initVideoEventHandlers(),this._attachEventProxies(this._video),this._attachHlsJsEvents(),this._setUpAirPlay(),this._attachAirPlayEvents(),this._setUpInViewTracking(),this._video.style.display=""}isInView(){var e,t;return null===(e=null==(t=this._playerInViewTracker)?void 0:t.isInView)||void 0===e||e}_cleanUpAirPlay(){this._airPlayVideoElement&&(this._airPlayVideoElement.removeEventListener(Oi.LOADED_METADATA,this._AirPlayListenerLoadedMetadata),this._airPlayVideoElement.removeEventListener(Bi,this._AirPlayListenerAvailability),this._airPlayVideoElement.removeEventListener(Xi,this._AirPlayListenerTarget),this._airPlayVideoElement=null)}_setUpAirPlay(){const e="AirPlay";this._airPlayVideoElement=document.createElement("video"),this._airPlayVideoElement.playsInline=!0,this._AirPlayListenerLoadedMetadata=e=>{this.fire(Oi.LOADED_METADATA,e)},this._AirPlayListenerAvailability=t=>{switch(t.availability){case"available":this._airPlayAvailable||(this._airPlayAvailable=!0,this.fire(xi.AIRPLAY_AVAILABLE),this.fire(Mi.AVAILABLE,{type:e}));break;case"not-available":this._airPlayAvailable&&(this._airPlayAvailable=!1,this.fire(xi.AIRPLAY_UNAVAILABLE),this.fire(Mi.UNAVAILABLE,{type:e}))}},this._AirPlayListenerTarget=t=>{t.target.webkitCurrentPlaybackTargetIsWireless?(this.onexternaldisplayactivated(),this.fire(xi.AIRPLAY_ACTIVATED),this.fire(Mi.ACTIVATED,{type:e})):(this.onexternaldisplaydeactivated(),this.fire(xi.AIRPLAY_DEACTIVATED),this.fire(Mi.DEACTIVATED,{type:e}))},this._airPlayVideoElement.addEventListener(Oi.LOADED_METADATA,this._AirPlayListenerLoadedMetadata),this._airPlayVideoElement.addEventListener(Bi,this._AirPlayListenerAvailability),this._airPlayVideoElement.addEventListener(Xi,this._AirPlayListenerTarget)}_attachAirPlayEvents(){this._listenerAirPlay=()=>{this._video.webkitCurrentPlaybackTargetIsWireless?this._hls.stopLoad():this._hls.startLoad()},this._video.addEventListener(Xi,this._listenerAirPlay)}_detachAirPlayEvents(){this._video.removeEventListener(Xi,this._listenerAirPlay),this._listenerAirPlay=null}_initHlsJs(){var e;const t=window.Hls;if(!t)return;this._brain=function(){let e=null,t=[],r=[],n=null;return{lock:e=>{r=e||[],s()},createAugmentedController:({baseABRController:r})=>function({baseABRController:r}){return class extends r{constructor(t){super(t),t&&(e=t)}get nextAutoLevel(){var n;if(1===t.length)return t[0];const i=Object.getOwnPropertyDescriptor(r.prototype,"nextAutoLevel").get.call(this);if(0===t.length||t.includes(i))return i;const s=(null==(n=e.levels[i])?void 0:n.bitrate)||0,a=t.map(t=>{var r;return(null==(r=e.levels[t])?void 0:r.bitrate)||0}),o=Math.min.apply(Math,p(a)),c=Math.max.apply(Math,p(a));return s<o?t[a.indexOf(o)]:s>c?t[a.indexOf(c)]:i}set nextAutoLevel(e){Object.getOwnPropertyDescriptor(r.prototype,"nextAutoLevel").set.call(this,e)}}}({baseABRController:r}),setPreloadStreamIndex:e=>{if(n=e,null!==e){const r=i([e]);t=r.length?[r[0]]:[]}else s()},getPreloadStreamIndex:()=>n,getWhitelist:()=>r};function i(t){var r;const n=(null==(r=e)?void 0:r.levels)||[];if(!e||!n.length||null==t||!t.length)return[];const i=Kc(e.audioTracks||[],e.levels).video.filter((e,r)=>t.includes(r));return((e,t)=>e.map(e=>t.findIndex(t=>t.bitrate===e.bitrate)))(i,e.levels)}function s(){t=i(r)}}();const r=this._brain.createAugmentedController({baseABRController:t.DefaultConfig.abrController});this._customLoader=Jc();const n=this._customLoader.createCustomLoader({baseLoader:t.DefaultConfig.loader});this._hlsConfig={debug:"debug"===this._debugMode,liveDurationInfinity:!0,lowLatencyMode:null===(e=this._options.lowLatencyMode)||void 0===e||e,capLevelToPlayerSize:!0,capLevelOnFPSDrop:!0,renderTextTracksNatively:!1,liveSyncMode:this._options.dvrEnabled?"buffered":"edge",loader:n,abrController:r,backBufferLength:30,audioPreference:void 0,enableCEA708Captions:!1},this._hls=new t(this._hlsConfig),this._hls.attachMedia(this._video),this._hls.subtitleDisplay=!1,this._video.webkitCurrentPlaybackTargetIsWireless&&this._hls.stopLoad(),"window"!==this._debugMode&&"debug"!==this._debugMode||(window._hls=this._hls)}_synchronizeTextTracksState(e,t){const r=Zc(e.textTracks,t);"showing"===t.mode&&-1===this._hls.subtitleTrack&&(this._hls.subtitleTrack=r),"disabled"===t.mode&&-1!==this._hls.subtitleTrack&&(this._captionsTrack.mode="hidden"),"disabled"===t.mode&&this._telecineVideo.textTracks[r].dispatchEvent("cuechange")}_handleNativeFullscreenEnter(){if(this._captionsTrack){this._hls.subtitleDisplay=!0;const e=()=>{I(this._video)&&(this._synchronizeTextTracksState(this._video,this._captionsTrack),this._pollingTimeoutId=setTimeout(e,250))};e()}}_handleNativeFullscreenExit(){if(this._captionsTrack){const e=Zc(this._video.textTracks,this._captionsTrack);this._telecineVideo.textTracks[e].mode="hidden",this._hls.subtitleDisplay=!1}clearTimeout(this._pollingTimeoutId),this._pollingTimeoutId=null}_cleanUpInViewTracking(){var e;null==(e=this._playerInViewTracker)||e.cleanup()}_setUpInViewTracking(){this._cleanUpInViewTracking(),this._playerInViewTracker=pe(this._video)}_updatePlayRequestVideo(){var e;null!=(e=this._options)&&e.playRequest&&(this._options.playRequest.video=this._video)}_setEventStartTimeOffset(){var e;if(null==(e=this._hls)||!e.latestLevelDetails)return;const{startSN:t,targetduration:r,age:n}=this._hls.latestLevelDetails;this._eventStartTimeOffset=t*r+n}_getAirPlayFile(){var e;const t="AirPlay";if(null!=(e=this._telecineVideo.externalDisplayFiles)&&e[t])return this._telecineVideo.externalDisplayFiles[t];const r=this.constructor.prototype.supportedVideoTypes,n=this._telecineVideo.files.filter(e=>-1!==r.indexOf(e.mime)).sort((e,t)=>e.mime===t.mime?e.priority-t.priority:r.indexOf(e.mime)-r.indexOf(t.mime));if(!n.length)throw new Error("No files available for AirPlay.");return n[0]}_loadAirPlayMetadata(){const e=this;return tu(function(){return e._airPlayVideoElement.readyState>=e._airPlayVideoElement.HAVE_METADATA?Promise.resolve():eu(new Promise(function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}(function(t,r){return e._airPlayVideoElement.addEventListener(Oi.LOADED_METADATA,()=>t(),{once:!0}),iu(ru(function(){let{src:t,mime:r}=e._getAirPlayFile();const n=document.createElement("source");return n.type=r,eu(O(t),function(t){n.src=t,e._airPlayVideoElement.appendChild(n),e._airPlayVideoElement.load()})},function(e){r(e)}))})))})}_initVideoEventHandlers(){void 0!==this._video.webkitPresentationMode&&this._video.addEventListener(Oi.WEBKIT_PRESENTATION_MODE_CHANGED,()=>{this.fire(this.pictureInPictureActive?Oi.ENTER_PICTURE_IN_PICTURE:Oi.LEAVE_PICTURE_IN_PICTURE)})}_attachEventProxies(e){Object.values(Oi).forEach(t=>{const r=e=>this._onVideoEvent(t,e);e.addEventListener(t,r),this._eventHandlers[t]=r}),this._listenerWebKitFullscreenEnter=()=>{this._handleNativeFullscreenEnter()},this._listenerWebKitFullscreenExit=()=>{this._handleNativeFullscreenExit()},this._video.addEventListener(Oi.WEBKIT_BEGIN_FULLSCREEN,this._listenerWebKitFullscreenEnter),this._video.addEventListener(Oi.WEBKIT_END_FULLSCREEN,this._listenerWebKitFullscreenExit)}_detachEventProxies(e){Object.entries(this._eventHandlers).forEach(([t,r])=>{e.removeEventListener(t,r)}),this._eventHandlers={},this._video.removeEventListener(Oi.WEBKIT_BEGIN_FULLSCREEN,this._listenerWebKitFullscreenEnter),this._video.removeEventListener(Oi.WEBKIT_END_FULLSCREEN,this._listenerWebKitFullscreenExit),clearTimeout(this._pollingTimeoutId),this._pollingTimeoutId=null}_onVideoEvent(e,t){this.fire(e,t)}get preload(){return this._preload}set preload(e){this._preload=e}get currentTime(){return this._video?this._video.currentTime+this._eventStartTimeOffset:0}set currentTime(e){this._isNearLiveEdge(e)&&(e=this.liveEdgeTime),this._video.currentTime=Math.max(e-this._eventStartTimeOffset,0)}get paused(){return this._video.paused}get ended(){return this._video.ended}get videoWidth(){return this._video.videoWidth}get videoHeight(){return this._video.videoHeight}get duration(){return this._video.duration}get buffered(){return this._video.buffered}get playbackRate(){return this._video.playbackRate}set playbackRate(e){this._video.playbackRate=e}set muted(e){this._video.muted=e}get muted(){return this._video.muted}get volume(){return F(this._video.volume)}set volume(e){this._video.volume=U(e)}get played(){return this._video.played}get audioTracks(){if(!this._enableMultiAudioLive)return[];const{audioTrack:e,audioTracks:t}=this._hls;return t.length?function(e,t){if(!e.length)return[];const r=e.find(e=>e.default),n=r?r.id:e[0].id,i=-1!==t;return e.map(e=>{const r=i?e.id===t:e.id===n;return{id:`${e.id}`,language:e.lang,label:e.name,kind:zc(e),provenance:$c(e),enabled:r}})}(t,e):[]}get autoPictureInPicture(){return this._video.autoPictureInPicture}set autoPictureInPicture(e){this._video.autoPictureInPicture=e}get disablePictureInPicture(){return this._video.disablePictureInPicture}set disablePictureInPicture(e){this._video.disablePictureInPicture=e}requestPictureInPicture(){const e=this;return tu(function(){return eu(function(t,r){var n=function(){if(e._video.readyState<e._video.HAVE_METADATA)return function(e){if(!void 0)return e&&e.then?e.then(nu):Promise.resolve()}(e._initPreload())}();return n&&n.then?n.then(r):r()}(0,function(){try{var t;return null!==(t=e._video.requestPictureInPicture())&&void 0!==t?t:e._video.webkitSetPresentationMode("picture-in-picture")}catch(e){throw new Error("Picture-in-picture is not supported by this browser",e)}}))})}play(){return this._video.play()}pause(){this._video.pause()}set currentFile(e){this._currentFile=e,this.setVideoSrc(e.src)}get currentFile(){return this._currentFile}get video(){return this._telecineVideo}set video(e){this._telecineVideo!==e&&(this._captionsTrack&&this._captionsTrack.removeEventListener("cuechange",this._listenerCaptionsCue),this._telecineVideo=e,this._files=e.files.filter(e=>-1!==su.supportedVideoTypes.indexOf(e.mime)),this._customLoader.setPlaylistRefreshUrl(e.metadata.playlistRefreshUrl),this._updateCurrentFile())}setVideoSrc(e){const t=this;return tu(function(){return eu(iu(ru(function(){return eu(O(e),function(e){t.fire(Ui.CURRENT_FILE_CHANGE,t._currentFile),t._hls.loadSource(e),t._video.webkitCurrentPlaybackTargetIsWireless&&t._hls.stopLoad()})},function(e){t._handleFatalError(`error setting video src: ${e}`)})))})}getCurrentStream(e="video"){var t,r;let n=null==(t=this._hls)?void 0:t.currentLevel;var i,s;return"audio"===e?(n=null==(i=this._hls)?void 0:i.audioTrack,(null==(s=this._streams.audio)?void 0:s[n])||null):(null==(r=this._streams.video)?void 0:r[n])||null}_pickFile(){if(this._files.length<1)return null;const e=this._files.slice(0).sort((e,t)=>e.priority-t.priority);return e[0]}_updateCurrentFile(){const e=this._pickFile();e?this.currentFile=e:this._handleFatalError("all files failed")}_initPreload(){return new Promise(e=>{this.once(Oi.LOADED_METADATA,e)})}get externalDisplayAvailable(){return!0}get externalDisplayActive(){return this._externalDisplayActivated}get latency(){var e;return(null==(e=this._hls)?void 0:e.latency)||0}get lowLatencyMode(){var e,t;return null!==(e=null==(t=this._hls)?void 0:t.lowLatencyMode)&&void 0!==e&&e}set lowLatencyMode(e){this._hls&&(this._hls.lowLatencyMode=e)}get presentationDelay(){var e;return(null==(e=this._hls)?void 0:e.targetLatency)||0}get videoElement(){return this._video}get manifest(){const{audio:e,video:t}=this._streams;return{audio:e.toReversed(),video:t.toReversed()}}get atLiveEdge(){return this._isNearLiveEdge(this.currentTime)}get liveEdgeTime(){var e;return((null==(e=this._hls)?void 0:e.liveSyncPosition)||0)+this._eventStartTimeOffset}get atLiveTail(){return this._isNearLiveTail(this.currentTime)}get liveTailTime(){var e;if(null!=(e=this._hls)&&e.latestLevelDetails){const e=this._hls.latestLevelDetails.fragments[0];return((null==e?void 0:e.start)||0)+this._eventStartTimeOffset}return this._eventStartTimeOffset}_isNearLiveEdge(e){return e>=this.liveEdgeTime-3}_isNearLiveTail(e){return e<=this.liveTailTime+3}get pictureInPictureActive(){return"picture-in-picture"===this._video.webkitPresentationMode||!!document.pictureInPictureElement}exitPictureInPicture(){const e=this;return tu(function(){return"picture-in-picture"===e._video.webkitPresentationMode?eu(e._video.webkitSetPresentationMode("inline")):eu(document.exitPictureInPicture())})}get restrictedStreamIndexes(){var e;return null==(e=this._brain)?void 0:e.getWhitelist()}set restrictedStreamIndexes(e){var t;null==(t=this._brain)||t.lock(e)}get preloadStreamIndex(){var e;return null==(e=this._brain)?void 0:e.getPreloadStreamIndex()}set preloadStreamIndex(e){var t;null==(t=this._brain)||t.setPreloadStreamIndex(e)}getBitrateAtTime(e,t="video",r="average"){var n;const i=null==(n=this._hls)?void 0:n.currentLevel;if(-1===i||void 0===i)return 0;const s="average"===r?"averageBitrate":"bitrate";var a;return"video"===t?null==(a=this._hls.levels[i])?void 0:a[s]:this._hls.audioTracks[this._hls.audioTrack].bitrate}getHlsJs(){return this._hls}endLive(){this._streamOnline=!1,this.fire(Oi.ENDED)}takeSnapshot(){ts(this._video,this._videoWrapper)}removeSnapshot(){rs(this._videoWrapper)}swapVideo(e,t){const r=e.paused;e.pause(),this._detachEventProxies(e),e.parentElement.replaceChild(t,e),this._updatePlayRequestVideo(),this._attachEventProxies(t),this._video=t,t.currentTime=e.currentTime,r||t.play()}onexternaldisplayactivated(){this._externalDisplayActivated||(this._video!==this._airPlayVideoElement&&(this._originalVideo=this._video,this.swapVideo(this._video,this._airPlayVideoElement)),this._externalDisplayActivated=!0)}onexternaldisplaydeactivated(){this._externalDisplayActivated&&(this._originalVideo&&(this.swapVideo(this._airPlayVideoElement,this._originalVideo),this._originalVideo=null),this._externalDisplayActivated=!1)}showExternalDisplayPicker(){this._airPlayVideoElement.webkitShowPlaybackTargetPicker(),this._loadAirPlayMetadata().then(()=>this._airPlayVideoElement.webkitShowPlaybackTargetPicker()).catch(e=>{})}addTextTrack(e){return this._captionsTrack||this.loadTextTrack(e.label,e.language,e.id),this._captionsTrack}removeTextTrack(e){}getCuesForTrack(e){return this._video.textTracks[e.id].cues||[]}getActiveCuesForTrack(e){var t;return(null==(t=this._video.textTracks[e.id])?void 0:t.activeCues)||[]}setModeForTrack(e,t){this._captionsTrack.mode=t;const r="disabled"===t&&!this._captionsLoading;this._hls.subtitleTrack=r?-1:parseInt(e.id)}loadTextTrack(e,t,r){if(!this._captionsTrack){const n=new TelecineTextTrack({label:e,id:`${r}`,kind:"captions",language:t},this._telecineVideo);this._telecineVideo.textTracks=Yi([n]),this._captionsTrack=this._video.addTextTrack(n.kind,n.label,n.language),this._listenerCaptionsCue=()=>{n.dispatchEvent("cuechange")},this._captionsTrack.addEventListener("cuechange",this._listenerCaptionsCue)}}setCaptionsShouldDisplay(e){this._captionsVisible=e}setCaptionsShouldLoad(e){this._captionsLoading=e,this._hls.subtitleTrack=0}_handleFatalError(e){this.fire(Ui.SCANNER_ERROR,{reason:`hls.js fatal error: ${e}`})}enableAudioTrack(e){if(!e)return null;const t=parseInt(e,10);if(isNaN(t)||!this._hls.audioTracks||t<0||t>=this._hls.audioTracks.length)return null;this._hls.audioTrack!==t&&(this._hls.audioTrack=t);const r=this.audioTracks;let n=null;for(let t=0;t<r.length;t++){const i=r[t].id===e;r[t].enabled=i,i&&(n=r[t])}return this.fire(Ui.AUDIO_TRACK_CHANGED),n}_attachHlsJsEvents(){const e=window.Hls.Events,t={[e.ERROR]:this.hlsJsError,[e.MANIFEST_LOADED]:this.handleManifestLoaded,[e.LEVEL_LOADED]:this.handleLevelLoaded,[e.LEVEL_SWITCHED]:this.handleLevelSwitched,[e.FPS_DROP]:this.handleFPSDrop,[e.FRAG_LOADED]:this.handleFragmentLoaded,[e.NON_NATIVE_TEXT_TRACKS_FOUND]:this.handleNonNativeTextTracksFound,[e.CUES_PARSED]:this.handleCuesParsed,[e.BUFFER_APPENDED]:this.handleBufferAppended,[e.AUDIO_TRACKS_UPDATED]:this.handleAudioTracksUpdated};for(const e in t){const r=t[e];r&&(this._hls.on(e,r),this._hlsEventHandlers[e]=r)}}_detachHlsJsEvents(){if(!this._hls)return;const e=window.Hls.Events;Object.entries(this._hlsEventHandlers).forEach(([t,r])=>{this._hls.off(e[t],r)}),this._hlsEventHandlers={}}}const au=document.createElement("video");class ou extends As{static get displayName(){return"NativeHLSLiveScanner"}static get supportsMse(){return!1}static get supportsLive(){return!0}static supported(){return ou.supportedVideoTypes.length>0}static get supportedVideoTypes(){const e=[];return"function"!=typeof au.canPlayType||au.canPlayType(b.hlsLive).replace(/^no$/,"")&&e.push(b.hlsLive),e}constructor(e,t={}){var r;super(e,t),this._apiManifestUrl=null,this._playInitiated=!1,this._atLiveEdge=!0,this._atLiveTail=!1,this._secondsBehindPlaylistStart=0,this._playlistOffsetSet=!1,this.reset(),this.dvrEnabled=null!==(r=t.dvrEnabled)&&void 0!==r&&r,this.getLiveEventStartTimeEpoch=t.getLiveEventStartTimeEpoch,window.addEventListener("online",()=>{this.play()})}deactivate(){super.deactivate(),this.reset()}reset(){this._manifestRefreshTimeout&&clearTimeout(this._manifestRefreshTimeout),this._onReady=null,this._isOnline=!1,this._hasLiveEventEnded=!1,this._hlsAvailabilityCheckTimeout=null,this._manifestRefreshTimeout=null,this._secondsBehindPlaylistStart=0,this._playlistOffsetSet=!1,this._abr=new wc(this,this._options),this._restrictedStreamIndexes=[]}endLive(){this._isOnline=!1,this._hasLiveEventEnded=!0,clearTimeout(this._manifestRefreshTimeout),this._video.pause(),function(e){setTimeout(e,0)}(()=>{super.deactivate(),this.fire(Oi.ENDED)})}_setUpRefreshTimer(){const e=D(this.video.metadata.playlistRefreshUrl.split("?")[1]);e.expires&&(this._manifestRefreshTimeout=setTimeout(()=>{this._refreshLiveApiPlaylistUrl()},1e3*(e.expires-10)))}_refreshLiveApiPlaylistUrl(e=0){const t=this.video.metadata.playlistRefreshUrl;return Ye(t).json().then(r=>{if(!("url"in r))throw new Error(`Error parsing 'url' key from player live API refresh endpoint: ${t} ${r}`);return this._loadNativeHlsManifest(r.url.hls).then(()=>(this.play(),this._checkHlsAvailability(5e3),null)).catch(()=>this._refreshLiveApiPlaylistUrl(++e))}).catch(()=>{if(e>=3)throw new Error(`Manifest failed to load after ${e} attempts.`);return++e,this._refreshLiveApiPlaylistUrl(e)})}_setUpLiveEventListeners(){this.on(Fi.STREAM_OFFLINE,()=>{this._isOnline=!1})}_setUpNativeHls(e){return this._setUpLiveEventListeners(),this._isOnline=!0,this.fire(Fi.STREAM_ONLINE),this._checkHlsAvailability(5e3),Promise.resolve(e)}_loadNativeHlsManifest(e){return this._apiManifestUrl=e,/json=1/.test(e)?Ye(e).json().then(e=>{if(!("url"in e))throw new Error(`Error parsing 'url' key from Live API manifest endpoint: ${this._apiManifestUrl} ${e}`);this._video.src=this._getUrlWithMinSecondsParam(e.url),this._setUpRefreshTimer()}).catch(e=>{const t=this.video.metadata.playlistRefreshUrl;return Ye(t).json().then(e=>{if(!("url"in e))throw new Error(`Error parsing 'url' key from player live API refresh endpoint: ${t} ${e}`);this._apiManifestUrl=e.url.ios,this._video.src=this._getUrlWithMinSecondsParam(e.url.ios),this._setUpRefreshTimer()})}):(this._video.src=this._getUrlWithMinSecondsParam(e),this._setUpRefreshTimer(),Promise.resolve())}_getUrlWithMinSecondsParam(e){if(this.dvrEnabled)return e;const t=new URL(e);return t.searchParams.set("min_seconds","30"),t.toString()}_loadTextTracks(){const e=this._video.textTracks;if(null!=e&&e.length)for(let t=0;t<e.length;t++){const r=e[t];this._loadTextTrack(r)}}_loadTextTrack(e){if(e&&!this._captionsTrack){const{label:t,kind:r,language:n,id:i}=e,s=new TelecineTextTrack({label:t,kind:r,language:n,id:i},this._telecineVideo);this._telecineVideo.textTracks=Yi([s]),this._addTextTrackListeners(s,e),this.fire(Ui.TEXT_TRACKS_AVAILABLE),this._captionsTrack=e}}setModeForTrack(e,t){return this._captionsTrack&&this._captionsTrack.mode!==t&&(this._captionsTrack.mode=t),this}getActiveCuesForTrack(e){return this._captionsTrack&&"disabled"!==this._captionsTrack.mode?this._captionsTrack.activeCues:[]}addTextTrack(e){return this._captionsTrack||this._loadTextTracks(),this._captionsTrack}_checkHlsAvailability(e){"number"==typeof ue.iOS&&ue.iOS<9||this._hlsAvailabilityCheckTimeout||(this._hlsAvailabilityCheckTimeout=setTimeout(()=>{if(!this._isOnline)return;const e=new XMLHttpRequest;e.onload=()=>{410!==e.status?(200!==e.status&&this.fire(Fi.STREAM_OFFLINE),e.response.match(/^#EXTM3U\n#EXT-X-VERSION:3\n$/)&&this.fire(Fi.STREAM_OFFLINE)):this._refreshLiveApiPlaylistUrl()},e.onerror=()=>{this.fire(Fi.STREAM_OFFLINE)},/json=1/.test(this._apiManifestUrl)?Ye(this._apiManifestUrl).json().then(t=>{"url"in t||this.fire(Fi.STREAM_OFFLINE),e.open("GET",t.url),e.send()}).catch(()=>{e.open("GET",this._apiManifestUrl),e.send()}):(e.open("GET",this._apiManifestUrl),e.send())},e))}_shouldSnapToLiveEdge(e){return e>=this.liveEdgeTime-3}_hasDriftedBehindLiveEdge(e){return e>=this.liveEdgeTime-6}_isNearLiveTail(e){return e<=this.liveTailTime+6}setVideoSrc(e){this._onReady=this._setUpNativeHls(e).then(()=>(this._apiManifestUrl=e,this._loadNativeHlsManifest(e)))}ontimeupdate(){super.ontimeupdate(),this.atLiveTail=this._isNearLiveTail(this._video.currentTime),this._shouldSnapToLiveEdge(this._video.currentTime)?this.atLiveEdge=!0:(this._video.playbackRate<1||this._hasDriftedBehindLiveEdge())&&(this.atLiveEdge=!1)}onplaying(){this._playInitiated=!0}oncanplay(){if(!this._playInitiated){const e=this._video.seekable.length;e>0&&(this._video.currentTime=this._video.seekable.end(e-1))}if(!this._playlistOffsetSet){this._playlistOffsetSet=!0;const e=this._video.getStartDate().getTime()/1e3;this._secondsBehindPlaylistStart=e-this.getLiveEventStartTimeEpoch()}this._loadTextTracks()}onprogress(){this._hlsAvailabilityCheckTimeout&&(clearTimeout(this._hlsAvailabilityCheckTimeout),this._hlsAvailabilityCheckTimeout=null)}onstalled(){this._checkHlsAvailability(1e4)}onerror(){return this._video.error.code===this._video.error.MEDIA_ERR_SRC_NOT_SUPPORTED?(Ye(this._apiManifestUrl).then(()=>{super.onerror()}).catch(e=>{e instanceof Pe?this.fire(Oi.ERROR,new TelecineError("MediaNetworkError","A network error ocurred while fetching the media.")):super.onerror()}),!1):super.onerror()}onwaiting(){this._checkHlsAvailability(1e4)}get currentTime(){return this._secondsBehindPlaylistStart+this._video.currentTime}set currentTime(e){if(this.liveEdgeTime){const t=e>=this.liveEdgeTime-3;this.atLiveEdge=t}this._video.currentTime=e-this._secondsBehindPlaylistStart}get liveEdgeTime(){const e=this._video.seekable.length;return e>0?this._secondsBehindPlaylistStart+this._video.seekable.end(e-1):0}get atLiveEdge(){return this._atLiveEdge}set atLiveEdge(e){this.dvrEnabled&&(this._atLiveEdge=e,this._video.playbackRate>1&&e&&(this._video.playbackRate=1))}get atLiveTail(){return this._atLiveTail}set atLiveTail(e){this.dvrEnabled&&(this._atLiveTail=e,this._video.playbackRate<1&&e&&(this._video.playbackRate=1))}get liveTailTime(){return this._video.seekable.length>0?this._secondsBehindPlaylistStart+this._video.seekable.start(0):0}get ended(){return this._hasLiveEventEnded}get supportsPlaybackRate(){return super.supportsPlaybackRate&&this.dvrEnabled}pause(){this.dvrEnabled&&(this.atLiveEdge=!1),super.pause()}play(){return super.play(()=>this._onReady)}}class cu{static get displayName(){return"Effect"}static get supported(){return!1}static get supportedScanners(){return[]}constructor(e,t={}){this._telecine=e,this._element=e._element,this._options=t}activate(){throw new TelecineError("NotImplemented","The effect must implement the activate method.")}deactivate(){throw new TelecineError("NotImplemented","The effect must implement the deactivate method.")}}const uu=new WeakMap,lu=new WeakMap;class TelecineFile{constructor({src:e,mime:t,id:r=Ae(),priority:n=0,metadata:i={}},s){if(!e)throw new TypeError("Must provide a src for the file.");if(!t)throw new TypeError("Must provide a mime type for the file.");Object.defineProperties(this,{mime:{value:t,enumerable:!0},id:{value:`${r}`,enumerable:!0},metadata:{value:i,enumerable:!0}}),this.video=s,this.priority=n,this.src=e}get priority(){return uu.get(this)}set priority(e){if(!("number"==typeof(e=parseInt(e,10))&&isFinite(e)&&Math.floor(e)===e&&e>=0))throw new TypeError("The file priority must be an integer greater than or equal to 0.");uu.set(this,e)}get src(){return lu.get(this)}set src(e){lu.set(this,e),this.video.fire(Ui.FILE_SRC_UPDATE,this)}get restrictedStreamIndexes(){if(!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this.video.currentScanner),"restrictedStreamIndexes"))throw new ReferenceError("The current scanner does not support streams.");return this.video.currentScanner.restrictedStreamIndexes}set restrictedStreamIndexes(e){if(!Array.isArray(e))throw new TypeError("Indexes must be an array.");if(!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this.video.currentScanner),"restrictedStreamIndexes"))throw new ReferenceError("The current scanner does not support streams.");this.video.currentScanner.restrictedStreamIndexes=e}}class hu extends Ir{constructor({enabled:e=!1,id:t=Ae(),kind:r="",label:n="",language:i="",provenance:s=""},a){super(),this._enabled=e,Object.defineProperties(this,{kind:{value:r,enumerable:!0},label:{value:n,enumerable:!0},language:{value:i,enumerable:!0},id:{value:`${t}`,enumerable:!0},provenance:{value:s,enumerable:!0}}),this.video=a}get enabled(){return this._enabled}get active(){return this._enabled}set enabled(e){this._enabled=e}dispatchEvent(e){this.fire(e,{target:this})}}const du="default";class fu{constructor(){this._cdmList={},this._preferredKeySystems={},this._licenseTokenUrls={},this._licenseUrls={},this._certificateUrls={},this._keySessions={},this._keyChainState=du,this._keyTypes={KEYCHAIN_DEFAULT:du,KEYCHAIN_SD_FALLBACK:"sd-fallback"}}get state(){return this._keyChainState}set state(e){Object.values(this._keyTypes).indexOf(e)<0||(this._keyChainState=e)}get activeKeySession(){return this._keySessions[this._keyChainState]}get activeKeySystem(){return this._preferredKeySystems[this._keyChainState]}get keyTypes(){return this._keyTypes}get activeLicenseTokenUrl(){return this._licenseTokenUrls[this._keyChainState]}get activeLicenseUrl(){return this._licenseUrls[this._keyChainState]}getAllKeySessions(){return Object.values(this._keySessions)||[]}getCdms(e){return this._cdmList[e]}getKeySystem(e){return this._preferredKeySystems[e]}getAllPreferredKeySystems(){return this._preferredKeySystems}addCdms(e,t){this._cdmList[t]=e}addKeySession(e,t){this._keySessions[t]=e}addLicenseTokenUrl(e,t){this._licenseTokenUrls[t]=e}addLicenseUrl(e,t){this._licenseUrls[t]=e}addPreferredKeySystem(e,t){this._preferredKeySystems[t]=e}closeAllKeySessions(){for(let e in this._keySessions)this._keySessions[e]&&this._keySessions[e].sessionId&&this._keySessions[e].close()}}const _u="com.apple.fps.1_0",pu="com.microsoft.playready";function vu(e,t,r){return r?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function mu(e,t){var r=e();return r&&r.then?r.then(t):t(r)}function gu(e,t,r){if(r)return t?t(e()):e();try{var n=Promise.resolve(e());return t?n.then(t):n}catch(e){return Promise.reject(e)}}function Eu(){}class Tu{constructor(e,t,r={}){this.logPrefix="DrmHandler :",this._hasFallbackAssets=!!e.fallback_asset,this._useHls=t,this._drmLaUrlParams=r,this._fallbackCallback=()=>null,this._currentTime=0,this._firstLaUrlRequest=!0,this._hasFallbackSourceUpdated=!1,this._encryptedEventName=null,this._boundGenerateRequest=this._generateRequest.bind(this),this._boundOnKeyStatus=this._onKeyStatus.bind(this),this._boundUpdateTimeRef=this.updateTimeRef.bind(this),this._keyChain=new fu,this._keyTypes=this._keyChain.keyTypes,this._keyChain.state=this._keyTypes.KEYCHAIN_DEFAULT,this.updateLAUrls(e)}init(e,t={},r={}){const n=this;return gu(function(){let i=!1;return n._video=e._video,n._scanner=e,window.MediaKeys&&window.navigator&&window.navigator.requestMediaKeySystemAccess&&window.MediaKeySystemAccess&&window.MediaKeySystemAccess.prototype.getConfiguration||window.WebKitMediaKeys?(r=n._initDataToArray(r),vu(mu(function(){if(n._keyChain.state===n._keyTypes.KEYCHAIN_SD_FALLBACK)return n._scanner.once(Oi.SEEKING,n._boundUpdateTimeRef),n._hasFallbackSourceUpdated=!0,vu(n.waitForPlayAttempt(),function(){const e=n.setUpKeySystem(t,r,n._keyTypes.KEYCHAIN_SD_FALLBACK).then(()=>{n._scanner.currentTime=n._currentTime,n._scanner.play()});return i=!0,e})},function(e){if(i)return e;const s=n._keyChain.getCdms(n._keyTypes.KEYCHAIN_DEFAULT);return s?vu(vc(s,n._useHls,t),function(e){let i=!1;const a=n.getPreferredMediaKeySystem(e);return a&&a.mediaKeys?(n._scanner.fire(Ui.DRM_CDM_CHANGE,a.name),mu(function(){if(n._hasFallbackAssets){var e;const t=a.name===s.widevine.id,r=(()=>{try{return window.location.origin!==window.parent.location.origin}catch(e){return!0}})(),o=t&&r&&!mc.some(e=>window.location.hostname.includes(e)),c=null==(e=a.mediaKeys)?void 0:e.getStatusForPolicy;return vu(c?a.mediaKeys.getStatusForPolicy({minHdcpVersion:"1.0"}):"usable",function(e){if(o||"output-restricted"===e){const e=n._fallBackToSD();return i=!0,e}},!c)}},function(e){return i?e:vu(n.waitForPlayAttempt(),function(){return n.setUpKeySystem(t,r)})})):Promise.reject(fs)}):Promise.reject("No CDMs set for keyType: "+n._keyTypes.KEYCHAIN_DEFAULT)}))):(n._scanner.fire(Ui.EME_UNSUPPORTED),Promise.reject("Encrypted Media Extensions are not supported!"))})}updateTimeRef(){this._currentTime=this._scanner.currentTime}updateLAUrls(e){this._keyChain.addCdms(e.cdms,this._keyTypes.KEYCHAIN_DEFAULT),e.fallback_asset&&this._keyChain.addCdms(e.fallback_cdms,this._keyTypes.KEYCHAIN_SD_FALLBACK)}waitForPlayAttempt(){const e=this;return gu(function(){return vu(new Promise(t=>{e._scanner.paused&&!e._scanner.isPlayRequestActive?(e._scanner.once(Oi.PLAY,()=>t()),e._scanner.once(Oi.SEEKING,()=>t())):t()}))})}_initDataToArray(e={}){if(void 0===e||void 0===e.inits)return e;const t=ci(e);for(var r=0,n=Object.entries(t.inits);r<n.length;r++){const[t,a]=n[r];for(var i=0,s=Object.entries(a);i<s.length;i++){const[t,r]=s[i];if(void 0===r||void 0===r.initData)return e;r.initData=$i(r.initData)}}return t}getPreferredMediaKeySystem(e){let t=e.find(e=>(e.name===_u||e.name===pu)&&null!==e.mediaKeys);return t||(t=e.find(e=>null!==e.mediaKeys)),t}setUpKeySystem(e,t,r=this._keyTypes.KEYCHAIN_DEFAULT){const n=this,i=this._keyChain.getCdms(r);return i?vc(i,this._useHls,e).then(function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}(function(e){const s=n.getPreferredMediaKeySystem(e);if(!s||!s.mediaKeys)throw n._scanner.fire(Ui.EME_UNSUPPORTED),new Error(fs);n._keyChain.addPreferredKeySystem(s,r);const a=n._keyChain.activeKeySystem&&function(e,t){let r=null;return Object.keys(e).forEach(n=>{t.name===e[n].id&&(r=e[n])}),r}(i,n._keyChain.activeKeySystem);if(n._scanner.fire(Ui.DRM_CDM_CHANGE,s.name),!a)throw n._scanner.fire(Ui.EME_UNSUPPORTED),new Error("No valid key system was found.");return mu(function(){if(a.certificate)return function(e){return e&&e.then?e.then(Eu):Promise.resolve()}(gc(a.certificate,s.mediaKeys))},function(){n._keyChain.addLicenseTokenUrl(a.license_url,r);const e=t&&t.inits&&t.inits[a.id];return e||n._addEncryptedHandler(a,r),n._setMediaKeys(r).then(()=>{const t=n._keyChain.state===r;return e&&t&&n._boundGenerateRequest(e.cenc,r)})})})):Promise.reject("No CDMs set for keyType: "+r)}destroy(){this._keyChain&&this._keyChain.closeAllKeySessions(),this._video&&this._video.removeEventListener(this._encryptedEventName,this._boundGenerateRequest)}_switchKeyChainState(e){const t=this;return gu(function(){var r;return t._keyChain.state=e,null==(r=t._keyChain.activeKeySession)||r.addEventListener("message",e=>t._getLicense(e)),vu()})}_addEncryptedHandler(e,t){this._encryptedEventName="encrypted",this._keyChain.addLicenseUrl(e.license_url,t),this._useHls&&(this._certificateUrl=e.certificate_url,this._encryptedEventName="webkitneedkey"),this._video.addEventListener(this._encryptedEventName,this._boundGenerateRequest)}_setMediaKeys(e){if(this._useHls)this._video.webkitSetMediaKeys(this._keyChain.activeKeySystem.mediaKeys);else{this._video.mediaKeys;const t=this._video.mediaKeys||this._keyChain.activeKeySystem.mediaKeys;if(this._keyChain.addKeySession(this._createSession(t),e),e===this._keyChain.state&&this._keyChain.activeKeySession.addEventListener("message",e=>this._getLicense(e)),!this._video.mediaKeys)return this._video.setMediaKeys(this._keyChain.activeKeySystem.mediaKeys)}return Promise.resolve()}_createSession(e,t,r){const n=t&&r?e.createSession(t,r):e.createSession();if(!n)throw new Error("Could not create media key session");return n}_generateRequest(e,t){return t=t||this._keyChain.state,this._keyChain.activeKeySystem.name===_u?(this._loadFairPlayCertificate(this._certificateUrl).then(r=>{this._contentId=function(e){const t=function(e){const t=new Uint16Array(e.buffer);return String.fromCharCode.apply(null,t)}(e),r=document.createElement("a");return r.href=t,r.hostname}(e.initData);const n=function(e,t,r){const n=new Uint8Array(function(e){const t=new ArrayBuffer(2*e.length),r=new Uint16Array(t);for(let t=0,n=e.length;t<n;t++)r[t]=e.charCodeAt(t);return r}(t).buffer);let i=0;const s=new ArrayBuffer(e.byteLength+4+n.byteLength+4+r.byteLength),a=new DataView(s);new Uint8Array(s,i,e.byteLength).set(e),i+=e.byteLength,a.setUint32(i,n.byteLength,!0),i+=4;const o=new Uint8Array(s,i,n.byteLength);return o.set(n),i+=o.byteLength,a.setUint32(i,r.byteLength,!0),i+=4,new Uint8Array(s,i,r.byteLength).set(r),new Uint8Array(s,0,s.byteLength)}(e.initData,this._contentId,r);return this._keyChain.addKeySession(this._createSession(this._keyChain.activeKeySystem.mediaKeys,"video/mp4",n),t),this._keyChain.activeKeySession.contentId=this._contentId,this._keyChain.activeKeySession.addEventListener("webkitkeymessage",e=>this._getLicense(e)),this._keyChain.activeKeySession.addEventListener("webkitkeyerror",e=>{this._hasFallbackAssets?this._fallBackToSD():this._scanner.fire(Ui.DRM_OUTPUT_RESTRICTED)}),r}).catch(e=>{this._scanner.fire(e.error,e.payload)}),!0):!this._keyChain.activeKeySession.sessionId&&!this._activeKeySession&&(this._keyChain.activeKeySession.addEventListener("keystatuseschange",this._boundOnKeyStatus),this._activeKeySession=this._keyChain.activeKeySession.generateRequest(e.initDataType,e.initData).catch(()=>{this._scanner.fire(Ui.DRM_FAILURE)}),!0)}_onKeyStatus(){let e=!1;const t=Array.from(this._keyChain.activeKeySession.keyStatuses.values());if(t.forEach((t,r)=>{"expired"===t&&(e=!0)}),t.length&&t.every(e=>"output-restricted"===e)){if(this._hasFallbackAssets)return void this._fallBackToSD();this._scanner.fire(Ui.DRM_OUTPUT_RESTRICTED)}e&&this._keyChain.activeKeySession.close()}_getLicense(e){return this._getLicenseUrl(this._keyChain.activeLicenseTokenUrl).then(t=>new Promise((r,n)=>{this._keyChain.addLicenseUrl(t,this._keyChain.state),this._activeKeySession=null;const i=new XMLHttpRequest;i.keySession=e.target,i.open("POST",this._keyChain.activeLicenseUrl),i.responseType="arraybuffer";let s=e.message;if(this._keyChain.activeKeySystem.name===pu){const t=function(e){const t=e,r=String.fromCharCode.apply(null,new Uint16Array(t)),n=(new DOMParser).parseFromString(r,"application/xml"),i={},s=n.getElementsByTagName("HttpHeader");for(let e=0;e<s.length;++e){const t=s[e].querySelector("name"),r=s[e].querySelector("value");t&&r&&(i[t.textContent]=r.textContent)}return[i,$i(n.querySelector("Challenge").textContent)]}(e.message),r=t[0];Object.keys(r).forEach(e=>{i.setRequestHeader(e,r[e])}),s=t[1]}this._keyChain.activeKeySystem.name===_u&&(s=new Uint8Array(s),i.setRequestHeader("Content-type","application/octet-stream")),i.onload=()=>{if(403!==i.status)if(i.status>=400)n(new TelecineError(Ui.DRM_FAILURE));else try{this._scanner.fire(Ui.DRM_AUTH_SUCCESS);const e=new Uint8Array(i.response);i.keySession.update(e),r()}catch(e){n(new TelecineError(Ui.DRM_FAILURE,`Error updating key session: ${e}`))}else n(new TelecineError(Ui.DRM_AUTH_FAILURE))},i.onerror=n,i.send(s)}).catch(e=>{this._scanner.fire(e.name,{text:e.message||"License request failed."})}))}_getLicenseUrl(e){const t=((e,t)=>{const{atid:r,dnt:n,context:i,leadUUID:s,playerLocation:a,firstLog:o,playbackRoute:c,referrer:u}=t;return k(e,{atid:r,context:i,referrer:u,dnt:1===n?n:void 0,first_log:o?"1":void 0,lead_uuid:s,player_location:a,playback_route:c},!0)})(e,f(f({},this._drmLaUrlParams),{},{firstLog:this._firstLaUrlRequest}));return new Promise((e,r)=>{const n=new XMLHttpRequest;n.withCredentials=!0,n.open("GET",t),n.onload=()=>{if(n.status>=400)r(new TelecineError(Ui.DRM_FAILURE));else try{try{const t=JSON.parse(n.response),{licenseAcquisitionUrl:r,token:i}=t;if(!r&&!i)throw new Error;e(`${r}?ExpressPlayToken=${i}`)}catch(t){e(n.response)}}catch(e){r(new TelecineError(Ui.DRM_FAILURE,`Error retrieving License Acquisition URL (LA_URL): ${e}`))}},n.onerror=r,n.send(),this._firstLaUrlRequest=!1})}_loadFairPlayCertificate(e){return new Promise((t,r)=>{const n=new XMLHttpRequest;n.open("GET",e),n.responseType="arraybuffer",n.setRequestHeader("Pragma","no-cache"),n.setRequestHeader("Cache-Control","max-age=0"),n.onload=()=>{if(403!==n.status)if(n.status>=400)r({error:Ui.DRM_FAILURE});else try{t(new Uint8Array(n.response))}catch(e){r(e)}else r({error:Ui.DRM_AUTH_FAILURE})},n.onerror=r,n.send()})}_switchKeyChainToFallback(){return this._switchKeyChainState(this._keyTypes.KEYCHAIN_SD_FALLBACK).then(()=>{this._fallbackCallback(),this._scanner.fire(Ui.DRM_KEY_SWITCH,this._keyTypes.KEYCHAIN_SD_FALLBACK)}).catch(e=>{this._scanner.fire(Ui.DRM_OUTPUT_RESTRICTED)})}_fallBackToSD(){var e,t;this.updateTimeRef(),this._useHls?(null==(e=this._keyChain)||e.closeAllKeySessions(),null==(t=this._video)||t.removeEventListener(this._encryptedEventName,this._boundGenerateRequest),this._scanner.once(Oi.SEEKING,this._boundUpdateTimeRef),this._hasFallbackSourceUpdated=!0,this._switchKeyChainToFallback(),this.waitForPlayAttempt().then(()=>{this.setUpKeySystem({},{},this._keyTypes.KEYCHAIN_SD_FALLBACK).then(()=>{this._scanner.currentTime=this._currentTime,this._scanner.play()})})):this._switchKeyChainToFallback()}setFallbackCallback(e){this._fallbackCallback=()=>e()}get state(){return this._keyChain.state}get hasFallbackAssets(){return this._hasFallbackAssets}get hasFallbackSourceUpdated(){return this._hasFallbackSourceUpdated}set hasFallbackSourceUpdated(e){this._hasFallbackSourceUpdated=e}}const yu=document.createElement("video"),Su={settingPlaybackRate:(()=>{if(ue.android&&Gi&&"object"==typeof Gi&&Gi.major<52)return!1;const e=yu.playbackRate;yu.playbackRate=.5*e;const t=e!==yu.playbackRate;return yu.playbackRate=e,t})(),settingVolume:(()=>{if(ue.android||ue.iOS||ue.iPadOS)return!1;const e=yu.volume;return yu.volume=.5*e,yu.volume!==e})(),textTracks:void 0!==yu.textTracks&&"undefined"!=typeof TextTrackList&&yu.textTracks instanceof TextTrackList},bu=new WeakMap;class TelecineVideo extends Ir{constructor({files:e,id:t=Ae(),title:r=null,subtitle:n=null,metadata:i={},textTracks:s=Yi(),audioTracks:a=Yi(),externalDisplayFiles:o={},chapters:c=[],duration:u}){if(super(),!e||!Array.isArray(e))throw new TypeError("Must provide files for the video.");const l=function(e=[]){return e.getFileById=Ki,e}(e.map(e=>e instanceof TelecineFile?(e.video=this,e):new TelecineFile(e,this))),h=Yi(s.map(e=>e instanceof TelecineTextTrack?(e.video=this,e):new TelecineTextTrack(e,this)));if(this._audioTracksFromConfig=a,Object.keys(o).forEach(e=>{!o[e]||o[e]instanceof TelecineFile||(o[e]=new TelecineFile(o[e],this))}),Object.defineProperties(this,{id:{value:`${t}`,enumerable:!0},title:{value:r,enumerable:!0},subtitle:{value:n,enumerable:!0},metadata:{value:i,enumerable:!0},files:{value:l,enumerable:!0},textTracks:{value:h,enumerable:!0,writable:!0},chapters:{value:c,enumerable:!0},duration:{value:u,enumerable:!0},externalDisplayFiles:{value:o,enumerable:!0}}),i.drm){const{drm:e,useHls:t,drmLaUrlParams:r}=i;this._drmHandler=new Tu(e,t,r)}}get drmHandler(){return this._drmHandler||null}get currentFile(){return this.currentScanner.currentFile}set currentFile(e){this.currentScanner.currentFile=e}get currentScanner(){return bu.get(this)}set currentScanner(e){this.currentScanner&&Su.textTracks&&this.textTracks.forEach(e=>this.currentScanner.removeTextTrack(e)),Su.textTracks&&this.textTracks.forEach(t=>e.addTextTrack(t)),bu.set(this,e)}get audioTracks(){let e=[];return e=this.currentScanner.constructor.supportsAudioTracksFromScanner?Array.from(this.currentScanner.audioTracks):this._audioTracksFromConfig,Yi(e.map(e=>e instanceof hu?(e.video=this,e):new hu(e,this)))}get enabledAudioTrack(){return this.audioTracks.find(e=>!!e.enabled)}deactivate(){this._drmHandler&&this._drmHandler.destroy(),this.textTracks.forEach(e=>this.currentScanner.removeTextTrack(e))}}class Au extends Ir{constructor(e,t={}){super(),this._telecine=e,this._options=t,this._bufferInterval=null,this._lastBufferCheckVideoTime=this._options.embedTime?this._options.embedTime:0,this._isBuffering=!1,this._isSeeking=!1,this._userPlayState=!1,this.playInitiated=!1,this._isLiveStreamOnline=!1,this._checkInterval=250,this._boundEndBuffering=this._endBuffering.bind(this),this._boundOnPause=this._onPause.bind(this),this._boundOnSeeking=this._onSeeking.bind(this),this._boundOnSeeked=this._onSeeked.bind(this),this._boundOnLiveOnline=this._onLiveOnline.bind(this),this._boundOnLiveOffline=this._onLiveOffline.bind(this),this._toggleEvents(this._telecine.on),this._options.noInterval||this._setUpRebufferMonitor()}get userPlayState(){return this._userPlayState}set userPlayState(e){this._userPlayState=e,e||this._endBuffering()}destroy(){clearInterval(this._bufferInterval),this._toggleEvents(this._telecine.off),this._endBuffering()}_toggleEvents(e){e(Oi.PAUSE,this._boundOnPause),e(Oi.PLAYING,this._boundEndBuffering),e(Oi.SEEKING,this._boundOnSeeking),e(Oi.SEEKED,this._boundOnSeeked),e(Fi.STREAM_ONLINE,this._boundOnLiveOnline),e(Fi.STREAM_OFFLINE,this._boundOnLiveOffline)}_onPause(){this.userPlayState=!1}_endBuffering(){this._isBuffering&&(this._isBuffering=!1,this.fire(Ui.BUFFER_ENDED))}_onSeeking(){this._isSeeking=!0}_onSeeked(){this._isSeeking=!1}_onLiveOnline(){this._isLiveStreamOnline=!0}_onLiveOffline(){this._isLiveStreamOnline=!1}_setUpRebufferMonitor(){clearInterval(this._bufferInterval),this._bufferInterval=setInterval(this.runIntervalCheck.bind(this),this._checkInterval)}runIntervalCheck(){if(!this._telecine.video)return;const e=this._telecine.video.currentScanner;if(!e)return;const t=this._telecine.isLive(),r=e.videoElement.currentTime,n=this._checkInterval/2/1e3;if(this.playInitiated&&(!this._isSeeking||t)&&(!this._telecine.paused||this.userPlayState)&&!this._isBuffering&&r<this._lastBufferCheckVideoTime+n){if(t&&!this._isLiveStreamOnline)return;const e=this._telecine.buffered;for(let t=0;t<e.length;t++)if(r>=e.start(t)&&r+.2<=e.end(t))return void(this._lastBufferCheckVideoTime=r);if(r+n>=this._telecine.duration)return;this._isBuffering=!0,this.fire(Ui.BUFFER_STARTED)}(this.playInitiated&&this._isBuffering&&r>this._lastBufferCheckVideoTime+n||t&&!this._isLiveStreamOnline&&this._isBuffering)&&(this._isBuffering=!1,this.fire(Ui.BUFFER_ENDED)),this._lastBufferCheckVideoTime=r}}function Iu(){let e,t;function r(){if(!t)return Promise.reject();e.preload="";let r=e.play();return void 0===r&&(r=new Promise(t=>{e.addEventListener("playing",t)})),r}function n(){t&&(t.resolve(),t=null)}function i(e){t&&(t.reject(e),t=null)}return{set video(t){e=t},get video(){return e},get active(){return!!t},start:function(s=Promise.resolve.bind(Promise)){return t||(t=ve()),e.currentSrc?document.createElement("video").load():e.load(),s().then(r).then(n).catch(i),t},cancel:function(){t&&(t.reject(new TelecineError(hs,"The play() request was interrupted by a call to pause()")),t=null)}}}class wu extends Ir{constructor(e,t,r={}){super(),this._element=e,this._scanners=t,this._options=r,this._video=null,this._textTracks=Yi(),this._properties={},this._currentScanner=new As(e),this._options.playRequest=new Iu,this._blacklistedScanners=[],this._activeEffects=[],this._previousScanner=null,this._switchingVideo=!1,this._snapshotDisplayed=!1}get element(){return this._element}get videoElement(){return this._currentScanner.videoElement}get hlsJsVersion(){var e;return null!==(e=this._currentScanner.constructor.hlsJsVersion)&&void 0!==e?e:null}get manifest(){return this._currentScanner.manifest||{video:[]}}get supportsAudioTracksFromScanner(){return this._currentScanner.constructor.supportsAudioTracksFromScanner}supportsEffect(e){return!!e.supported&&e.supportedScanners.some(e=>this.currentScannerName===e.displayName)}get activeEffects(){return this._activeEffects}getEffectByName(e){let t=null;return this._activeEffects.forEach(r=>{e===this._getEffectName(r)&&(t=r)}),t}activateEffect(e,t){const r=new e(this,t);return r.activate(),this._activeEffects.push(r),r}deactivateEffect(e){return this._activeEffects.some((t,r)=>t.constructor===e&&(t.deactivate(),this._activeEffects.splice(r,1),!0))}deactivateEffects(){this._activeEffects.forEach(e=>this.deactivateEffect(e.constructor))}play(){if(!this._video||this._video.files.length<1)throw new TelecineError("NoFiles","There are no files to play.");this._rebufferMonitor.playInitiated||(this._rebufferMonitor.playInitiated=!0),this._rebufferMonitor.userPlayState=!0;const e=this._currentScanner.play();return this._properties.paused=!1,e}pause(){if(!this._video||this._video.files.length<1)throw new TelecineError("NoFiles","There are no files to play.");return this._rebufferMonitor.userPlayState=!1,this._currentScanner.pause(),this._properties.paused=!0,this}isLive(){return this._currentScanner.constructor.supportsLive}endLive(){this._currentScanner.endLive()}get latency(){return this._currentScanner.latency}get downloadSpeed(){return this._currentScanner.downloadSpeed||0}getBitrateAtTime(e,t="video",r="average"){var n,i;return this._currentScanner.constructor.supportsMse?"audio"===t&&this._currentScanner._streams[t].length<=1?0:(null==(n=(i=this._currentScanner).getBitrateAtTime)?void 0:n.call(i,e,t,r))||0:0}getCurrentStream(e="video"){var t,r;return null==(t=(r=this._currentScanner).getCurrentStream)?void 0:t.call(r,e)}showExternalDisplayPicker(e){this._currentScanner.showExternalDisplayPicker(e)}get pictureInPictureActive(){return this._currentScanner.pictureInPictureActive}requestPictureInPicture(){return this._currentScanner.requestPictureInPicture()}exitPictureInPicture(){return this._currentScanner.exitPictureInPicture()}get pictureInPictureEnabled(){return this._currentScanner.pictureInPictureEnabled}addChapter(e,t){this._currentScanner.addChapter(e,t)}removeChapter(e){this._currentScanner.removeChapter(e)}addCuePoint(e,t){return this._currentScanner.addCuePoint(e,t)}removeCuePoint(e){return this._currentScanner.removeCuePoint(e)}removeAllCuePoints(){return this._currentScanner.removeAllCuePoints()}enableAudioTrack(e){return this._currentScanner.enableAudioTrack(e)}addVideoEventListeners(){return this._currentScanner.addVideoEventListeners()}removeVideoEventListeners(){return this._currentScanner.removeVideoEventListeners()}get isLowerProfileAvailable(){return this._currentScanner.isLowerProfileAvailable}get buffered(){return this._currentScanner.buffered}get bufferTarget(){return this._currentScanner.bufferTarget}set bufferTarget(e){this._properties.bufferTarget=e,this._currentScanner.bufferTarget=e}get presentationDelay(){return this._currentScanner.presentationDelay}set presentationDelay(e){this._properties.presentationDelay=e,this._currentScanner.presentationDelay=e}get lowLatencyMode(){return this._currentScanner.lowLatencyMode}set lowLatencyMode(e){this._properties.lowLatencyMode=e,this._currentScanner.lowLatencyMode=e}get manifestLoadDurations(){return this._currentScanner.manifestLoadDurations?this._currentScanner.manifestLoadDurations:[]}get successfulSegments(){return this._currentScanner.successfulSegments?this._currentScanner.successfulSegments:[]}get failedSegments(){return this._currentScanner.failedSegments?this._currentScanner.failedSegments:[]}get cuePoints(){return this._currentScanner.cuePoints}get currentChapterID(){if(this._currentScanner&&this._currentScanner.chaptersTrack&&this._currentScanner.chaptersTrack.activeCues.length){const{activeCues:e}=this._currentScanner.chaptersTrack;return e[e.length-1].id}return null}get chapters(){return this._currentScanner.chaptersTrack?this._currentScanner.chaptersTrack.cues:[]}get chaptersTrack(){return this._currentScanner.chaptersTrack}get currentFile(){return this._currentScanner.currentFile}set currentFile(e){if("string"==typeof e&&(e=this._files.filter(t=>t.id===e)[0]),!e)throw new TelecineError("FileNotValid","The file is not valid.");this._currentScanner.currentFile=e}get currentScannerName(){return this._getScannerName(this._currentScanner)}get currentScanner(){return this._currentScanner}get currentTime(){return this._currentScanner.currentTime}set currentTime(e){this._properties.currentTime=e,this._currentScanner.currentTime=e}get liveEdgeTime(){const e=this._currentScanner.liveEdgeTime;return null==e?this._previousLiveEdgeTime:(this._previousLiveEdgeTime=e,e)}get atLiveEdge(){var e;return null!==(e=this._currentScanner.atLiveEdge)&&void 0!==e?e:this.isLive()}get liveTailTime(){const e=this._currentScanner.liveTailTime;return null==e?this._previousLiveTailTime:(this._previousLiveTailTime=e,e)}get atLiveTail(){var e;return null!==(e=this._currentScanner.atLiveTail)&&void 0!==e&&e}get disableRemotePlayback(){return this._properties.disableRemotePlayback}set disableRemotePlayback(e){this._properties.disableRemotePlayback=!!e,this._currentScanner.disableRemotePlayback=!!e}get duration(){return this._currentScanner.duration}get ended(){return this._currentScanner.ended}get externalDisplayAvailable(){return this._currentScanner.externalDisplayAvailable}get externalDisplayActive(){return this._currentScanner.externalDisplayActive}get loop(){return this._currentScanner.loop}set loop(e){this._properties.loop=e,this._currentScanner.loop=e}get muted(){return this._currentScanner.muted}set muted(e){this._properties.muted=!!e,this._currentScanner.muted=!!e}get playsinline(){return this._currentScanner.playsinline}set playsinline(e){this._properties.playsinline=!!e,this._currentScanner.playsinline=!!e}get paused(){return this._currentScanner.paused}get played(){return this._currentScanner.played}get seekable(){return this._currentScanner.seekable}get seeking(){return this._currentScanner.seeking}get defaultPlaybackRate(){return this._currentScanner.defaultPlaybackRate}set defaultPlaybackRate(e){this._properties.defaultPlaybackRate=e,this._currentScanner.defaultPlaybackRate=e}get playbackRate(){return this._currentScanner.playbackRate}set playbackRate(e){this._properties.playbackRate=e,this._currentScanner.playbackRate=e}get preload(){return this._currentScanner.preload}set preload(e){this._properties.preload=e,this._currentScanner.preload=e}get autoPictureInPicture(){return this._currentScanner.autoPictureInPicture}set autoPictureInPicture(e){this._properties.autoPictureInPicture=!!e,this._currentScanner.autoPictureInPicture=!!e}get disablePictureInPicture(){return this._currentScanner.disablePictureInPicture}set disablePictureInPicture(e){this._properties.disablePictureInPicture=!!e,this._currentScanner.disablePictureInPicture=!!e}get video(){return this._video}set video(e){this._video&&this._video.deactivate(),this._blacklistedScanners=[],this._setUpRebufferMonitor(),null===e?(this._video=null,this._resetScanner()):(this._video=new TelecineVideo(e),this._updateScanner())}get videoWidth(){return this._currentScanner.videoWidth}get videoHeight(){return this._currentScanner.videoHeight}get volume(){return this._currentScanner.volume}set volume(e){if(e<0||e>1)throw new TelecineError("IndexSizeError",`Failed to set the 'volume' property: The volume provided (${e}) is outside of the range [0, 1].`);this._properties.volume=e,this._currentScanner.volume=e}get audioTracks(){return this._currentScanner.audioTracks}get brainDebug(){return this._currentScanner.brainDebug}_findScanner({textTrackSupport:e=!1}={}){if(e&&!Su.textTracks)return null;const t=this._video.files.sort((e,t)=>e.priority-t.priority),r=this._scanners;for(const e in t){let n=t[e];for(const e in r){let t=r[e];if(t.supported(this._options.disableMMS)&&-1===this._blacklistedScanners.indexOf(this._getScannerName(t))&&t.supportedVideoTypes.some(e=>n.mime===e))return t}}return null}reactivate(){var e;null!=(e=this._currentScanner)&&e.reactivate&&this._currentScanner.reactivate(),this.play()}checkRebuffer(e,t){this._rebufferMonitor&&(this._rebufferMonitor.playInitiated=e,this._rebufferMonitor.userPlayState=t,this._rebufferMonitor.runIntervalCheck())}_initScanner(e,t){var r;if(this._currentScanner.constructor===e&&this._currentScanner.video===t)return;const n=!this.isLive()&&this._currentScanner._preserveCurrentTime;this._switchingVideo?(this._previousScanner=this._currentScanner,this._previousScanner._switchingVideo=!0,this._snapshotDisplayed||(ts(this._previousScanner.videoElement,this._element),this._snapshotDisplayed=!0),this._previousScanner.deactivate()):this._currentScanner.deactivate();const i=new e(this._element,this._options);Object.keys(Hi).forEach(e=>{const t=Hi[e];i.on(t,e=>this._handleEvent(t,e,i))}),this._currentScanner=i,t.currentScanner=i,this._currentScanner.video=t;const s=Object.keys(this._properties);for(let e=0;e<s.length;e++){const t=s[e];"paused"!==t?("currentTime"!==t||n)&&(this._currentScanner[t]=this._properties[t]):!1===this._properties.paused&&this._currentScanner.play()}var a,o;(null==(r=t.chapters)?void 0:r.length)>0&&(null==(a=(o=this._currentScanner).addChapters)||a.call(o,t.chapters,t.duration)),this.fire(Ui.SCANNER_CHANGE,this.currentScannerName),this._currentScanner.on([Oi.CAN_PLAY,Oi.PLAYING],()=>{this._previousScanner&&(this._previousScanner._switchingVideo=!1,rs(this._element),this._previousScanner=null,this._snapshotDisplayed=!1)})}_updateScanner(){if(null===this._video)return;const e=this._findScanner({textTrackSupport:this._video.textTracks.length>0});e?this._initScanner(e,this._video):this._fireVideoError("FilesNotPlayable","None of the files could be played in this browser.")}_resetScanner(){this._currentScanner.deactivate(),this._currentScanner=new As(this._element)}_handleEvent(e,t,r){if(r===this._currentScanner){switch(e){case Oi.ERROR:return void(t instanceof TelecineError&&this.fire(Oi.ERROR,t));case Ui.SCANNER_ERROR:this._fireVideoError("ScannerError",`The current scanner can no longer be used because ${t.reason}`),this._blacklistedScanners.push(this.currentScannerName),this._updateScanner([]);break;case Ui.FILE_ERROR:this._fireVideoError("FileError",`The current file can no longer be used because ${t.reason}`),this._currentScanner._switchToNextFile();break;case Ui.DOWNLOAD_ERROR:this._fireVideoError("DownloadError",t),this._currentScanner._switchToNextFile();break;case Ui.EME_UNSUPPORTED:this._fireVideoError(cs,{text:null,code:"emeunsupported"});break;case Ui.DRM_FAILURE:case Ui.DRM_AUTH_FAILURE:this._fireVideoError(cs,{text:t.text,code:t.code});break;case Ui.DRM_OUTPUT_RESTRICTED:this._fireVideoError(cs,{text:null,code:"outputrestricted"});break;case Ui.DRM_AUTH_SUCCESS:this.fire(Ui.DRM_AUTH_SUCCESS);break;case Ui.NO_SUPPORTED_CDM:this._rebufferMonitor.destroy();break;case Oi.TIME_UPDATE:this._properties.currentTime=this._currentScanner.currentTime;break;case Ui.MEDIA_URL_EXPIRED:this._fireVideoError("MediaUrlExpired",t);break;case Ui.MEDIA_URL_BAD_REQUEST:this._fireVideoError(ls,t);break;case Vi.SPATIAL_UNSUPPORTED:this.getEffectByName("ThreeSixtyEffect").deactivate();break;case Oi.ENDED:const e=!this._options.dvrEnabled||this.atLiveEdge;this._properties.paused=e;break;case Oi.WAITING:this.fire(Oi.WAITING)}this._activeEffects.forEach(t=>{"function"==typeof t[`on${e}`]&&t[`on${e}`]()}),this.fire(e,t)}}_fireVideoError(e,t){this.fire(Oi.ERROR,new TelecineError(e,t))}_getScannerName(e){var t;return null!==(t=e.constructor.displayName)&&void 0!==t?t:e.prototype.constructor.displayName}_setUpRebufferMonitor(){this._rebufferMonitor&&this._rebufferMonitor.destroy(),this._rebufferMonitor=new Au(this,this._options),this._rebufferMonitor.on(Ui.BUFFER_STARTED,()=>{this.fire(Ui.BUFFER_STARTED)}),this._rebufferMonitor.on(Ui.BUFFER_ENDED,()=>{this.fire(Ui.BUFFER_ENDED)})}_getEffectName(e){return e instanceof cu?e.constructor.displayName:e.prototype.constructor.displayName}_isLiveMse(){return this._currentScanner.constructor.supportsMse&&this._currentScanner.constructor.supportsLive}updateBufferTarget(){this._currentScanner&&this._currentScanner.getBufferTarget&&(this.bufferTarget=this._currentScanner.getBufferTarget())}setCaptionsShouldDisplay(e){this._isLiveMse()&&this._currentScanner.setCaptionsShouldDisplay(e)}setCaptionsShouldLoad(e){this._isLiveMse()&&this._currentScanner.setCaptionsShouldLoad(e)}}class Ru extends cu{static get displayName(){return"CanvasEffect"}static get supported(){return!0}static get supportedScanners(){return[As,bc]}constructor(e,t={}){super(e,t),this._activated=!1,this._video=this._telecine._currentScanner._video}activate(){this._activated=!0,this._canvas=document.createElement("canvas"),this._canvas.className="vp-canvas-effect",this._canvas.style.cssText="\n            position: absolute;\n            top:0;\n            left:0;\n            bottom:0;\n            right:0;\n        ",this._ctx=this._canvas.getContext("2d",{alpha:!1}),this._element.appendChild(this._canvas),this._startRendering()}deactivate(){this._canvas&&this._element.removeChild(this._canvas),this._stopRendering(),this._activated=!1}_startRendering(){this._requestFrame()}_requestFrame(){this._animationFrame=window.requestAnimationFrame(this._renderFrame.bind(this))}_renderFrame(){const e=this._video,t=this._canvas;t.width=e.clientWidth,t.height=e.clientHeight;const r=Math.floor(this._videoContentWidth()),n=Math.floor(this._videoContentHeight()),i=Math.floor((e.clientWidth-r)/2),s=Math.floor((e.clientHeight-n)/2);this._ctx.fillStyle="#000",this._ctx.fillRect(0,0,t.width,t.height),this._ctx.drawImage(e,i,s,r,n),this._requestFrame()}_videoRatio(){return this._video.videoHeight/this._video.videoWidth}_videoContentWidth(){return Math.min(this._video.clientHeight/this._videoRatio(),this._video.clientWidth)}_videoContentHeight(){return Math.min(this._video.clientWidth*this._videoRatio(),this._video.clientHeight)}_stopRendering(){this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=null)}}class Pu{static get Equirect(){return"equirectangular"}static get HalfEquirect(){return"halfequirectangular"}}class Du{static get Mono(){return"mono"}static get TopBottom(){return"top-bottom"}static get LeftRight(){return"left-right"}}class Lu{constructor(e,t,r){switch(this.isStereo=t!==Du.Mono,this._leftEye=null,this._rightEye=null,e){case Pu.Equirect:this.createEquirectProjection(r,t);break;case Pu.HalfEquirect:this.createHalfEquirectProjection(r,t);break;default:this.createEquirectProjection(r,Du.Mono)}}get left(){return this._leftEye}get right(){return this._rightEye}createEquirectProjection(e,t){this._createProjection(e,t,e=>this._createEquirectangularSphereMesh(e))}createHalfEquirectProjection(e,t){this._createProjection(e,t,e=>this._createHalfEquirectangularSphereMesh(e))}_createProjection(e,t,r){t!==Du.Mono?(this._leftEye=r(e),this._rightEye=r(e),this._leftEye.layers.set(1),this._rightEye.layers.set(2),t===Du.TopBottom&&(this._chopGeometryUvs(this._leftEye.geometry,.5,.5),this._chopGeometryUvs(this._rightEye.geometry,.5,0)),t===Du.LeftRight&&(this._chopGeometryUvs(this._leftEye.geometry,.5,0,0),this._chopGeometryUvs(this._rightEye.geometry,.5,.5,0))):this._leftEye=r(e)}_createHalfEquirectangularSphereMesh(e){const t=new THREE.SphereBufferGeometry(Lu.SPHERE_RADIUS,Lu.TESSELATION_WIDTH,Lu.TESSELATION_HEIGHT,0,Math.PI,0,Math.PI);t.scale(-1,1,1);const r=new THREE.MeshBasicMaterial({map:e}),n=new THREE.Mesh(t,r);return n.rotation.y=Math.PI,n}_createEquirectangularSphereMesh(e,t,r,n){const i=new THREE.SphereBufferGeometry(t||Lu.SPHERE_RADIUS,r||Lu.TESSELATION_WIDTH,n||Lu.TESSELATION_HEIGHT);i.scale(-1,1,1);const s=new THREE.MeshBasicMaterial({map:e});return new THREE.Mesh(i,s)}_chopGeometryUvs(e,t,r,n=1){for(let i=0;i<e.attributes.uv.array.length;i+=2)e.attributes.uv.array[i+n]*=t,e.attributes.uv.array[i+n]+=r}static get TESSELATION_WIDTH(){return 120}static get TESSELATION_HEIGHT(){return 80}static get SPHERE_RADIUS(){return 500}}class ku{constructor(e){this._renderer=e}get supported(){return ue.webvr}get device(){return this._renderer&&this._renderer.vr.getDevice()?this._renderer.vr.getDevice():null}get isPresenting(){return!(!this._renderer||!this._renderer.vr.getDevice())&&this._renderer.vr.getDevice().isPresenting}hasVRHeadset(){return ue.webvr?navigator.getVRDisplays().then(e=>e.length>0?(this._renderer.vr.setDevice(e[0]),e[0]):null):null}enter(){return this._renderer.vr.getDevice()&&this._renderer.vr.getDevice().requestPresent([{source:this._renderer.domElement}])}exit(){return this._renderer.vr.getDevice()&&this._renderer.vr.getDevice().exitPresent()}}class Cu extends cu{static get displayName(){return"ThreeSixtyEffect"}static get supported(){try{const e=document.createElement("canvas");return!!window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl"))}catch(e){return this._telecine._currentScanner.fire(Vi.SPATIAL_UNSUPPORTED),!1}}static get supportedScanners(){return[As,bc]}set isUserInteracting(e){e!==this._isUserInteracting&&(this._isUserInteracting=e,e?this._options.isMobile||this._telecine.fire(Vi.MOTION_START):this._options.isMobile||this._telecine.fire(Vi.MOTION_END))}get isUserInteracting(){return this._isUserInteracting}constructor(e,t={}){super(e,t),this._activated=!1,this._camera=null,this._scene=null,this._renderer=null,this.isUserInteracting=!1,this._onMouseDownMouseX=0,this._onMouseDownMouseY=0,this._projection=t.projection;const r="halfequirectangular"===this._projection?90:0;this._coordinates={lat:0,long:r},this._previousCoordinates={lat:0,long:r},this._onMouseDownCoordinates={lat:0,long:r},this._previousCameraProps=this.cameraProps,this._phi=0,this._theta=0,this._rotation=0,this._video=this._telecine._currentScanner._video,this._videoRefreshLoop=null,this._gyroVector={x:0,y:0},this._offset={lat:0,long:0},this._writeSpeeds={videoFps:this._options.fps,motionRenderSpeed:60},this._maxTimeBetweenWrites=1e3/this._writeSpeeds.videoFps,this._motionTimeouts=[],this._movingAutomatically=!1,this._deviceMotionHasOccurred=!1,this._updateFromGyroscopePending=!1,this._keysPressed={up:!1,down:!1,left:!1,right:!1}}get currentCoordinates(){return this._coordinates}set currentCoordinates([e,t]){if(e>90||e<-90)throw new RangeError("Latitude should be a float between -90 and 90.");if(t<0||t>360)throw new RangeError("Longitude should be a float between 0 and 360.");this._updateViewpoint(e,t),this._update()}get cameraProps(){return{yaw:this._coordinates.long,pitch:this._coordinates.lat,roll:this.roll,fov:this.fieldOfView}}set cameraProps(e){e=f(f({},this.cameraProps),e),this.fieldOfView=e.fov,this.roll=e.roll,this.currentCoordinates=[e.pitch,e.yaw]}get roll(){return 180*this._rotation/Math.PI}set roll(e){if(e<-180||e>180)throw new RangeError("Roll should be a float between -180 and 180.");this._rotation=THREE.Math.degToRad(e)}get isVRPresenting(){return this._webvr&&this._webvr.isPresenting}get fieldOfView(){return this._camera?this._camera.fov:this._options.fieldOfView}set fieldOfView(e){this._camera.fov=e,this._camera.updateProjectionMatrix(),this._renderer.render(this._scene,this._camera)}static frustumSurfaceArea(e,t,r){const n=2*Lu.SPHERE_RADIUS*2*Math.sin(Math.PI/180*(e/2));return n*(n*t/r)/(4*Math.PI*Math.pow(Lu.SPHERE_RADIUS,2))}activate(){return new Promise(e=>{if(window.THREE)return void e();const t=document.createElement("script");t.src=this._options.threeUrl,document.body.appendChild(t),t.onload=()=>{e()}}).then(()=>this._initialize())}_initialize(){this._activated=!0,this._camera=new THREE.PerspectiveCamera(this._options.fieldOfView,this._video.clientWidth/this._video.clientHeight,1,2*Lu.SPHERE_RADIUS),this._camera.target=new THREE.Vector3(0,0,0),this._camera.layers.enable(1),this._initializeAutoMovement(this._options.directorTimeline),this._scene=new THREE.Scene,this._texture=new THREE.VideoTexture(this._video),this._texture.generateMipmaps=!1,this._texture.minFilter=THREE.NearestFilter,this._texture.maxFilter=THREE.NearestFilter,this._texture.format=THREE.RGBFormat,this._projector=new Lu(this._projection,this._options.stereoMode,this._texture),this._projector.isStereo&&this._scene.add(this._projector.right),this._scene.add(this._projector.left),this._renderer=new THREE.WebGLRenderer,this._renderer.vr.enabled=!0,this._renderer.setPixelRatio(window.devicePixelRatio),this._output=document.createElement("div"),this._renderer.domElement.style.margin="0 auto",this._output.appendChild(this._renderer.domElement),this._element.appendChild(this._output),this._hideOutput(),this._telecine._currentScanner._video.setAttribute("crossorigin","anonymous"),this._startRendering(),this._telecine._currentScanner.paused||this._showOutput(),this._webvr=new ku(this._renderer),this._webvr.supported&&this._webvr.hasVRHeadset().then(e=>{setTimeout(()=>{this._telecine.fire(Vi.WEBVR_HARDWARE_AVAILABLE,this._webvr.device)},100)}).catch(e=>{})}get hasVRHeadset(){return this._webvr&&!!this._webvr.device}toggleVR(){if(this._webvr.isPresenting)this._webvr.exit().then(()=>{this.adjustRenderSize()}).catch(e=>{});else{if(this._telecine._currentScanner.paused)return;this._webvr.enter().then(()=>{this.adjustRenderSize()}).catch(e=>{})}}onplay(){this._activated&&(this._showOutput(),this.adjustRenderSize())}deactivate(){this._output&&this._element.removeChild(this._output),this._stopRendering(),this._activated=!1}snapToCenter(){this._motionTimeouts.forEach(e=>clearTimeout(e));let e=0;"halfequirectangular"===this._projection?e=90:this._coordinates.long>=180&&(e=360);const t=(e-this._coordinates.long)/11,r=(0-this._coordinates.lat)/11;this._rotation=0;for(let e=0;e<50;e++)this._motionTimeouts.push(setTimeout(()=>{0===e&&(this._movingAutomatically=!0,this._options.isMobile||(this._maxTimeBetweenWrites=1e3/this._writeSpeeds.motionRenderSpeed)),49===e&&(this._movingAutomatically=!1,this._options.isMobile||(this._maxTimeBetweenWrites=1e3/this._writeSpeeds.videoFps)),this._updateViewpoint(this._coordinates.lat+r/Math.pow(1.1,e),this._coordinates.long+t/Math.pow(1.1,e)),this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)+this._coordinates.lat+r/Math.pow(1.1,e),this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._coordinates.long+r/Math.pow(1.1,e)},e*this._maxTimeBetweenWrites))}isStereo(){return!!this._projector&&this._projector.isStereo}_initializeAutoMovement(e){e&&e[0]&&void 0!==e[0].p&&"undefined"!==e[0].y&&this._updateViewpoint(e[0].p,e[0].y)}_updateViewpoint(e,t){if(this._previousCoordinates.long=this._coordinates.long,this._previousCoordinates.lat=this._coordinates.lat,e%=360,this._coordinates.lat=Math.max(-85,Math.min(85,e)),"halfequirectangular"===this._projection){const e=0,r=180;this._coordinates.long=Math.max(e,Math.min(r,t))}else t=(t%=360)>=0?t:360+t,this._coordinates.long=t}makeContact(e){this.isUserInteracting=!0,this._motionTimeouts.forEach(e=>clearTimeout(e)),this._movingAutomatically=!1,this._contactPoint={x:e.x,y:e.y},this._onMouseDownCoordinates.long=this._coordinates.long,this._onMouseDownCoordinates.lat=this._coordinates.lat,this._motionStart={long:this._coordinates.long,lat:this._coordinates.lat},this._options.isMobile||(this._maxTimeBetweenWrites=1e3/this._writeSpeeds.motionRenderSpeed)}move(e){this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)+this._previousCoordinates.lat,this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._previousCoordinates.long;const t=this._motionStart.lat-.2*(this._contactPoint.y-e.y),r=.2*(this._contactPoint.x-e.x)+this._motionStart.long;this._updateViewpoint(t,r)}moveWheel(e){this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)+this._previousCoordinates.lat,this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._previousCoordinates.long;const t=this._coordinates.lat-.1*e.y,r=this._coordinates.long+.1*e.x;this._updateViewpoint(t,r)}moveDevice(e,t,r,n){this._updateFromGyroscopePending=!0;const i=new THREE.Quaternion;let s=window.orientation;null===s&&(s=this._video.clientWidth>this._video.clientHeight?90:0),e=e?THREE.Math.degToRad(e):0,t=t?THREE.Math.degToRad(t):0,r=r?THREE.Math.degToRad(r):0;const a=s?THREE.Math.degToRad(s):0,o=new THREE.Vector3(0,0,1),c=new THREE.Euler,u=new THREE.Quaternion,l=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));c.set(t,e,-r,"YXZ"),i.setFromEuler(c),i.multiply(l),i.multiply(u.setFromAxisAngle(o,-a)),this._gyroVector=(new THREE.Euler).setFromQuaternion(i,"YXZ"),this._rotation=this._gyroVector.z,this.isUserInteracting||this._movingAutomatically||this._updateViewpoint(THREE.Math.radToDeg(this._gyroVector.x)-this._offset.lat,-THREE.Math.radToDeg(this._gyroVector.y)+this._offset.long),this._deviceMotionHasOccurred||(this.snapToCenter(),this._telecine.fire(Vi.MOTION_START),this._deviceMotionHasOccurred=!0)}releaseContact(e){if(this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)-this._coordinates.lat,this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._coordinates.long,this.isUserInteracting=!1,this._motionStart&&!e){const e=Math.hypot(this._coordinates.long-this._motionStart.long,this._coordinates.lat-this._motionStart.lat);this._moveDueToMomentum(e)}}abandonMotion(){this.isUserInteracting=!1,this._motionStart=null}keyPress(e){this._options.keyboardDisabled||(this._keyIsDown()||(this.isUserInteracting=!0,this._motionTimeouts&&this._motionTimeouts.forEach(e=>clearTimeout(e))),this._keysPressed[e]||(this._keysPressed[e]=!0))}keyUp(e){this._keysPressed[e]=!1,this._keyIsDown()||(this.isUserInteracting=!1,this._moveDueToMomentum(1/0))}_moveFromKeyPress(){Object.keys(this._keysPressed).forEach(e=>{if(this._keysPressed[e])switch(e){case"up":this._updateViewpoint(this._coordinates.lat+2,this._coordinates.long);break;case"down":this._updateViewpoint(this._coordinates.lat-2,this._coordinates.long);break;case"left":this._updateViewpoint(this._coordinates.lat,this._coordinates.long-2);break;case"right":this._updateViewpoint(this._coordinates.lat,this._coordinates.long+2)}})}_keyIsDown(){return Object.keys(this._keysPressed).map(e=>this._keysPressed[e]).some(e=>e)}_moveDueToMomentum(e){if(e>=20){const t={long:this._coordinates.long-this._previousCoordinates.long,lat:this._coordinates.lat-this._previousCoordinates.lat};e===1/0&&(t.long/=2,t.lat/=2);for(let e=1;e<50;e++)this._motionTimeouts.push(setTimeout(()=>{1===e&&(this._movingAutomatically=!0),49===e&&(this._movingAutomatically=!1,this._maxTimeBetweenWrites=1e3/this._writeSpeeds.videoFps);const r=2/Math.pow(e,1.5);this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)+this._coordinates.lat+t.lat,this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._coordinates.long+t.long,this._updateViewpoint(this._coordinates.lat+t.lat*r,this._coordinates.long+t.long*r)},e*this._maxTimeBetweenWrites))}}onseeked(){this._activated&&this._update()}onresize(){this.adjustRenderSize(),this.isUserInteracting=!1}_update(){if(!this.isVRPresenting){this._phi=THREE.Math.degToRad(90+this._coordinates.lat),this._theta=THREE.Math.degToRad(this._coordinates.long),this._camera.position.set(Math.sin(this._phi)*Math.cos(this._theta),Math.cos(this._phi),Math.sin(this._phi)*Math.sin(this._theta)),this._camera.lookAt(this._camera.target),this._camera.rotation.z+=this._rotation;const e=this.cameraProps;this._telecine.fire(Vi.CAMERA_UPDATE,e),this._previousCameraProps.yaw===e.yaw&&this._previousCameraProps.pitch===e.pitch&&this._previousCameraProps.roll===e.roll&&this._previousCameraProps.fov===e.fov||(this._previousCameraProps=e,this._telecine.fire(Vi.CAMERA_CHANGE,e))}this._renderer.render(this._scene,this._camera)}adjustRenderSize(){if(this.isVRPresenting)this._camera.aspect=this._video.clientWidth/this._video.clientHeight,this._camera.updateProjectionMatrix(),this._renderer.setSize(this._video.clientWidth,this._video.clientHeight);else{this._video.clientWidth>this._video.clientHeight?this._camera.aspect=Math.max(1,Math.min(2,this._video.clientWidth/this._video.clientHeight)):this._camera.aspect=Math.max(1/3,Math.min(3,this._video.clientWidth/this._video.clientHeight)),this._camera.updateProjectionMatrix();const e=zi(this._video.clientWidth,this._video.clientHeight,this._camera.aspect,1);this._renderer.setSize(e.width,e.height),this._output.style.paddingTop=`${e.top}px`}}_startRendering(){this._renderer.setAnimationLoop(()=>{this._keyIsDown()&&this._moveFromKeyPress(),this._update()})}_stopRendering(){this._renderer.setAnimationLoop(null)}_showOutput(){this._styleOutput({backgroundColor:"#000",display:"block"})}_hideOutput(){this._styleOutput({backgroundColor:"#000",display:"none"})}_styleOutput({backgroundColor:e,display:t}={}){this._output.style.cssText=`position:absolute;left:0;top:0;margin-left:auto;margin-right:auto;padding:0;background:${e};width:100%;height:100%;text-align:center;display:${t}`}}class Ou extends cu{static get displayName(){return"AmbisonicEffect"}static get supported(){return void 0!==window.AudioContext}static get supportedScanners(){return[As,bc]}constructor(e,t={}){super(e,t),this.connected=!1,this._context=null,this._source=null,this._mirror=null,this._rotator=null,this._decoder=null}activate(){return this._context=new AudioContext,new Promise((e,t)=>{if("undefined"!=typeof ambisonics)return void e();const r=document.createElement("script");r.src=this._options.ambisonicsUrl,document.body.appendChild(r),r.onload=()=>e(),r.onerror=()=>t()}).then(()=>this.toggleAmbisonics()).catch(()=>{this._telecine._currentScanner.fire(Vi.AMBISONIC_UNSUPPORTED)})}deactivate(){this._disconnect(!0)}toggleAmbisonics(){var e,t;(null!==(e=null==(t=this._telecine.getCurrentStream("audio"))?void 0:t.ambisonic_order)&&void 0!==e?e:0)<1?this._disconnect():this._connect()}_connect(){var e,t;if(!this._context)return;const r=null!==(e=null==(t=this._telecine.getCurrentStream("audio"))?void 0:t.ambisonic_order)&&void 0!==e?e:0;if(this.connected||r<1)return;const n=this._telecine._currentScanner._video;this._source=this._context.createMediaElementSource(n),this._mirror=new ambisonics.sceneMirror(this._context,r),this._rotator=new ambisonics.sceneRotator(this._context,r),this._decoder=new ambisonics.binDecoder(this._context,r),this._source.connect(this._mirror.in),this._mirror.out.connect(this._rotator.in),this._rotator.out.connect(this._decoder.in),this._decoder.out.connect(this._context.destination),this._mirror.mirror(1),this.connected=!0}_disconnect(e=!1){this._source&&this._source.disconnect(),e&&this._context&&(this._context.close(),this._context=null),this._source=null,this._mirror=null,this._rotator=null,this._decoder=null,this.connected=!1}updateRotation(e,t,r){this._rotator&&(this._rotator.yaw!==e||this._rotator.pitch!==t||this._rotator.roll!==r)&&(this._rotator.yaw=e,this._rotator.pitch=t,this._rotator.roll=r,this._rotator.updateRotMtx())}}function Nu(){return import("./hls-js.module.js").then(({default:e})=>e)}const Mu={"application/vnd.apple.mpegurl":"hls","application/vnd.vimeo.dash+json":"dash","video/vnd.mpeg.dash.mpd":"dash","video/mp4":"progressive","video/webm":"progressive","video/x-flv":"progressive","application/x-mpegURL":"hlslive"},xu="pending",Uu="active",Fu="started",Vu="ended",ju="started",Hu="done",Bu="error";var Xu=/\s/,Wu=/^\s+/;var qu=/^[-+]0x[0-9a-f]+$/i,Gu=/^0b[01]+$/i,Ku=/^0o[0-7]+$/i,Yu=parseInt;function $u(e){if("number"==typeof e)return e;if(mt(e))return NaN;if(Tt(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Tt(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=function(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&Xu.test(e.charAt(t)););return t}(e)+1).replace(Wu,""):e}(e);var r=Gu.test(e);return r||Ku.test(e)?Yu(e.slice(2),r?2:8):qu.test(e)?NaN:+e}var zu=1/0;var Qu=ot.isFinite,Ju=Math.min,Zu=function(){var e=Math.round;return function(t,r){if(t=$u(t),(r=null==r?0:Ju(function(e){var t=function(e){return e?(e=$u(e))===zu||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}(e),r=t%1;return t==t?r?t-r:t:0}(r),292))&&Qu(t)){var n=(Qt(t)+"e").split("e");return+((n=(Qt(e(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return e(t)}}();function el(e){return!isNaN(e)}function tl(e){return Zu(e,3)}let rl=0;function nl(e="b"){return`${e}${++rl}`}nl(),nl();const il=nl(),sl=nl(),al=nl(),ol=nl(),cl=nl(),ul=nl(),ll=Symbol("CONFIG_CHANGED"),hl=Symbol("TELECINE_READY"),dl=Symbol("TELECINE_VIDEO_INIT"),fl=Symbol("PLAY_INITIATED"),_l=Symbol("QUALITY_CHANGED"),pl=Symbol("CUE_CHANGED"),vl=Symbol("CAPTIONS_CHANGED"),ml=Symbol("SPATIAL_PLAYBACK_TOGGLED"),gl=Symbol("PICTURE_IN_PICTURE_AVAILABLE_SAFARI"),El=Symbol("HLS_QUALITY_CHANGED"),Tl=Symbol("REQUEST_COMPLETE_LIVE_SUBTITLES"),yl=Symbol("COMPLETE_LIVE_SUBTITLES_LOADED"),Sl=Symbol("COMPLETE_LIVE_SUBTITLES_ERROR");var bl=Object.freeze({__proto__:null,CONFIG_CHANGED:ll,TELECINE_READY:hl,TELECINE_VIDEO_INIT:dl,PLAY_INITIATED:fl,QUALITY_CHANGED:_l,CUE_CHANGED:pl,CAPTIONS_CHANGED:vl,SPATIAL_PLAYBACK_TOGGLED:ml,PICTURE_IN_PICTURE_AVAILABLE_SAFARI:gl,HLS_QUALITY_CHANGED:El,REQUEST_COMPLETE_LIVE_SUBTITLES:Tl,COMPLETE_LIVE_SUBTITLES_LOADED:yl,COMPLETE_LIVE_SUBTITLES_ERROR:Sl});const Al=Symbol("liveeventpending"),Il=Symbol("liveeventactive"),wl=Symbol("liveeventstarting"),Rl=Symbol("liveeventstarted"),Pl=Symbol("liveeventended"),Dl=Symbol("livearchivestarted"),Ll=Symbol("livearchivedone"),kl=Symbol("livearchiveerror"),Cl=Symbol("livesettingsupdated"),Ol=Symbol("lowlatencyfallback"),Nl=Symbol("livestatssuccess"),Ml=Symbol("livestatsfailure");var xl=Object.freeze({__proto__:null,EVENT_PENDING:Al,EVENT_ACTIVE:Il,EVENT_STARTING:wl,EVENT_STARTED:Rl,EVENT_ENDED:Pl,ARCHIVE_STARTED:Dl,ARCHIVE_DONE:Ll,ARCHIVE_ERROR:kl,SETTINGS_UPDATED:Cl,LOW_LATENCY_FALLBACK:Ol,LIVE_STATS_SUCCESS:Nl,LIVE_STATS_FAILURE:Ml});f(f(f(f(f(f(f(f({},Oi),Ui),Fi),xl),Vi),Mi),ji),bl);const Ul=f(f({},Fi),xl);function Fl(e){var t;return(null==e||null==(t=e.archive)?void 0:t.status)===Hu}function Vl(e){return(null==e?void 0:e.status)===xu}function jl(e){return(null==e?void 0:e.status)===Fu}function Hl(e){return(null==e?void 0:e.status)===Vu}function Bl(e,t){var r;const n=null==(r=e.request.files.hls)?void 0:r.default_cdn,{signature:i,timestamp:s,expires:a}=e.request;return`https://${e.player_url}/live/${e.video.id}${t}?signature=${i}&time=${s}&expires=${a}&cdn=${n}`}var Xl=Object.prototype.hasOwnProperty;function Wl(e){if(null==e)return!0;if(on(e)&&(it(e)||"string"==typeof e||"function"==typeof e.splice||jr(e)||Qr(e)||xr(e)))return!e.length;var t=Bn(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(tn(e))return!an(e).length;for(var r in e)if(Xl.call(e,r))return!1;return!0}function ql(e){const t=this;let r={};const n={get attributes(){return Object.assign({},t)},get previousAttributes(){return r},clear(){i();var e=t.attributes;for(var r in e)delete t[r]},set(e){for(var r in i(),e=ci(e))t[r]=e[r]},clone:()=>new ql(t.attributes),toJSON:()=>ci(t.attributes)};function i(){Wl(t.attributes)||(r=ci(t.attributes))}return n.set(e),T(t,n)}function Gl(e,t){const r=new ql(ki(e,t));let n=!1;return y(r,{reset:function(e){return r.clear(),function(e){n=!0,r.set(e),ki(r,t)}(e),r},isNewVideo:function(){const e=r.previousAttributes;return!n||e.video.id!==r.video.id||e.video.version.current!==r.video.version.current||!!e.video.live_event&&!Fl(e.video.live_event)&&(!r.video.live_event||Fl(r.video.live_event))}})}function Kl(e,t,r){return void 0===r&&(r=t,t=void 0),void 0!==r&&(r=(r=$u(r))==r?r:0),void 0!==t&&(t=(t=$u(t))==t?t:0),function(e,t,r){return e==e&&(void 0!==r&&(e=e<=r?e:r),void 0!==t&&(e=e>=t?e:t)),e}($u(e),t,r)}function Yl(e=[],t=null,r=null){if(!t&&!r)return e;if(!e.length)return e;if(t===r&&-1!==e.indexOf(t))return[t];const n=parseFloat(t),i=parseFloat(r);if(n&&i&&i<n)return e;const s=e.filter(e=>{const t=parseFloat(e);return!(n&&t<n||i&&t>i)});return s.length?s:e}function $l(e=[],t=null){const r=Yl(e,t,t);return 1===r.length?r[0]:null}function zl(e){return e.quality||e.metadata.quality}function Ql(e,t,r=!1){return r?Jl(e,t):function(e,t){e.embed.settings.audio_tracks||(t=null);const r=e.request.files,n=nh(r),i=uh(e),s=e.request.cookie.quality||i||function(e){const t=nh(e.request.files);let r=t.some(oh);ue.mobileAndroid&&(r=!1);let n="720p";if(r){const e=t.map(zl);-1!==e.indexOf("1080p")&&-1===e.indexOf("720p")&&(n="1080p")}return e.request.cookie.hd||e.video.default_to_hd?n:"360p"}(e);let a=function({files:e=[],preference:t="360p",priorityOffset:r=0}){(e=Array.from(e)).sort(lh());const n=e.map(zl);if(t){-1===n.indexOf(t)&&(n.push(t),n.sort((e,t)=>ch(t)-ch(e)));const e=n.indexOf(t),r=n.splice(0,e);r.reverse(),n.push.apply(n,p(r))}return e.map(e=>({id:e.id,src:e.url,mime:e.mime,priority:n.indexOf(e.quality)+1+r,metadata:{profile:e.profile,cdn:e.cdn,origin:e.origin,quality:e.quality,fps:e.fps}}))}({files:n,preference:s,priorityOffset:3});return r.hls&&(a=a.concat(th(e,!1,t)),e.request.drm&&ue.browser.webKit)||r.dash&&(a=a.concat(rh(e,!1,t))),a}(e,t)}function Jl(e,t){const r=e.request.files;let n=[];const i=e.request.drm&&ue.browser.webKit;return(r.hls&&(ue.iPhone||ue.iPad)||i)&&(n=n.concat(th(e,!0,t))),r.dash&&!i&&(n=n.concat(rh(e,!0,t))),n}function Zl(e,t=!1,r=!1){let n=e.url;if("avc_url"in e&&(n=e.avc_url),t)return n;const i=ue.dolbyVision,s=ue.hdr&&ue.hevc,a=ue.hevc;return r||(i&&"hevc_dvh1_url"in e?n=e.hevc_dvh1_url:s&&"hevc_hdr_url"in e?n=e.hevc_hdr_url:a&&"hevc_sdr_url"in e&&(n=e.hevc_sdr_url)),ue.av1&&"av1_url"in e&&(n=e.av1_url),n}function eh(e){return e.fallback_url}function th(e,t=!1,r=null){var n;const i=e.request.files,s=i.hls.default_cdn,a=e.request.drm,o=i.hls.cdns[s],c=(null==o||null==(n=o.alternatives)?void 0:n[r])||o,u=t?eh(c):Zl(c,a);return{id:`hls-${s}-${e.video.id}`,src:u,mime:b.hls,priority:3,metadata:{cdn:s,origin:i.hls.cdns[s].origin,quality:"sd"}}}function rh(e,t=!1,r=null){const n=e.request.files;return Wl(n.dash)?[]:Object.keys(n.dash.cdns).map(i=>{var s;const a=n.dash.cdns[i],o=(null==a||null==(s=a.alternatives)?void 0:s[r])||a,c=(ue.browser.chrome||ue.browser.firefox)&&e.request.drm,u=t?eh(o):Zl(o,!1,c);return{id:`dash-${i}-${e.video.id}`,src:u,mime:e.request.drm?b.dashMpd:b.dash,priority:i===n.dash.default_cdn?1:2,metadata:{cdn:i,origin:n.dash.cdns[i].origin,quality:"sd"}}})}function nh(e){if(Wl(e.progressive))return[];let t=e.progressive;return"progressive_avc"in e&&(t=e.progressive_avc),t.filter(sh(t))}function ih(e){if("number"==typeof e)return e;const t=e.split("-");return 5===t.length?t[0]:parseInt(t[0],10)}function sh(e){const t=e.filter(ah).map(zl);return e=>-1===t.indexOf(zl(e))||ah(e)}function ah(e){let t=e.fps;return"metadata"in e&&(t=e.metadata.fps),t>30}function oh(e){return ch(e)>=720}function ch(e){return"string"!=typeof e&&(e=zl(e)),parseInt(e,10)}function uh(e){const t=nh(e.request.files).map(e=>e.quality);return e.embed.on_site?null:$l(t,e.embed.quality)}function lh(e="desc"){return(t,r)=>{const n=ch(t),i=hh(t),s=ch(r),a=hh(r);return"asc"===e?n-s||i-a:s-n||a-i}}function hh(e){return"object"!=typeof e?0:"fps"in e?e.fps:"metadata"in e&&"fps"in e.metadata?e.metadata.fps:0}function dh(e){const t=e.video.live_event,r=e.request.files;if(!Wl(r.hls)){var n,i;const s=r.hls.default_cdn,a=r.hls.cdns[s].hevc_url||(null==t||null==(n=t.playback_urls)||null==(n=n[s])||null==(n=n.codecs)||null==(n=n.hevc)?void 0:n.hls_noredirect),o=!!a&&ue.hevc,c=o?a:r.hls.cdns[s].json_url||function(e,t){var r,n;const i=t?"hevc":"avc",s=e.dvr,a=e.low_latency;var o,c;return s?null==(o=e.playback_urls)||null==(o=o["akamai-fmp4"])||null==(o=o.codecs)||null==(o=o[i])?void 0:o.hls_noredirect:a?null==(c=e.playback_urls)||null==(c=c["akamai-low-latency"])||null==(c=c.codecs)||null==(c=c[i])?void 0:c.hls_noredirect:null!=(r=e.playback)&&null!=(r=r.codecs)&&null!=(r=r[i])&&r.hls_noredirect?e.playback.codecs[i].hls_noredirect:null==(n=e.playback)?void 0:n.hls_noredirect}(t,o),u=null!=(i=e.request.flags)&&i.live_dash?2:1;return{id:`hls-${s}-${e.video.id}`,src:c,mime:b.hlsLive,priority:u,metadata:{cdn:s,origin:r.hls.cdns[s].origin,quality:"sd",codec:o?"hevc":"avc"}}}return null}function fh(e,t){let r=[];if(t.video){const i=t.video.currentFile.mime;if(i===b.hlsLive)return t.manifest.video.map(e=>f(f({},e),{},{quality:`${e.height}p`}));if([b.dash,b.dashMpd].includes(i)){var n;const i=!!t.video.drmHandler,s=i&&"sd-fallback"===t.video.drmHandler.state;r=function(e,t=!1){if(!e)return[];let r=e.streams;"streams_avc"in e&&(r=e.streams_avc);const n=ue.dolbyVision,i=ue.hevc&&ue.hdr,s=ue.hevc;return n&&"streams_hevc_dvh1"in e?r=e.streams_hevc_dvh1:i&&"streams_hevc_hdr"in e?r=e.streams_hevc_hdr:s&&"streams_hevc_sdr"in e?r=e.streams_hevc_sdr:ue.av1&&"streams_av1"in e&&(r=e.streams_av1),t&&"streams_fallback"in e&&(r=e.streams_fallback),r}(e.request.files.dash,s),!i&&null!=t&&null!=(n=t.currentScanner)&&n.manifestLoaded&&(r=function(e,t){const r=t.map(e=>e.id);return e.filter(e=>{const t=ih(e.id);return r.includes(e.id)||r.includes(t)})}(r,t.currentScanner.videoStreams))}else r=t.video.files.filter(e=>"progressive"===Mu[e.mime])}return r.filter(sh(r)).sort(lh())}function _h(e){let t=zl(e);const r={"1440p":"2K","2160p":"4K","2700p":"5K","3240p":"6K","3780p":"7K","4320p":"8K"};for(const e in r)t=t.replace(e,r[e]);return t}function ph(e){return ue.spatialPlayback&&e.video.spatial?35:75}function vh(e){return e.request.text_tracks.map(e=>({id:e.id,src:e.url,kind:e.kind,label:e.label,language:e.lang,provenance:e.provenance}))}let mh={captureException(e){},captureMessage(e){},captureBreadcrumb(){}},gh=mh;var Eh={set:function(e){gh=Object.assign({},mh,e)},captureException:function(e,t){return gh.captureException(e,t)},captureMessage:function(e,t){return gh.captureMessage(e,t)},captureBreadcrumb:function(e,t,r="backbone",n="info"){return gh.captureBreadcrumb(e,t,r,n)}};function Th(e,t,r){let n=!1,i=!1,s=!1,a=!0,o="auto";function c(e){if(!a&&r.buffered&&r.buffered.length>0){e=e||r.currentTime;const i=function(e,t){var r=e.length-1;if(e.length>1)for(var n=0,i=e.length;n<i;n++)if(e.start(n)<=t&&e.end(n)>=t){r=n;break}return r}(r.buffered,e),a=r.buffered.end(i),o=a/r.duration,c=r.duration;if(t.fire(Oi.PROGRESS,{loaded:a,duration:c,loadProgress:o}),s&&n&&a===r.duration)return void(n&&r.paused&&r.play().catch(Eh.captureException))}}function u(t=[]){const n=fh(e,r).reverse().map(e=>e.quality),i=t.filter(e=>-1!==n.indexOf(e)).sort((e,t)=>n.indexOf(e)-n.indexOf(t));return i.map(e=>n.indexOf(e))}function l(e=[],t=null){if(e.includes("auto"))r.video.currentFile.restrictedStreamIndexes=[];else{const t=u(e);t.length&&(Eh.captureBreadcrumb(`Switched to ${e[0]}`,{},"video"),r.video.currentFile.restrictedStreamIndexes=t)}if(t){const e=u([t]),n=e.length?e[0]:null;r._currentScanner.preloadStreamIndex=n}else r._currentScanner.preloadStreamIndex=null}function h(){if(e.embed.on_site)return;const t=fh(e,r).map(e=>e.quality),n=Yl(t,e.embed.quality||e.embed.min_quality,e.embed.quality||e.embed.max_quality),i=$l(t,e.embed.initial_quality);l(n.length&&n.length!==t.length?n:["auto"],i)}return t.on(dl,function(){var t;r.playsinline=e.embed.playsinline,r.muted=e.embed.muted,r.lowLatencyMode=null==(t=e.video.live_event)?void 0:t.low_latency,r.disableRemotePlayback=!e.embed.settings.airplay&&!e.embed.settings.chromecast}),t.on(sl,function(){a=!0,r.paused||r.pause(),i=!1,n=!1,r.currentTime=0}),t.on(al,function(){r.paused||r.pause(),r.video=null}),r.on(Oi.PLAY,function(){a=!1,t.fire(Oi.PLAY,r.currentTime)}),r.on(Oi.PAUSE,function(){n=!1,t.fire(Oi.PAUSE,r.currentTime,r.ended)}),r.on(Oi.PLAYING,function(e){c()}),r.on(Oi.TIME_UPDATE,function(){if(a)return;const{currentTime:e,liveEdgeTime:n,atLiveEdge:i,liveTailTime:s,atLiveTail:o,duration:c,playbackRate:u}=r,l=e/c;t.fire(Oi.TIME_UPDATE,{currentTime:e,liveEdgeTime:n,atLiveEdge:i,liveTailTime:s,atLiveTail:o,duration:c,playbackRate:u,timeProgress:l})}),r.on(Oi.ENDED,function(e){r.loop?r.play().catch(Eh.captureException):(n=!1,t.fire(Oi.ENDED,e))}),r.on(Oi.LOADED_METADATA,function(t){const n=r.duration;if(isFinite(n)&&n>0){if(n<e.video.duration-1||n>e.video.duration+1)return;e.video.duration=n}e.video.video_width=r.videoWidth,e.video.video_height=r.videoHeight}),r.on(Oi.DURATION_CHANGE,function(t){const n=r.duration;isFinite(n)&&(e.video.duration>0&&(n<e.video.duration-1||n>e.video.duration+1)||(e.video.duration=n))}),r.on(Oi.PROGRESS,c),r.on(Ui.BUFFER_STARTED,()=>{s=!0}),r.on(Ui.BUFFER_ENDED,()=>{s=!1}),t.on(il,function(t){r.isLive()&&0===r.liveEdgeTime||(t=Kl(t,tl(r.isLive()?r.liveTailTime:0),tl(r.isLive()?r.liveEdgeTime:r.duration||e.video.duration)),r.currentTime=t)}),r.on(Oi.SEEKING,function(){const e=r.currentTime,n=r.duration,i=e/n;t.fire(Oi.SEEKING,{currentTime:e,duration:n,timeProgress:i})}),r.on(Oi.SEEKED,function(){c();const e=r.currentTime,n=r.duration,i=e/n;t.fire(Oi.SEEKED,{currentTime:e,duration:n,timeProgress:i})}),r.on(Ui.CURRENT_FILE_CHANGE,function(t){Eh.captureBreadcrumb("Current file changed",{id:t.id,mime:t.mime,src:t.src,metadata:t.metadata},"video"),[b.dash,b.dashMpd].includes(t.mime)&&h(),[b.hlsLive].includes(t.mime)?r.once(Ui.STREAMS_LOADED,()=>{h()}):uh(e)}),r.on(Oi.RESIZE,function(){r.video.currentFile.mime===b.hls&&r.videoHeight&&t.fire(El,{height:r.videoHeight})}),{play:function(){return n=!0,i||(t.fire(fl),i=!0),r.play()},pause:function(){n=!1,r.pause()},get quality(){return o},set quality(n){!function(n){const i=r.video.currentFile.mime;if([b.dash,b.dashMpd,b.hlsLive].includes(i))l([n]);else{const t=fh(e,r).filter(e=>e.metadata.quality===n);t.length>0&&(a=!0,r.video.currentFile=t[0])}o=n,t.fire(_l,n)}(n)}}}function yh(e,t,r){let n=null;ue.spatialPlayback&&(t.on(dl,function(){n&&(r.deactivateEffect(Cu),n=null,t.fire(ml,n));const i=e.video.spatial;i&&(e.request.drm||r.supportsEffect(Cu)&&(n=r.activateEffect(Cu,{threeUrl:e.request.urls.three_js,fps:e.video.fps,fieldOfView:i.fov,directorTimeline:i.director_timeline,projection:i.projection,stereoMode:i.stereo_mode,initialView:i.initial_view,isMobile:ue.android,dimensions:e.embed.on_site?{width:1080,height:540}:{width:640,height:360},keyboardDisabled:!e.embed.keyboard}),t.fire(ml,n)))}),r.on(Vi.SPATIAL_UNSUPPORTED,function(){n&&(r.deactivateEffect(Cu),n=null,t.fire(ml,n))}))}function Sh(e,t,r){let n=null;t.on(dl,function(){n&&(r.deactivateEffect(Ru),n=null),e.video.canvas&&(e.request.drm||r.supportsEffect(Ru)&&(n=r.activateEffect(Ru)))})}var bh=Di(function(e,t,r){Ri(e,t,r)});function Ah(e,t,r){return r?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}const Ih=5e3;function wh(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}function Rh(e,t,r){if(r)return t?t(e()):e();try{var n=Promise.resolve(e());return t?n.then(t):n}catch(e){return Promise.reject(e)}}class Ph extends Ir{constructor(e,t,r,n){super(),this._liveEventHasID=ve(),this._liveEvent=ci(e),this._sessionUrl=e.session_url||e.sessionUrl,this._subtitleUrl=e.subtitleUrl,this._sessionRefreshUrl=t,this._subtitleRefreshUrl=n,this._appPollUrl=r,this._forcedPoll=!1,this._disabled=!1,this._dvrEnabled=e.dvr,this._setupPolling()}requestCompleteLiveSubtitles(){const e=this;return Rh(function(){return Ah(wh(function(){return Ah(Ye({url:e._subtitleUrl,retry:3,retryStatus:e=>[410].includes(e)||t.retryStatus(e),hooks:{beforeRetry:[e._beforeSubtitleRetry.bind(e)]}}).json(),function(e){if(null==e||!e.url)throw new Error("No webvtt url was available to fetch");return Ah(Ye(e.url).text(),Oc)})},function(e){throw e}))})}_beforeSubtitleRetry(e){const t=this;return Rh(function(){return Ah(t._refreshSubtitleUrl(),function(t){e.url=t})})}_refreshSubtitleUrl(){const e=this;return Rh(function(){return Ah(Ye(e._subtitleRefreshUrl).json(),function(t){return e._subtitleUrl=t.url,t.url})})}disable(){this._disabled=!0}forcePolling(){this.isForcePolling||(this._forcedPoll=!0,this._setupPolling())}unforcePolling(){this._forcedPoll=!1}get isForcePolling(){return this._forcedPoll}get liveEventIDReady(){return this._liveEventHasID}_setupPolling(){!1!==this._liveEvent.polling&&(this._liveEvent.id&&this._liveEventHasID.resolve(),this._shouldPollApp()?this._pollApp():this._shouldPoll()&&this._pollLiveApi())}_shouldPoll(){var e;return!(Hl(this._liveEvent)&&(null==(e=this._liveEvent.archive)?void 0:e.status)!==ju||!this.isForcePolling&&jl(this._liveEvent))}_shouldPollApp(){return!this._sessionUrl||!(!Vl(this._liveEvent)||null!==this._liveEvent.id)}_refreshSessionUrl(){const e=this;return Rh(function(){return Ah(Ye(e._sessionRefreshUrl).json(),function(t){return e._sessionUrl=t.url,t.url})})}_pollLiveApi(){const e=this;return Rh(function(){if(e._disabled)return Ah();let r,n={};return ue.browser.ie&&(n={Pragma:"no-cache","Cache-Control":"no-cache"}),Ah(function(e,t){return e&&e.then?e.then(t):t()}(wh(function(){return Ah(Ye({url:e._sessionUrl,retry:3,retryStatus:e=>[410].includes(e)||t.retryStatus(e),hooks:{beforeRetry:[e._beforeRetry.bind(e)]},headers:n}).json(),function(e){r=e})},function(){throw new Error(`Hit max retries polling ${e._sessionUrl}`)}),function(t){if(e._dvrEnabled&&(r.dvr=e._dvrEnabled),r.status!==e._liveEvent.status){if(Hl(r)&&"provision_expire"===r.terminate_reason)return e._sessionUrl=null,e._liveEvent.id=null,void setTimeout(e._setupPolling.bind(e),Ih);const t={[Uu]:Ul.EVENT_ACTIVE,[xu]:Ul.EVENT_PENDING,[Fu]:Ul.EVENT_STARTED,[Vu]:Ul.EVENT_ENDED}[r.status];try{e.fire(t,r)}catch(e){throw new Error(`Error firing live event status change ${e}`)}}if(r.archive&&(!e._liveEvent.archive||r.archive.status!==e._liveEvent.archive.status)){const t={[ju]:Ul.ARCHIVE_STARTED,[Hu]:Ul.ARCHIVE_DONE,[Bu]:Ul.ARCHIVE_ERROR}[r.archive.status];e.fire(t,r)}e._liveEvent=bh(e._liveEvent,r),e._shouldPoll()&&setTimeout(e._pollLiveApi.bind(e),Ih)}))})}_beforeRetry(e){const t=this;return Rh(function(){return Ah(t._refreshSessionUrl(),function(t){e.url=t})})}_pollApp(){const e=this;return Rh(function(){return e._disabled?Ah():Ah(Ye(e._appPollUrl).json(),function(t){let r=!1;return function(n,i){var s=function(){if(null!==t.ingest.session_id)return e._liveEventHasID.resolve(),e._liveEvent.id=t.ingest.session_id,Ah(e._refreshSessionUrl(),function(){e._pollLiveApi(),r=!0})}();return s&&s.then?s.then(i):i(s)}(0,function(t){if(r)return t;setTimeout(e._pollApp.bind(e),Ih)})})})}}function Dh(){}function Lh(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}function kh(e,t,r){const n=Lh(function(){return function(e){return e&&e.then?e.then(Dh):Promise.resolve()}({hive:()=>{},kollective:()=>{}}[e.video.ecdn.ecdn_provider]())});let i,s,a,o=!1,c=0,u=0;function l(){s&&(s.disable(),s=null)}function h(){r.endLive()}return t.on(ll,function(){i&&!e.isNewVideo()||(i=!0,l(),e.video.live_event&&!Fl(e.video.live_event)&&(function(r){s=new Ph(r,function(e){return Bl(e,"/session/refresh")}(e),function(e){return`https://${e.vimeo_url}/live_event/status?clip_id=${e.video.id}`}(e),function(e){return Bl(e,"/subtitle/refresh")}(e)),s.on(Ul.EVENT_ENDED,h),Object.keys(Ul).forEach(e=>{const r=Ul[e];s.on(r,e=>{t.fire(r,e)})}),t.on(Tl,Lh(function(){return function(e){if(e&&e.then)return e.then(Dh)}(function(e,r){try{var n=function(){var e;return function(e,t){return void 0?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}(null==(e=s)?void 0:e.requestCompleteLiveSubtitles(),function(e){t.fire(yl,e)})}()}catch(e){return r()}return n&&n.then?n.then(void 0,r):n}(0,function(e){t.fire(Sl)}))}))}(e.video.live_event),function(){c=0,u=0;let e=!1;r.once(Oi.PLAYING,()=>e=!0);let n=Ee();clearInterval(a),a=setInterval(()=>{r.paused||(c+=Se(n)/1e3),e&&o&&(u+=Se(n)/1e3),function(e){if(r.lowLatencyMode&&e>12&&r.latency>10&&o){const e="Rebuffer ratio > 12% and latency > 10s, fallback to normal HLS w/ target latency of 12s.";t.fire(Ul.LOW_LATENCY_FALLBACK,{msg:e}),r.lowLatencyMode=!1,r.presentationDelay=12,r.bufferTarget=12}}(u/c*100),n=Ee()},500)}()),e.video.ecdn&&n())}),t.on(al,function(){l()}),r.on(Ul.STREAM_ONLINE,function(){s.isForcePolling&&s.unforcePolling()}),r.on(Ul.STREAM_OFFLINE,function(){s.isForcePolling||s.forcePolling()}),r.on(Ui.BUFFER_STARTED,function(){o=!0}),r.on(Ui.BUFFER_ENDED,function(){o=!1}),{get p2pReady(){}}}function Ch(e,t,r){if(r)return t?t(e()):e();try{var n=Promise.resolve(e());return t?n.then(t):n}catch(e){return Promise.reject(e)}}function Oh(e,t){var r=e();return r&&r.then?r.then(t):t(r)}function Nh(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}function Mh(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}function xh(e,t,r){var n;const i=Mh(function(){return Nh(function(){return Ch(v,function(t){return t(r,e)})},function(e){throw Eh.captureException(e),new Error("Failed to create Hive Module",e)})}),s=Mh(function(){return Nh(function(){return Ch(p,function(e){return e(r)})},function(e){return Eh.captureException(e),null})}),a=function(){return function(e){return e&&e.then||(e=Promise.resolve(e)),e}(Oh(function(){if(!c)return Ch(s,function(e){c=e})},function(){var t;return null==(t=c)?void 0:t.setUp(e)}))},o=Mh(function(){return Nh(function(){return Oh(function(){if(!u)return Ch(i,function(e){u=e})},function(){var e;return null==(e=u)?void 0:e.setUp(h)})},function(e){var t;return null==(t=u)||t.stop(),null})});let c,u,l=!1,h=!1,d=!1;const f=null==(n=e.video.ecdn)?void 0:n.ecdn_provider;let _;function p(){return import("./kollective.module.js").then(({default:e})=>e)}function v(){return import("./hive.module.js").then(({default:e})=>e)}function m(){try{c&&(c.destroy(),c=null),u&&(u.destroy(),u=null)}catch(e){}}return t.on(ll,function(){var t;e.isNewVideo()&&(l=!1),!0!==e.preload||!1!==d||"kollective"!==f?l||((null==(t=e.video.live_event)?void 0:t.status)!==xu?(l=!0,m(),f&&(_={hive:o,kollective:a}[f]())):h=!0):d=!0}),t.on(al,m),{get p2pReady(){return _}}}function Uh(e,t,r){let n=null;function i(){r.deactivateEffect(Ou),n=null}t.on(fl,function(){var t;n&&i(),(null==(t=e.video.channel_layout)?void 0:t.startsWith("ambisonic"))&&r.supportsEffect(Ou)&&(n=r.activateEffect(Ou,{ambisonicsUrl:e.request.urls.ambisonics_js}))}),r.on(Vi.CAMERA_UPDATE,function({yaw:e,pitch:t,roll:r}){n&&n.updateRotation(e,t,r)}),r.on(Vi.AMBISONIC_UNSUPPORTED,function(){n&&i()}),r.on(Ui.STREAM_CHANGE,function(){n&&n.toggleAmbisonics()})}function Fh(e,t=[]){if(!e||"null"===e||0===t.length)return{track:null};const[r,n]=e.split("."),[i]=r.split(/[-_]/),s=r!==i,a=t.filter(e=>s&&e.language===r||e.language===i).sort((e,t)=>{const s=2*(e.language===i&&e.kind===n)+2*(e.language===r)+1*(e.kind===n);return 2*(t.language===i&&t.kind===n)+2*(t.language===r)+1*(t.kind===n)-s});return a.length>0?{track:a[0],exactMatch:a[0].language===r&&a[0].kind===n}:{track:null}}function Vh(e){const t=e.split(/\n/g);let r=[],n=[];return t.forEach(e=>{let t=e.match(/<[a-zA-Z]+ ?.*?>/g)||[],i=e.match(/<\/[a-zA-Z]+ ?.*?>/g)||[];const s=n.map(({startTag:e})=>e);n=[],t=s.concat(t),t.forEach(e=>{let[t]=e.replace(/<|>/g,"").split(" ");const r=i.indexOf(`</${t}>`);-1!==r?i.splice(r,1):n.push({startTag:e,closeTag:`</${t}>`})});const a=n.map(({closeTag:e})=>e).reverse().join(""),o=`${s.join("")}${e}${a}`;r.push(o)}),r.join("<br>")}function jh(e){return e?e.split(/\n/g).join(""):e}function Hh(e,t){let r;function n(){return t.pictureInPictureActive||I(t.videoElement)?"showing":"hidden"}function i(){if(0!==t.video.textTracks.length){if(t.video.textTracks.forEach(e=>{e.on("cuechange",s),e.on("modechange",a)}),t.video.textTracks.language){const[r]=t.video.textTracks.language.split(/[-_]/),[n]=t.video.textTracks.language.split(/[-_]/);if(r!==n){const r=`${t.video.textTracks.language}.subtitles`,{track:n}=Fh(r,t.video.textTracks);if(n)return void e.fire(ol,r)}}e.fire(cl)}else e.fire(cl)}function s(t){const r=t.target,n=r.activeCues||[],i=[];let s;for(var a=0,o=n.length;a<o;a++)""!==n[a].text.replace(/^\s+|\s+$/gm,"")&&(s=document.createElement("span"),s.appendChild(n[a].getCueAsHTML()),i.push({html:Vh(s.innerHTML),text:jh(n[a].text)}));e.fire(pl,r,i)}function a(r){const n=r.target;I(t.videoElement)&&"showing"===n.mode&&e.fire(vl,n)}e.on(dl,i),e.on(ol,function(i){if(r&&r.id===i)return;let s=t.video.textTracks.getTrackById(i),a=!0;s||({track:s,exactMatch:a}=Fh(i,t.video.textTracks)),s!==r&&setTimeout(()=>{t.video&&t.video.textTracks.forEach(e=>{e.mode=e===s?n():"disabled"}),e.fire(vl,s,!a),r=s},0)}),e.on(cl,function(){setTimeout(()=>{t.video&&t.video.textTracks&&t.video.textTracks.forEach(e=>{e.mode="disabled"}),e.fire(pl),r&&(r=null,e.fire(vl,null))},0)}),e.on(Ui.TEXT_TRACKS_AVAILABLE,i),e.on([Oi.ENTER_PICTURE_IN_PICTURE,Oi.LEAVE_PICTURE_IN_PICTURE],function(){!function(e){r&&r.mode!==e&&(r.mode=e)}(n())})}const Bh="main";function Xh(e,t){return Array.from(e).map(e=>f(f({},e),{},{enabled:e.id===t}))}function Wh(e){return Array.from(e).find(e=>e.enabled)}function qh(e=[]){return Array.from(e).find(e=>e.kind===Bh)}function Gh(e){return e.split("-")[0]}function Kh(e,t,r,n){const i=t.toLowerCase();return e.find(e=>{const t=n?Gh(e.language).toLowerCase():e.language.toLowerCase(),s=n?t===Gh(i):t===i,a=!r||r===e.kind;return s&&a})}function Yh(e,t={},r=!1){var n,i,s;if(null==e||!e.length)return null;const a=null==(n=t=function(e={}){var t;let{language:r="",kind:n=""}=e;if(!r)return e;let i=r.split(/[.,]/);return r=i[0].trim(),n=n||(null==(t=i[1])?void 0:t.trim())||"",f(f({},e),{},{language:r,kind:n})}(t))?void 0:n.id,o=null==(i=t)?void 0:i.language,c=null==(s=t)?void 0:s.kind;if(o===Bh||c===Bh)return qh(e);if(a){const t=e.find(e=>e.id===a);if(t)return t}if(c&&o){const t=Kh(e,o,c,!1)||Kh(e,o,c,!0);if(t)return t}if(o&&!r){const t=Kh(e,o,void 0,!1)||Kh(e,o,void 0,!0);if(t)return t}return qh(e)}function $h(e,t){let r="translation";return"1"===e.id?r="main":e.label.includes("(Audio description)")?r="descriptions":e.label.includes("(Commentary)")&&(r="commentary"),e.language===t.language&&r===t.kind}function zh({audioTracks:e,config:t}){var r,n,i,s;if(null==e||!e.length)return null;const a=null==(r=t.embed)?void 0:r.audio_track,o=null==(n=t.request)||null==(n=n.cookie)?void 0:n.audio_language,c=null==(i=t.request)||null==(i=i.cookie)?void 0:i.audio_kind,u=null==(s=t.request)?void 0:s.lang;if(a){const t=Yh(e,{language:a});if(t)return t}if(o||c){const t=Yh(e,{language:o,kind:c||"translation"},!0);if(t)return t}if(u){const t=Yh(e,{language:u,kind:"translation"},!0);if(t)return t}return qh(e)||null}function Qh(e,t,r,n=[]){let i,s,a,o,c,u;function l(){var t;const r=e.video.live_event,n=null==r?void 0:r.dvr;if(Vl(r)||function(e){return(null==e?void 0:e.status)===Uu}(r)||Hl(r)&&!Fl(r))return void(i.video=null);if(jl(r)&&i.video&&!e.isNewVideo())return;let s=e.request.audio_tracks||[];const a=zh({audioTracks:s,config:e}),o=null==a?void 0:a.id;s=Xh(s,o);const u="sd-fallback"===(null==(t=i.video)||null==(t=t.drmHandler)?void 0:t.state),l=jl(r)?function(e){const t=[],r=dh(e);r&&t.push(r);const n=function(e){var t,r;const n=e.video.live_event,i=e.request.files;if(Wl(i.dash))return null;const s=i.dash.default_cdn,a=i.dash.cdns[s].url||(null==(t=n.playback)?void 0:t.dash_noredirect),o=null!=(r=e.request.flags)&&r.live_dash?2:1;return{id:`dash-${s}-${e.video.id}`,src:a,mime:b.dashMpd,priority:o,metadata:{cdn:s,origin:i.dash.cdns[s].origin,quality:"sd"}}}(e);return n&&t.push(n),t}(e):Ql(e,o,u),f=vh(e);var _;if(i.video&&!e.isNewVideo()&&!c&&(!n||Fl(r)))return null==(_=i.video.drmHandler)||_.updateLAUrls(e.request.drm),void h(l,f);d({files:l,textTracks:f,audioTracks:s,switchingVideo:n,startTime:n&&i.currentTime})}function h(e,t){e.forEach(e=>{const t=i.video.files.getFileById(e.id);t&&t.src!==e.src&&(t.src=e.src)}),t.forEach(e=>{const t=i.video.textTracks.getTrackById(e.id);t&&t.src!==e.src&&(t.src=e.src)})}function d({files:n,textTracks:s,audioTracks:c=[],switchingVideo:l=!1,startTime:h}){var d,f,_,p,v,m;const g=e.video.live_event,E=r.getBoundingClientRect(),T=jl(g)?dh(e):function(e){const t=e.request.files;if(!Wl(t.hls)){const e=t.hls.default_cdn,r=t.hls.cdns[e],n=r.captions||r.url;return n?{src:n,mime:b.hls,metadata:{cdn:e,origin:r.origin,quality:"sd"}}:null}return null}(e);var y;u||(u=(null==(y=i.played)?void 0:y.length)>0);const S=!i.paused||(null==(d=i._rebufferMonitor)?void 0:d._isBuffering);i._switchingVideo=l,i.video={id:e.video.id,title:e.video.title,subtitle:`from ${e.video.owner.name}`,files:n,textTracks:s,audioTracks:c,chapters:tr(e,"embed.chapters",[]),duration:e.video.duration,externalDisplayFiles:{AirPlay:T},metadata:{playlistRefreshUrl:Bl(e,`/playlist/refresh/${null==T?void 0:T.metadata.codec}`),useHls:e.request.drm&&ue.browser.webKit,drm:e.request.drm,drmLaUrlParams:e.request.drm&&{atid:e.request.atid,leadUUID:null==(f=e.user.lead)?void 0:f.id,playbackRoute:null!=(_=e.request.flags)&&_.ott?"player_embed_ott":"player_embed",playerLocation:e.embed.on_site?"onsite":"embed",dnt:null!==(p=null==(v=e.request.flags)?void 0:v.dnt)&&void 0!==p?p:e.embed.dnt,embedContext:e.embed.context,referrer:e.request.referrer},p2pReady:e.video.ecdn&&(null!==(m=a.p2pReady)&&void 0!==m?m:o.p2pReady),percentShown:Cu.frustumSurfaceArea(e.video.spatial.fov,E.width,E.height)}},l?i.checkRebuffer(u,S):t.fire(dl),"number"==typeof h&&(i.currentTime=h),i.updateBufferTarget()}return function(){var t,n,s,a,o,c,u;const l=window.Hls,h=[bc,Wc,ou,As];l&&h.splice(h.indexOf(Wc),0,su);const d=e.video.ecdn&&!(null!=(t=e.request.flags)&&t.ecdn_delta_updates);i=new wu(r,h,{externalDisplays:[AirPlayExternalDisplay],mediaSourceScanner:{droppedFrameSwitchPercent:ph(e)},tests:e.request.ab_tests,fileCodecs:e.request.file_codecs,presentationDelay:e.video.presentation_delay,lowLatencyMode:null==(n=e.video.live_event)?void 0:n.low_latency,dvrEnabled:null==(s=e.video.live_event)?void 0:s.dvr,disableDeltaUpdates:d,getLiveEventStartTimeEpoch:()=>function(e){var t;return null!=e&&e.started_on?new Date(e.started_on).getTime()/1e3:null==e||null==(t=e.ingest)?void 0:t.start_time}(e.video.live_event),sessionMetadata:{clipId:e.video.id,sessionId:e.request.session},disableMMS:!(null==(a=e.request.flags)||!a.disable_mms)||!ue.iOS,enableCMCD:null==(o=e.request.flags)?void 0:o.cmcd,hlsJsDebugMode:null==(c=e.request.flags)?void 0:c.hls_js_debug,enableMultiAudioLive:null==(u=e.request.flags)?void 0:u.multi_audio_live})}(),Object.values(Oi).filter(e=>![Oi.TIME_UPDATE,Oi.PROGRESS,Oi.SUSPEND,Oi.ERROR].includes(e)).forEach(e=>{i.on(e,(t="")=>{Eh.captureBreadcrumb(e,t,"video event")})}),i.on(Ui.STREAMS_LOADED,function(t){t.video.forEach(t=>{const r=function(e,t){return t.find(t=>ih(t.id)===String(e)||ih(t.id)===ih(e))}(t.id,fh(e,i));r?(t.profile=r.profile,t.quality=r.quality,t.fps=r.fps):(t.profile=null,t.quality=`${t.height}p`,t.fps=t.framerate)})}),i.on(Ui.STREAM_CHANGE,function({index:e,streams:r,metadata:n}){const s=r[e];Eh.captureBreadcrumb("Stream changed",s,"video"),i.updateBufferTarget(),t.fire(Ui.STREAM_CHANGE,s,e,r,n)}),i.on(Ui.STREAM_TARGET_CHANGE,function({index:e,streams:r}){const n=r[e];i.updateBufferTarget(),t.fire(Ui.STREAM_TARGET_CHANGE,n,e,r)}),i.on(Ui.DRM_KEY_SWITCH,function(){var t;if(!e.request.drm.fallback_asset)return;const r=vh(e),n=null==(t=Wh(i.video.audioTracks))?void 0:t.id;h(Jl(e,n),r)}),function(e,t){[Mi.ACTIVATED,Mi.AVAILABLE,Mi.DEACTIVATED,Mi.UNAVAILABLE,Fi.STREAM_OFFLINE,Fi.STREAM_ONLINE,Fi.BUFFER_GAP_JUMP,Fi.BUFFER_GAP_JUMP_PREVENT,Fi.STALL_JUMP,Fi.LATENCY_UPDATED,ji.MEDIASESSION_PAUSE,ji.MEDIASESSION_PLAY,ji.MEDIASESSION_SEEK_BACKWARD,ji.MEDIASESSION_SEEK_FORWARD,ji.MEDIASESSION_SEEK_TO,Ui.AUDIO_TRACK_CHANGED,Ui.AV_DURATION_MISMATCH,Ui.BANDWIDTH,Ui.BUFFER_ENDED,Ui.BUFFER_OCCUPANCY,Ui.BUFFER_STARTED,Ui.CHAPTER_CUES_UPDATED,Ui.CUE_POINT,Ui.NO_SUPPORTED_CDM,Ui.CURRENT_FILE_CHANGE,Ui.DOWNLOAD_END,Ui.DOWNLOAD_TIMEOUT,Ui.DRM_AUTH_SUCCESS,Ui.DRM_CDM_CHANGE,Ui.DRM_KEY_SWITCH,Ui.DROPPED_FRAMES,Ui.MANIFEST_LOADED,Ui.MANIFEST_TIMEOUT,Ui.QUOTA_EXCEEDED_ERROR,Ui.SCANNER_CHANGE,Ui.STREAM_CHANGE_START,Ui.STREAM_BUFFER_END,Ui.STREAM_BUFFER_START,Ui.AVAILABLE_STREAMS_CHANGED,Ui.MEDIA_CAPABILITY_STREAMS_UNSUPPORTED,Ui.TEXT_TRACKS_AVAILABLE,Ui.DROPPED_FRAME_PERCENT_EXCEEDED,Ui.LOAD_SEGMENT_FAILED,Ui.SEGMENT_CUES_LOADED,Ui.HLS_JS_ERROR,Vi.CAMERA_UPDATE,Vi.CAMERA_CHANGE,Vi.MOTION_END,Vi.MOTION_START,Vi.SPATIAL_UNSUPPORTED,Vi.WEBVR_ENTER,Vi.WEBVR_EXIT,Vi.WEBVR_HARDWARE_AVAILABLE,Oi.DURATION_CHANGE,Oi.ERROR,Oi.LOAD_START,Oi.LOADED_DATA,Oi.LOADED_METADATA,Oi.PLAYING,Oi.RATE_CHANGE,Oi.RESIZE,Oi.STALLED,Oi.VOLUME_CHANGE,Oi.WAITING,Oi.ENTER_PICTURE_IN_PICTURE,Oi.LEAVE_PICTURE_IN_PICTURE,Oi.WEBKIT_BEGIN_FULLSCREEN,Oi.WEBKIT_END_FULLSCREEN].forEach(r=>{e(r,(...e)=>{t.apply(void 0,[r].concat(e))})})}(i.on,t.fire),t.fire(hl),new Hh(t,i),new yh(e,t,i),new Sh(e,t,i),new Uh(e,t,i),a=new kh(e,t,i),s=new Th(e,t,i),o=new xh(e,t,i),t.on(ll,l),t.on(ul,function(r){var n,s;if(null==(n=e.embed)||null==(n=n.settings)||!n.audio_tracks)return;if(i.supportsAudioTracksFromScanner)return void i.enableAudioTrack(null==r?void 0:r.id);const a=function(e,t={}){if(null==e||!e.length)return[];const r=Yh(e,t);if(r)return Xh(e,r.id);const n=qh(e);return Xh(e,null==n?void 0:n.id)}(e.request.audio_tracks,r),o=Wh(a),c="sd-fallback"===(null==(s=i.video)||null==(s=s.drmHandler)?void 0:s.state);d({files:Ql(e,null==o?void 0:o.id,c),textTracks:i.video.textTracks,audioTracks:a,switchingVideo:!0,startTime:i.currentTime}),t.fire(Ui.AUDIO_TRACK_CHANGED)}),t.on(Oi.LOADED_DATA,function(){var t,r;i.supportsAudioTracksFromScanner&&null!=(t=i.audioTracks)&&t.length&&(null!=e&&null!=(r=e.request)&&null!=(r=r.audio_tracks)&&r.length?function(){const t=zh({audioTracks:e.request.audio_tracks||[],config:e}),r=function(e,t){for(let r=0;r<e.length;r++){const n=e[r];if($h(n,t))return n}return null}(i.audioTracks,t);r&&i.enableAudioTrack(r.id)}():function(){const t=zh({audioTracks:Array.from(i.audioTracks||[]),config:e});i.enableAudioTrack(t.id)}())}),ue.browser.safari&&window.addEventListener("pageshow",e=>{e.persisted&&(c=!0,l())}),S({telecine:i},s)}function Jh(e,t,r){this.constructorName="BackboneError",this.message=e,this.name=t,this.source=r}Jh.prototype=new Error;var Zh={embed:{},request:{cookie:{},files:{},flags:{},urls:{},text_tracks:[],file_codecs:{}},video:{owner:{},thumbnail_url:"",version:{}},user:{}};function ed(e,t,r=[]){let n;const i=new Ir;let s,a,o=null,c=new Gl(t,Zh);function u(e,t){return i.fire(ll,e,t),e}const l={play:()=>s.play(),pause:()=>s.pause(),get currentTime(){return a.currentTime>.1?tl(a.currentTime):0},set currentTime(e){if(e=parseFloat(e),isNaN(e)||e<0)throw new Jh("Seconds must be a positive number less than the duration of the video.","RangeError","setCurrentTime");i.fire(il,e)},get liveEdgeTime(){return a.liveEdgeTime},get atLiveEdge(){return a.atLiveEdge},get liveTailTime(){return a.liveTailTime},get atLiveTail(){return a.atLiveTail},get duration(){return tl(c.video.duration)},get enabledTextTrack(){return o},loadVideo(e){const t=ci(c);return c.reset(e),c=u(c,t),this},reactivate(){var e;return null!=(e=a)&&e.reactivate&&a.reactivate(),this},unload(){return i.fire(sl),this},destroy(){return i.fire(al),this},on(e,t){return i.on(e,t),this},once(e,t){return i.once(e,t),this},off(e,t){return i.off(e,t),this},get events(){return i},hasTextTrack(e){let t,r,n=this.textTracks;if(el(e))r=n.getTrackById(e);else{let r=e.split(".")[0];t=n.some(e=>e.language.toLowerCase()===r.toLowerCase())}return!(!r&&!t)},enableTextTrack(e,t=null){let r,n,s=this.textTracks;if(el(e))o=s.getTrackById(e);else{if([r,n=t]=e.split("."),!this.hasTextTrack(e))throw new Jh(`There are no tracks for ${r.toUpperCase()}.`,"InvalidTrackLanguageError","enableTextTrack");o=Fh(n?`${r}.${n}`:r,s).track}if(!o||n&&o.kind!==n)throw new Jh(`There are no ${n} tracks for ${r.toUpperCase()}.`,"InvalidTrackError","enableTextTrack");a.setCaptionsShouldDisplay(!0),i.fire(ol,o.id)},disableTextTrack(){o=null,a.setCaptionsShouldDisplay(!1),i.fire(cl)},enableAudioTrack(e){i.fire(ul,e)},get qualities(){return function(e){var t;const r=e.representations.map(t=>{const r=zl(t);return{id:r,label:_h(t),active:e.quality===r}}),n=null==(t=e.video)?void 0:t.currentFile.mime;return[b.dash,b.dashMpd,b.hlsLive,b.hls].includes(n)&&r.unshift({id:"auto",label:"Auto",active:!e.quality||"auto"===e.quality}),r}(this)},get quality(){return s.quality},set quality(e){s.quality=e},get playbackRate(){return a?a.playbackRate:1},set playbackRate(e){a.playbackRate=e,a.defaultPlaybackRate=e},get textTracks(){return a.video?a.video.textTracks:[]},get representations(){return fh(c,a)},get volume(){return a?a.volume:tl(c.request.cookie.volume)},set volume(e){if(e=parseFloat(e),isNaN(e)||e<0||e>1)throw new Jh("Volume should be a number between 0 and 1.","RangeError","setVolume");a.volume=e},get videoId(){return c.video.id},get videoWidth(){return a.videoWidth||c.video.width},get videoHeight(){return a.videoHeight||c.video.height},get readyState(){return a.videoElement.readyState},get telecine(){return a},get audioTracks(){var e;return(null==(e=a)||null==(e=e.video)?void 0:e.audioTracks)||[]},get enabledAudioTrack(){var e;return null==(e=a)||null==(e=e.video)?void 0:e.enabledAudioTrack},requestCompleteLiveSubtitles(){i.fire(Tl)},get hasAudio(){var e,t;return!(null==(e=a)||null==(e=e.video)||null==(e=e.audioTracks)||!e.length)||!(null==(t=a.manifest)||null==(t=t.audio)||!t.length)}};return c=u(c),s=new Qh(c,i,e,r),a=s.telecine,n=Object.create(a),S(n,l)}function td(e){return"string"==typeof e||!it(e)&&vt(e)&&"[object String]"==pt(e)}function rd(e){return Math.round(parseInt(e,16)/255*100)/100}function nd(...e){if(1===e.length&&e[0]instanceof nd){var t=e[0];return this.red=t.red,this.green=t.green,this.blue=t.blue,this.alpha=t.alpha,this.hue=t.hue,this.saturation=t.saturation,this.lightness=t.lightness,this}if(1===e.length){if("string"==typeof e[0]&&e[0].indexOf("rgb")>=0)return this.rgba=function(e){var t=/rgba?\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})(,\s*([\d.]+))?\)/.exec(e);if(!t)throw new Error("Invalid rgb value");return{red:parseInt(t[1],10),green:parseInt(t[2],10),blue:parseInt(t[3],10),alpha:parseFloat(t[5])||1}}(e[0]),this;if(!function(e){return"string"==typeof(e=e.replace("#",""))&&[3,4,6,8].includes(e.length)&&!isNaN(parseInt(e,16))}(`${e[0]}`))throw new Error("Invalid hex value");const{hex:t,alpha:r}=function(e){let t=1;return 4===(e=e.replace("#","")).length&&(t=rd(e.slice(3)+e.slice(3)),e=e.slice(0,3)),8===e.length&&(t=rd(e.slice(6,8)),e=e.slice(0,6)),{hex:e,alpha:t}}(`${e[0]}`);return this.hex=t,this.alpha=r,this}if(3===e.length||4===e.length){for(var r=0;r<3;r++)if(isNaN(parseInt(e[r],10))||parseInt(e[r],10)<0||parseInt(e[r],10)>255)throw new Error("Invalid rgb value");if(e[3]&&parseFloat(e[3])<0||parseFloat(e[3])>1)throw new Error("Invalid alpha value");return this.rgba={red:e[0],green:e[1],blue:e[2],alpha:parseFloat(e[3])||1},this}throw new Error("Invalid color")}function id(){let e=0,t=null,r=0,n=!1;function i(){return e/1e3}return{trackBufferStart:function(e,i){t=Ee(),r++,n=!0,e(i)},trackBufferEnd:function(r,i={}){if(!n)return;const s=Se(t);e+=s,i.buffer_duration=s/1e3,n=!1,r(i)},trackVideoExit:function(r){n&&!r&&(e+=Se(t))},resetLastBufferTime:function(){t=null},getBufferRatio:function(e){const t=i()/e*100;return isNaN(t)?0:Math.round(100*t)/100},getBufferCount:function(){return r},getTotalBufferDuration:i,isVideoBuffering:function(){return n}}}nd.prototype={get complement(){var e=this.clone();return e.rgb={red:255-this.red,green:255-this.green,blue:255-this.blue},e},get hex(){return nd.rgbToHex(this.red,this.green,this.blue)},get hexWithAlpha(){const e=("0"+Math.round(255*this.alpha).toString(16)).slice(-2);return nd.rgbToHex(this.red,this.green,this.blue)+e},set hex(e){return this.rgba=nd.hexToRgb(e),this},get hsl(){return"hsl("+this.hue+","+this.saturation+"%,"+Math.round(this.lightness)+"%)"},set hsl(e){this.hue=e.hue,this.saturation=e.saturation,this.lightness=e.lightness;var t=nd.hslToRgb(e.hue,e.saturation,e.lightness);return this.red=t.red,this.green=t.green,this.blue=t.blue,this.alpha=t.alpha,this},get luminance(){function e(e){return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}return.2126*e(this.red/255)+.7152*e(this.green/255)+.0722*e(this.blue/255)},get rgb(){return"rgb("+this.red+","+this.green+","+this.blue+")"},set rgb(e){return this.rgba=e,this},get rgba(){return"rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")"},set rgba(e){this.red=e.red,this.green=e.green,this.blue=e.blue,this.alpha=e.alpha||1;var t=nd.rgbToHsl(e.red,e.green,e.blue);return this.hue=t.hue,this.saturation=t.saturation,this.lightness=t.lightness,this},get yiq(){return(299*this.red+587*this.green+114*this.blue)/1e3},clone:function(){return new nd(this)},lighten:function(e,t,r){if(this.hsl={hue:this.hue,saturation:this.saturation,lightness:this.lightness+e},t&&r)for(var n=r.contrast(this).ratio;n<t&&(this.lighten(5),n=r.contrast(this).ratio,!(this.lightness>=100)););return this},darken:function(e,t,r){if(this.hsl={hue:this.hue,saturation:this.saturation,lightness:this.lightness-e},t&&r)for(var n=r.contrast(this).ratio;n<t&&(this.darken(5),n=r.contrast(this).ratio,!(this.lightness<=0)););return this},overlayOn:function(e){if(this.alpha>=1)return this;var t=this.clone();return t.rgba={red:t.red*this.alpha+e.red*e.alpha*(1-this.alpha),green:t.green*this.alpha+e.green*e.alpha*(1-this.alpha),blue:t.blue*this.alpha+e.blue*e.alpha*(1-this.alpha),alpha:t.alpha+e.alpha*(1-this.alpha)},t},contrast:function(e){var t=this.alpha;if(t>=1){e.alpha<1&&(e=e.overlayOn(this));var r=this.luminance+.05,n=e.luminance+.05,i=r/n;return n>r&&(i=1/i),{ratio:i=Math.round(10*i)/10,error:0,min:i,max:i}}var s=this.overlayOn(nd.white).contrast(e).ratio,a=this.overlayOn(nd.black).contrast(e).ratio,o=Math.max(s,a),c={red:Math.min(Math.max(0,(e.red-this.red*t)/(1-t)),255),green:Math.min(Math.max(0,(e.green-this.green*t)/(1-t)),255),blue:Math.min(Math.max(0,(e.blue-this.blue*t)/(1-t)),255)},u=this.clone();u.rgb=c;var l=this.overlayOn(u).contrast(e).ratio;return{ratio:Math.round((l+o)/2*10)/10,error:Math.round((o-l)/2*10)/10,min:l,max:o,closest:u,farthest:a===o?nd.white:nd.black}},wcagAACompliant:function(e){return this.contrast(e).ratio>=4.5},wcagAAACompliant:function(e){return this.contrast(e).ratio>=7},yiqContrastColor:function(){return this.yiq>=120?new nd(0,0,0):new nd(255,255,255)}},nd.hexToRgb=function(e){var t;return 3===(e=String(e)).length||4===e.length?(t=/^#?([A-Fa-f0-9])([A-Fa-f0-9])([A-Fa-f0-9])$/i.exec(e))&&(t[1]+=t[1],t[2]+=t[2],t[3]+=t[3]):t=/^#?([A-Fa-f0-9]{2})([A-Fa-f0-9]{2})([A-Fa-f0-9]{2})$/i.exec(e),t?{red:parseInt(t[1],16),green:parseInt(t[2],16),blue:parseInt(t[3],16),alpha:1}:null},nd.rgbToHex=function(e,t,r){return"#"+((1<<24)+(Math.round(e)<<16)+(Math.round(t)<<8)+Math.round(r)).toString(16).slice(1)},nd.rgbToHsl=function(e,t,r){e/=255,t/=255,r/=255;var n,i=Math.max(e,t,r),s=Math.min(e,t,r),a=(i+s)/2,o=a;if(i===s)return{hue:0,saturation:0,lightness:100*o};var c=i-s;return n=o>.5?c/(2-i-s):c/(i+s),i===e?a=(t-r)/c+(t<r?6:0):i===t?a=(r-e)/c+2:i===r&&(a=(e-t)/c+4),a/=6,{hue:Math.round(360*a),saturation:Math.round(100*n),lightness:Math.round(100*o)}},nd.hslToRgb=function(e,t,r){function n(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),6*r<1?e+6*(t-e)*r:2*r<1?t:3*r<2?e+6*(2/3-r)*(t-e):e}if(e/=360,r/=100,0==(t/=100))return{red:Math.floor(255*r),green:Math.floor(255*r),blue:Math.floor(255*r)};var i=r<.5?r*(1+t):r+t-t*r,s=2*r-i;return{red:Math.floor(255*n(s,i,e+1/3)),green:Math.floor(255*n(s,i,e)),blue:Math.floor(255*n(s,i,e-1/3))}},nd.hslToHex=function(e,t,r){var n=nd.hslToRgb(e,t,r);return nd.rgbToHex(n.red,n.green,n.blue)},nd.white=new nd("fff"),nd.black=new nd("000");const sd={VIDEO_BUFFER_END:"video-buffer-end",VIDEO_BUFFER_START:"video-buffer-start",VIDEO_ENDED:"video-ended",VIDEO_EXIT:"video-exit",VIDEO_LOAD_FAILURE:"video-load-failure",VIDEO_MINUTE_WATCHED:"video-minute-watched",VIDEO_PAUSED:"video-paused",VIDEO_PLAYED:"video-played",VIDEO_PLAYBACK_ERROR:"video-playback-error",VIDEO_READY:"video-ready",VIDEO_START_ATTEMPT:"video-start-attempt",VIDEO_START_FAILURE:"video-start-failure",VIDEO_START_TIME:"video-start-time",VIDEO_SEEK:"video-seek",VIDEO_SEEKED:"video-seeked",CHUNK_DOWNLOADED:"chunk-downloaded"};function ad(e){function t(e,t,r=!0,n="POST"){return new Promise((i,s)=>{"POST"===n&&navigator.sendBeacon?i({status:navigator.sendBeacon(e,t)}):Ye({url:e,body:t,method:n,async:r,headers:{"Content-Type":"text/plain; charset=UTF-8"}}).then(e=>{i({response:e,status:e.status})}).catch(s)})}return{log:function(r,n=!0,i=!0){i&&(r.event_time=r.event_time||Ee());const s=[r];return t(e,JSON.stringify(s),n)},logRequestPromiseWithUrl:t}}const od="playing";function cd(e,t=3){if(e=parseFloat(e),isNaN(e))return 0;var r=Math.pow(10,t);return Math.round(e*r)/r}function ud(e,t){let r,n,i,s,a,o,c,u,l,h,d,f,_,p,v=0;function m(){r=0,n=0,i=0,s=0,a=0,o=null,c=0,u=!1,l=!1,h=null,d=!1,f=function(e){let t=0,r=0,n=0,i=0,s=!1,a=-1,o=null,c=null,u=null,l={satisfied:0,tolerable:0,frustrated:0},h=null;function d(){const t=e.getBoundingClientRect(),r=e.videoWidth,n=e.videoHeight;if(0===r&&0===n)return;const i="satisfied";let s=i;if(t.width>r&&t.height>n&&(r/t.width<.4?s=i:r/t.width<1?s="tolerable":r/t.width>1&&(s="frustrated")),c){const e=Se(c);l[u]+=e}u=s,c=Ee()}function f(){return s?0:1}function _(){return-1===a?null:a>8e3||-1===a?0:a>2e3?.5:1}function p(){return h?(i=n/Se(h),t>=4||i>=.12?0:t<4&&0!==t?i<.12?.5:0:1):null}function v(){if(-1===a)return null;d();const e=Object.keys(l).reduce((e,t)=>l[e]>l[t]?e:t);switch(e){case"satisfied":return 1;case"tolerable":return.5;case"frustrated":return 0}return null}return e.addEventListener(od,()=>{-1===a&&(o=Ee())}),e.addEventListener("progress",()=>{-1===a&&(h=Ee(),a=Se(o)),d()}),{startupTimeScore:_,rebufferScore:p,failureScore:f,videoQualityScore:v,overallScore:function(){return Math.min(f(),_(),p(),v())},trackBufferStart:function(){-1!==a&&(t++,r=Ee())},trackBufferEnd:function(){-1!==a&&(n+=Se(r))},onError:function(e){e.final&&(s=!0)}}}(e),_=id(),p={bufferTracker:_,videoBufferCheck:()=>{setInterval(()=>{let t=e.currentTime;l&&!d&&!e.paused&&!p.bufferTracker.isVideoBuffering()&&t<a+.125&&p.bufferTracker.trackBufferStart(E),l&&!e.paused&&p.bufferTracker.isVideoBuffering()&&t>a+.125&&(p.bufferTracker.trackBufferEnd(T),p.bufferTracker.resetLastBufferTime()),a=t},250)},addEventData:e=>null,playbackSessionTimer:()=>{let t=Ee();setInterval(()=>{(!e.paused&&u||d||p.bufferTracker.isVideoBuffering())&&(c+=Se(t)/1e3),t=Ee()},500)},customMinuteTracker:{shouldCount:()=>!1,onCount:()=>{}}}}function g(e,r={}){0===v&&(r=Object.assign(r,p.addEventData(e)),t(e,r))}function E(e={}){f.trackBufferStart(),g(sd.VIDEO_BUFFER_START,e)}function T(e={}){f.trackBufferEnd(),g(sd.VIDEO_BUFFER_END,e)}return m(),g(sd.VIDEO_READY),function(){let t=Math.ceil(59*Math.random());setInterval(()=>{var a,o,c;function l(e,r){return 0===e?r===t:r>=60}!e.paused&&u&&(r++,null!=(a=p.customMinuteTracker)&&null!=a.shouldCount&&a.shouldCount()&&n++,l(i,r)&&(r=0,i++,g(sd.VIDEO_MINUTE_WATCHED)),l(s,n)&&null!=(o=p.customMinuteTracker)&&null!=o.shouldCount&&o.shouldCount()&&(n=0,s++,null==(c=p.customMinuteTracker)||null==c.onCount||c.onCount(s)))},1e3)}(),window.addEventListener("pagehide",t=>{p.bufferTracker.trackVideoExit(e.paused);const r={startup:f.startupTimeScore(),rebuffer:f.rebufferScore(),failure:f.failureScore(),quality:f.videoQualityScore(),overall:f.overallScore()};h&&g(sd.VIDEO_EXIT,{vxs:r})},!1),e.addEventListener(od,()=>{u=!0,d||l&&g(sd.VIDEO_PLAYED)}),e.addEventListener("timeupdate",()=>{if(l)return;let e={startup_duration:h?cd(Se(h)/1e3,2):null};g(sd.VIDEO_START_TIME,e),l=!0}),e.addEventListener("pause",()=>{u=!1,g(sd.VIDEO_PAUSED)}),e.addEventListener("seeking",()=>{d||(o=Ee(),d=!0,u=!1,g(sd.VIDEO_SEEK))}),e.addEventListener("seeked",()=>{d=!1,e.paused||(u=!0),g(sd.VIDEO_SEEKED,{seek_duration:Se(o)/1e3}),o=null}),e.addEventListener("ended",()=>{g(sd.VIDEO_ENDED)}),e.addEventListener("waiting",()=>{u=!1}),e.addEventListener("canplay",()=>{d||p.bufferTracker.isVideoBuffering()&&!u&&(p.bufferTracker.trackBufferEnd(T),p.bufferTracker.resetLastBufferTime())}),{globalProperties:function(){return{autoplay:e.autoplay,buffer_count:p.bufferTracker.getBufferCount(),total_buffer_duration:p.bufferTracker.getTotalBufferDuration(),buffer_ratio:p.bufferTracker.getBufferRatio(c),client_time:Ee(),is_buffering:p.bufferTracker.isVideoBuffering(),looping:e.loop,minutes_watched:i,muted:e.muted,network_state:e.networkState,playback_rate:e.playbackRate,player_width:e.getBoundingClientRect().width,player_height:e.getBoundingClientRect().height,session_playback_duration:cd(c,2),video_time:e.currentTime,video_height:e.videoHeight,video_width:e.videoWidth,volume:cd(e.volume,2)}},logStartRequest:function(){h=Ee(),g(sd.VIDEO_START_ATTEMPT)},customizeHooks:function(e){p=Object.assign(p,e)},initHooks:function(){p.videoBufferCheck(),p.playbackSessionTimer()},logBufferStart:E,logBufferEnd:T,setDisplayContext:function(e){v=e},handleExternalError:function(e,t){u=!1,f.onError(t),g(l?sd.VIDEO_PLAYBACK_ERROR:l?sd.VIDEO_START_FAILURE:sd.VIDEO_LOAD_FAILURE,e)},reset:m}}var ld=function(){return ot.Date.now()},hd=Math.max,dd=Math.min;function fd(e,t,r){var n,i,s,a,o,c,u=0,l=!1,h=!1,d=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function f(t){var r=n,s=i;return n=i=void 0,u=t,a=e.apply(s,r)}function _(e){var r=e-c;return void 0===c||r>=t||r<0||h&&e-u>=s}function p(){var e=ld();if(_(e))return v(e);o=setTimeout(p,function(e){var r=t-(e-c);return h?dd(r,s-(e-u)):r}(e))}function v(e){return o=void 0,d&&n?f(e):(n=i=void 0,a)}function m(){var e=ld(),r=_(e);if(n=arguments,i=this,c=e,r){if(void 0===o)return function(e){return u=e,o=setTimeout(p,t),l?f(e):a}(c);if(h)return clearTimeout(o),o=setTimeout(p,t),f(c)}return void 0===o&&(o=setTimeout(p,t)),a}return t=$u(t)||0,Tt(r)&&(l=!!r.leading,s=(h="maxWait"in r)?hd($u(r.maxWait)||0,t):s,d="trailing"in r?!!r.trailing:d),m.cancel=function(){void 0!==o&&clearTimeout(o),u=0,n=c=i=o=void 0},m.flush=function(){return void 0===o?a:v(ld())},m}function _d(e,t,r){var n=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return Tt(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),fd(e,t,{leading:n,maxWait:t,trailing:i})}var pd,vd=0,md=0,gd={},Ed={};function Td(e,t,r){return"_root"==t?r:e!==r?function(e){return pd||(pd=e.matches?e.matches:e.webkitMatchesSelector?e.webkitMatchesSelector:e.mozMatchesSelector?e.mozMatchesSelector:e.msMatchesSelector?e.msMatchesSelector:e.oMatchesSelector?e.oMatchesSelector:Ad.matchesSelector)}(e).call(e,t)?e:e.parentNode?(vd++,Td(e.parentNode,t,r)):void 0:void 0}function yd(e,t,r,n){gd[e.id]||(gd[e.id]={}),gd[e.id][t]||(gd[e.id][t]={}),gd[e.id][t][r]||(gd[e.id][t][r]=[]),gd[e.id][t][r].push(n)}function Sd(e,t,r,n){if(gd[e.id])if(t)if(n||r)if(n){if(gd[e.id][t][r])for(var i=0;i<gd[e.id][t][r].length;i++)if(gd[e.id][t][r][i]===n){gd[e.id][t][r].splice(i,1);break}}else delete gd[e.id][t][r];else gd[e.id][t]={};else for(var s in gd[e.id])gd[e.id].hasOwnProperty(s)&&(gd[e.id][s]={})}function bd(e,t,r,n){if(this.element){e instanceof Array||(e=[e]),r||"function"!=typeof t||(r=t,t="_root");var i,s=this.id;for(i=0;i<e.length;i++)n?Sd(this,e[i],t,r):(gd[s]&&gd[s][e[i]]||Ad.addEvent(this,e[i],a(e[i])),yd(this,e[i],t,r));return this}function a(e){return function(t){!function(e,t,r){if(gd[e][r]){var n,i,s=t.target||t.srcElement,a={},o=0,c=0;for(n in vd=0,gd[e][r])gd[e][r].hasOwnProperty(n)&&(i=Td(s,n,Ed[e].element))&&Ad.matchesEvent(r,Ed[e].element,i,"_root"==n,t)&&(vd++,gd[e][r][n].match=i,a[vd]=gd[e][r][n]);for(t.stopPropagation=function(){t.cancelBubble=!0},o=0;o<=vd;o++)if(a[o])for(c=0;c<a[o].length;c++){if(!1===a[o][c].call(a[o].match,t))return void Ad.cancel(t);if(t.cancelBubble)return}}}(s,t,e)}}}function Ad(e,t){if(!(this instanceof Ad)){for(var r in Ed)if(Ed[r].element===e)return Ed[r];return md++,Ed[md]=new Ad(e,md),Ed[md]}this.element=e,this.id=t}Ad.prototype.on=function(e,t,r){return bd.call(this,e,t,r)},Ad.prototype.off=function(e,t,r){return bd.call(this,e,t,r,!0)},Ad.matchesSelector=function(){},Ad.cancel=function(e){e.preventDefault(),e.stopPropagation()},Ad.addEvent=function(e,t,r){var n="blur"==t||"focus"==t,i=ue.passiveEvents?{capture:n,passive:!1}:n;e.element.addEventListener(t,r,i)},Ad.matchesEvent=function(){return!0};const Id=Ad.addEvent,wd=void 0===window.PointerEvent&&void 0!==window.MSPointerEvent,Rd={pointerdown:"MSPointerDown",pointerup:"MSPointerUp",pointercancel:"MSPointerCancel",pointermove:"MSPointerMove",pointerenter:"MSPointerEnter",pointerleave:"MSPointerLeave",pointerover:"MSPointerOver",pointerout:"MSPointerOut"},Pd="onmspointerenter"in document,Dd="onmspointerleave"in document;Ad.addEvent=function(e,t,r){wd&&Rd[t]&&(t=Rd[t]),"transitionend"===t&&(Id(e,"webkitTransitionEnd",r),Id(e,"otransitionend",r)),"mouseenter"===t&&(t="mouseover"),"mouseleave"===t&&(t="mouseout"),"MSPointerEnter"!==t||Pd||(t="MSPointerOver"),"MSPointerLeave"!==t||Dd||(t="MSPointerOut"),Id(e,t,r)},Ad.matchesEvent=function(e,t,r,n,i){return!("mouseenter"===e||"mouseleave"===e||!Pd&&"MSPointerEnter"===e||!Dd&&"MSPointerLeave"===e)||function(e,t,r,n){return!n.relatedTarget||(!r||e===t)&&t!==n.relatedTarget&&!t.contains(n.relatedTarget)}(t,r,n,i)};const Ld={SETUP_DONE:"SETUP_DONE",NOT_SETUP:"NOT_SETUP"};class kd{constructor(){this.version="1.2.36",this.remotePlayer=null,this.remotePlayerController=null,this.CastContextEventType=null,this.RemotePlayerEventType=null,this.CastState=Ld,this.SessionState=null,this.PlayerState=null,this.currentLoadRequestId=null,this.currentLoadingMediaPromise=null}get isGCastApiAvailable(){return!!("undefined"!=typeof cast&&cast&&cast.framework&&cast.framework.VERSION)}get castState(){return this.castContext?this.castContext.getCastState():this.isGCastApiAvailable?this.CastState.SETUP_DONE:this.CastState.NOT_SETUP}get versionGCastApi(){return this.isGCastApiAvailable?cast.framework.VERSION:null}get castContext(){return this.isGCastApiAvailable?cast.framework.CastContext.getInstance():null}get currentSession(){return this.castContext?this.castContext.getCurrentSession():null}get currentSessionObj(){const e=this.currentSession;return e?e.getSessionObj():null}get isInitialized(){return!(!this.isGCastApiAvailable||!this.remotePlayerController)}get isSessionEstablished(){const e=this.currentSessionObj;return!!e&&e.status===chrome.cast.SessionStatus.CONNECTED}get isCastConnected(){return this.castState===this.CastState.CONNECTED}init({receiverApplicationId:e="",resumeSavedSession:t=!0,language:r=null,autoJoinPolicy:n="TAB_AND_ORIGIN_SCOPED"}={}){if(!this.isGCastApiAvailable)throw new Error("CAF is not available. Call setup() first.");if("string"!=typeof e||""===e.trim())throw new Error("Parameter 'receiverApplicationId' must be valid.");switch(n){case chrome.cast.AutoJoinPolicy.TAB_AND_ORIGIN_SCOPED:case chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED:case chrome.cast.AutoJoinPolicy.PAGE_SCOPED:break;default:n=chrome.cast.AutoJoinPolicy.TAB_AND_ORIGIN_SCOPED}return this.CastContextEventType=cast.framework.CastContextEventType,this.RemotePlayerEventType=cast.framework.RemotePlayerEventType,this.CastState=Object.assign(this.CastState,cast.framework.CastState),this.SessionState=cast.framework.SessionState,this.PlayerState=chrome.cast.media.PlayerState,cast.framework.CastContext.getInstance().setOptions({receiverApplicationId:e.trim(),resumeSavedSession:t,language:r,autoJoinPolicy:n}),this.isInitialized?this.remotePlayerController:this.initRemotePlayer()}initRemotePlayer(){if(!this.isGCastApiAvailable)throw new ReferenceError("CAF is not available. Call setup() first.");return this.remotePlayer=new cast.framework.RemotePlayer,this.remotePlayerController=new cast.framework.RemotePlayerController(this.remotePlayer),this.remotePlayerController}setup({loadLibrary:e=!0}={}){return new Promise((t,r)=>{if(this.isGCastApiAvailable)return this.AutoJoinPolicy=chrome.cast.AutoJoinPolicy,void t(!0);window.__onGCastApiAvailable=(e,n)=>{let i;n?(i=new Error(n),r(i)):chrome.cast?(this.AutoJoinPolicy=chrome.cast.AutoJoinPolicy,t(e)):(i=new ReferenceError("Cast is not available on this browser."),r(i))};try{if(!1===e)throw new ReferenceError("Cast is not available. Make sure the library has been loaded.");this.loadLibrary()||t(!1)}catch(e){const t=new Error(e);r(t)}})}loadLibrary(){if(this.isGCastApiAvailable)return!0;if(null!==window.chrome&&void 0!==window.chrome&&"Google Inc."===window.navigator.vendor){let e="//www.gstatic.com/cv/js/sender/v1/cast_sender.js";if(!(document.querySelectorAll('script[src^="'+e+'"]').length>0)){e+="?loadCastFramework=1";const t=document.createElement("script");return t.src=e,t.async=!0,t.defer=!0,document.head.appendChild(t),!0}}return!1}loadMedia({contentId:e,contentType:t,currentTime:r=0,duration:n=0,requestCustomData:i=null,mediaCustomData:s=null,autoRequest:a=!1,tracks:o=[],ottCastOptions:c}){return e?this.isSessionEstablished?this.loadMediaOnSession(this.currentSession,{contentId:e,contentType:t,currentTime:r,duration:n,requestCustomData:i,mediaCustomData:s,tracks:o,ottCastOptions:c}):!0!==a?Promise.reject(new TypeError("Option 'autoRequest' must be true when session is not connected.")):this.requestSession().then(a=>this.loadMediaOnSession(a,{contentId:e,contentType:t,currentTime:r,duration:n,requestCustomData:i,mediaCustomData:s,tracks:o,ottCastOptions:c})):Promise.reject(new TypeError("Option 'contentId' must be valid."))}loadMediaOnSession(e,{contentId:t,contentType:r,currentTime:n=0,duration:i,requestCustomData:s=null,mediaCustomData:a=null,tracks:o=[],ottCastOptions:c}){if(e&&e instanceof cast.framework.CastSession){const u=e.getSessionState();if(u!==this.SessionState.SESSION_STARTING&&u!==this.SessionState.SESSION_STARTED&&u!==this.SessionState.SESSION_RESUMED)return Promise.reject(new ReferenceError("Session must be established."));const l=this.createLoadRequest(t,r,n,i,s,a,o,c);return null!==this.currentLoadRequestId&&this.currentLoadRequestId===l.requestId||(this.currentLoadRequestId=l.requestId,this.currentLoadingMediaPromise=e.loadMedia(l).finally(()=>{this.currentLoadRequestId=null,this.currentLoadingMediaPromise=null})),this.currentLoadingMediaPromise}return Promise.reject(new ReferenceError("Session must be cast.framework.CastSession."))}requestSession(){return this.isSessionEstablished?Promise.resolve(this.currentSession):this.castContext?this.castContext.requestSession().then(()=>this.currentSession):Promise.reject(new Error("CastContext is not available. Call setup() first."))}sendMessage({namespace:e,data:t={},autoRequest:r=!1}){return this.isSessionEstablished?this.sendMessageOnSession(this.currentSession,{namespace:e,data:t}):!0!==r?Promise.reject(new TypeError("Option 'autoRequest' must be true when session is not connected.")):this.requestSession().then(r=>this.sendMessageOnSession(r,{namespace:e,data:t}))}sendMessageOnSession(e,{namespace:t,data:r={}}){if(e||!(e instanceof cast.framework.CastSession)){const n=e.getSessionState();return n!==this.SessionState.SESSION_STARTING&&n!==this.SessionState.SESSION_STARTED&&n!==this.SessionState.SESSION_RESUMED?Promise.reject(new ReferenceError("Session must be established.")):e.sendMessage(t,r)}return Promise.reject(new ReferenceError("Session must be cast.framework.CastSession."))}createCastButton(e){const t=document.createElement("button","google-cast-button");return e&&e.style&&(null===e.style["--disconnected-color"]&&(e.style["--disconnected-color"]="#00ADEF"),null===e.style["--connected-color"]&&(e.style["--connected-color"]="#E5E500")),e&&Object.keys(e).forEach(r=>{if("string"==typeof e[r])t.setAttribute(r,e[r]);else if("style"===r&&"object"==typeof e[r]){let n="";Object.keys(e[r]).forEach(t=>{n+=t+":"+e[r][t]+";"}),t.setAttribute(r,n)}}),t}createLoadRequest(e,t,r,n,i,s,a,o){const c=o?new chrome.cast.media.MediaInfo(o.contentId):new chrome.cast.media.MediaInfo(e.toString(),t);c.customData=s,c.duration=n;const u={subtitles:chrome.cast.media.TextTrackType.SUBTITLES,captions:chrome.cast.media.TextTrackType.CAPTIONS};c.tracks=a.map(e=>{const t=new chrome.cast.media.Track(e.id,chrome.cast.media.TrackType.TEXT);return t.trackContentId=e.url,t.trackContentType="text/vtt",t.subtype=u[e.kind],t.name=e.label,t.language=e.lang,t});const l=new chrome.cast.media.LoadRequest(c);return l.customData=o?o.customData:i,l.currentTime=r||0,o&&(l.credentials=o.credentials,l.credentialsType=o.credentialsType),l}}function Cd(e,t){return null==e||e!=e?t:e}function Od(e,t,r){this.constructorName="MessageApiError",this.message=e,this.name=t,this.source=r}function Nd(e){return e}function Md(e){if(!e||""===e)return{};if("object"==typeof e)return e;try{return JSON.parse(e)}catch(e){return{}}}function xd(e){}Od.prototype=new Error;let Ud={captureException(e){},captureMessage(e){},captureBreadcrumb(){}},Fd=Ud;var Vd={set:function(e){Fd=Object.assign({},Ud,e)},captureException:function(e,t){return Fd.captureException(e,t)},captureMessage:function(e,t){return Fd.captureMessage(e,t)},captureBreadcrumb:function(e,t,r="backbone",n="info"){return Fd.captureBreadcrumb(e,t,r,n)}};function jd(e={hidePrivateMethods:!0}){const t={},r={},n={parseMessage:Md,buildMessage:Nd,logError:xd};let i,s,a={};const o={get methods(){return t},extendMethods(...e){S.apply(void 0,[t].concat(e))},get listeners(){return a},set listeners(e){a=e},emit(e,...t){c.apply(void 0,[e].concat(t))&&h(u.apply(void 0,[e].concat(t)))},emitMethodEvent(e,t){h({method:e,value:t})},filter(e,t){t||"function"!=typeof e||(t=e,e=null),e?function(e,t){r.event=r.event||{},r.event[e]=r.event[e]||[],r.event[e].push(t)}(e,t):function(e){r.global=r.global||[],r.global.push(e)}(t)},hooks:(...e)=>S.apply(void 0,[n].concat(e)),configureClient(e,t){i=e,s=t},tearDown(){window.removeEventListener("message",l)}};function c(...e){if(r){let t,n;if(r.global&&r.global.length)for(t=0;t<r.global.length;t++)if(n=r.global[t],!n.apply(n,e))return!1;let i=e[0];if(r.event&&r.event[i]&&r.event[i].length)for(t=0;t<r.event[i].length;t++)if(n=r.event[i][t],!n.apply(n,e))return!1}return!0}function u(e,...t){const r={event:e};return t&&void 0!==t[0]&&(r.data=t[0]),r}function l(r){if(i!==r.source)return;let s=n.parseMessage(r.data),{method:a,value:o,id:c}=s;if(!(void 0===a||"string"!=typeof a||e.hidePrivateMethods&&a.indexOf("_")>-1))try{let e,i=function(e,t){if(!e)return null;let r=Object.getOwnPropertyDescriptor(t,e);if(r&&"function"==typeof r.value)return r.value;if(r&&"function"==typeof r.get)return r.get;const n=e.substr(0,3),i=e.substr(3,1).toLowerCase()+e.substr(4);return r=Object.getOwnPropertyDescriptor(t,i),"get"===n&&r&&"function"==typeof r.get?r.get:"set"===n&&r&&"function"==typeof r.set?r.set:null}(a,t);if(!i)throw new Od(`${r} is not a valid method. Valid methods are: ${function(e){return Object.keys(e).reduce((t,r)=>{if(r.indexOf("_")>-1)return t;const n=Object.getOwnPropertyDescriptor(e,r);return"function"==typeof n.value?(t.push(r),t):("function"==typeof n.get&&t.push("get"+r.charAt(0).toUpperCase()+r.slice(1)),"function"==typeof n.set&&t.push("set"+r.charAt(0).toUpperCase()+r.slice(1)),t)},[]).sort()}(t).join(", ")}.`,"TypeError",a);Vd.captureBreadcrumb("API message received",s,"api"),e=Array.isArray(o)?o:null==o?[]:[o],Promise.resolve(i.call.apply(i,[r].concat(p(e),[c]))).then(e=>{h({method:a,value:null==e?o:e})}).catch(n.logError)}catch(e){n.logError(e)}}function h(e){if(s&&function(e=window.parent){return!(!window.postMessage||!e.postMessage)}(i)){e=n.buildMessage(e);try{i.postMessage(e,s)}catch(e){}}}return window.addEventListener("message",l,!1),o}var Hd=self!==top,Bd=function(){var e=document.createElement("video"),t={request:["requestFullscreen","webkitRequestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen"],exit:["exitFullscreen","webkitCancelFullScreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"],enabled:["fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled"],element:["fullscreenElement","webkitFullscreenElement","webkitCurrentFullScreenElement","mozFullScreenElement","msFullscreenElement"],change:["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],error:["fullscreenerror","webkitfullscreenerror","mozfullscreenerror","MSFullscreenError"]},r={};for(var n in t)for(var i=0,s=t[n].length;i<s;i++)if(t[n][i]in e||t[n][i]in document||"on"+t[n][i].toLowerCase()in document){r[n]=t[n][i];break}return r}(),Xd={ENTER:"enter",EXIT:"exit",CHANGE:"change",ERROR:"error"},Wd=[],qd={};function Gd(){var e=Array.prototype.slice.apply(arguments),t=e.shift();qd[t].forEach(function(t){"function"==typeof t&&t.apply(t,e)})}function Kd(e){return function(t,r){-1!==Wd.indexOf(t)&&e.call(this,t,r)}}function Yd(e){var t=null;if("VIDEO"===e.tagName)t=e;else{var r=e.getElementsByTagName("video");r[0]&&(t=r[0])}return t}Object.keys(Xd).forEach(function(e){Wd.push(Xd[e]),qd[Xd[e]]=[]});var $d=null,zd=function(){},Qd=[];function Jd(e){var t=Yd(e);if(t&&t.webkitEnterFullscreen){try{t.readyState<t.HAVE_CURRENT_DATA?t.addEventListener("loadeddata",function r(){t.removeEventListener("loadeddata",r,!1);try{t.webkitEnterFullscreen()}catch(t){return tf("cannot_enter_fullscreen",e)}},!1):t.webkitEnterFullscreen(),$d=t}catch(t){return tf("not_supported",e)}return!0}return tf(void 0===Bd.request?"not_supported":"not_enabled",e)}var Zd=function(e){var t=Qd[Qd.length-1];t&&(e!==t.element&&e!==$d||!t.hasEntered)&&("VIDEO"===e.tagName&&($d=e),1===Qd.length&&rf.onenter(rf.element),t.enter.call(t.element,e||t.element),t.hasEntered=!0,Gd(Xd.ENTER,rf.element))},ef=function(){$d=null;var e=Qd.pop();e&&(e.exit.call(e.element),Gd(Xd.EXIT,e.element),rf.element||(Qd.forEach(function(e){e.exit.call(e.element),Gd(Xd.EXIT,e.element)}),Qd=[],rf.onexit()))},tf=function(e,t){if(Qd.length>0){var r=Qd.pop();t=t||r.element,r.error.call(t,e),rf.onerror(t,e),Gd(Xd.ERROR,t,e)}},rf={request:function(e,t,r,n){if(e=e||document.body,Qd.push({element:e,enter:t||zd,exit:r||zd,error:n||zd}),void 0===Bd.request)return Jd(e);if(Hd&&!1===document[Bd.enabled])return Jd(e);try{e[Bd.request]()}catch(t){tf("not_enabled",e)}},exit:function(){!document[Bd.exit]&&rf.element?rf.element[Bd.exit]():document[Bd.exit]()},toggle:function(e,t,r,n){rf.element?rf.exit():rf.request(e,t,r,n)},videoEnabled:function(e){if(rf.enabled)return!0;var t=Yd(e=e||document.body);return!(!t||void 0===t.webkitSupportsFullscreen)&&(t.readyState<t.HAVE_METADATA?"maybe":t.webkitSupportsFullscreen)},on:Kd(function(e,t){qd[e].push(t)}),off:Kd(function(e,t){var r=qd[e].indexOf(t);r>-1&&qd[e].splice(r,1)}),onenter:zd,onexit:zd,onchange:zd,onerror:zd};try{Object.defineProperties(rf,{element:{enumerable:!0,get:function(){return $d&&$d.webkitDisplayingFullscreen?$d:document[Bd.element]||null}},enabled:{enumerable:!0,get:function(){return document[Bd.enabled]||!1}}})}catch(e){rf.element=null,rf.enabled=!1}function nf(){return window.parent!=window}Bd.change&&document.addEventListener(Bd.change,function(e){if(rf.onchange(rf.element),Gd(Xd.CHANGE,rf.element),rf.element){var t=Qd[Qd.length-2];t&&t.element===rf.element?ef():Zd(rf.element)}else ef()},!1),document.addEventListener("webkitbeginfullscreen",function(e){var t=!0;if(Qd.length>0)for(var r=0,n=Qd.length;r<n;r++)if(Yd(Qd[r].element)===e.srcElement){t=!1;break}t&&Qd.push({element:e.srcElement,enter:zd,exit:zd,error:zd}),rf.onchange(e.srcElement),Gd(Xd.CHANGE,rf.srcElement),Zd(e.srcElement)},!0),document.addEventListener("webkitendfullscreen",function(e){rf.onchange(e.srcElement),Gd(Xd.CHANGE,e.srcElement),ef(e.srcElement)},!0),Bd.error&&document.addEventListener(Bd.error,function(e){tf("not_allowed")},!1);var sf=Object.prototype.hasOwnProperty,af=Di(function(e,t){if(tn(t)||on(t))kr(t,cn(t),e);else for(var r in t)sf.call(t,r)&&Lr(e,r,t[r])}),of="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function cf(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&r.path)}},r.exports),r.exports}var uf=cf(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Tracker=void 0;var r=function(){function e(){}return e.getAttributeTypeMap=function(){return e.attributeTypeMap},e.attributeTypeMap=[{name:"name",baseName:"name",type:"string"},{name:"version",baseName:"version",type:"string"}],e}();t.Tracker=r});let lf;const hf=new Uint8Array(16);function df(){if(!lf&&(lf="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!lf))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return lf(hf)}var ff=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function _f(e){return"string"==typeof e&&ff.test(e)}const pf=[];for(let e=0;e<256;++e)pf.push((e+256).toString(16).slice(1));function vf(e,t=0){return pf[e[t+0]]+pf[e[t+1]]+pf[e[t+2]]+pf[e[t+3]]+"-"+pf[e[t+4]]+pf[e[t+5]]+"-"+pf[e[t+6]]+pf[e[t+7]]+"-"+pf[e[t+8]]+pf[e[t+9]]+"-"+pf[e[t+10]]+pf[e[t+11]]+pf[e[t+12]]+pf[e[t+13]]+pf[e[t+14]]+pf[e[t+15]]}let mf,gf,Ef=0,Tf=0;function yf(e){if(!_f(e))throw TypeError("Invalid UUID");let t;const r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r}function Sf(e,t,r){function n(e,n,i,s){var a;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof n&&(n=yf(n)),16!==(null===(a=n)||void 0===a?void 0:a.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let o=new Uint8Array(16+e.length);if(o.set(n),o.set(e,n.length),o=r(o),o[6]=15&o[6]|t,o[8]=63&o[8]|128,i){s=s||0;for(let e=0;e<16;++e)i[s+e]=o[e];return i}return vf(o)}try{n.name=e}catch(e){}return n.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",n.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",n}function bf(e){return 14+(e+64>>>9<<4)+1}function Af(e,t){const r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function If(e,t,r,n,i,s){return Af(function(e,t){return e<<t|e>>>32-t}(Af(Af(t,e),Af(n,s)),i),r)}function wf(e,t,r,n,i,s,a){return If(t&r|~t&n,e,t,i,s,a)}function Rf(e,t,r,n,i,s,a){return If(t&n|r&~n,e,t,i,s,a)}function Pf(e,t,r,n,i,s,a){return If(t^r^n,e,t,i,s,a)}function Df(e,t,r,n,i,s,a){return If(r^(t|~n),e,t,i,s,a)}const Lf=Sf("v3",48,function(e){if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let r=0;r<t.length;++r)e[r]=t.charCodeAt(r)}return function(e){const t=[],r=32*e.length,n="0123456789abcdef";for(let i=0;i<r;i+=8){const r=e[i>>5]>>>i%32&255,s=parseInt(n.charAt(r>>>4&15)+n.charAt(15&r),16);t.push(s)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[bf(t)-1]=t;let r=1732584193,n=-271733879,i=-1732584194,s=271733878;for(let t=0;t<e.length;t+=16){const a=r,o=n,c=i,u=s;r=wf(r,n,i,s,e[t],7,-680876936),s=wf(s,r,n,i,e[t+1],12,-389564586),i=wf(i,s,r,n,e[t+2],17,606105819),n=wf(n,i,s,r,e[t+3],22,-1044525330),r=wf(r,n,i,s,e[t+4],7,-176418897),s=wf(s,r,n,i,e[t+5],12,1200080426),i=wf(i,s,r,n,e[t+6],17,-1473231341),n=wf(n,i,s,r,e[t+7],22,-45705983),r=wf(r,n,i,s,e[t+8],7,1770035416),s=wf(s,r,n,i,e[t+9],12,-1958414417),i=wf(i,s,r,n,e[t+10],17,-42063),n=wf(n,i,s,r,e[t+11],22,-1990404162),r=wf(r,n,i,s,e[t+12],7,1804603682),s=wf(s,r,n,i,e[t+13],12,-40341101),i=wf(i,s,r,n,e[t+14],17,-1502002290),n=wf(n,i,s,r,e[t+15],22,1236535329),r=Rf(r,n,i,s,e[t+1],5,-165796510),s=Rf(s,r,n,i,e[t+6],9,-1069501632),i=Rf(i,s,r,n,e[t+11],14,643717713),n=Rf(n,i,s,r,e[t],20,-373897302),r=Rf(r,n,i,s,e[t+5],5,-701558691),s=Rf(s,r,n,i,e[t+10],9,38016083),i=Rf(i,s,r,n,e[t+15],14,-660478335),n=Rf(n,i,s,r,e[t+4],20,-405537848),r=Rf(r,n,i,s,e[t+9],5,568446438),s=Rf(s,r,n,i,e[t+14],9,-1019803690),i=Rf(i,s,r,n,e[t+3],14,-187363961),n=Rf(n,i,s,r,e[t+8],20,1163531501),r=Rf(r,n,i,s,e[t+13],5,-1444681467),s=Rf(s,r,n,i,e[t+2],9,-51403784),i=Rf(i,s,r,n,e[t+7],14,1735328473),n=Rf(n,i,s,r,e[t+12],20,-1926607734),r=Pf(r,n,i,s,e[t+5],4,-378558),s=Pf(s,r,n,i,e[t+8],11,-2022574463),i=Pf(i,s,r,n,e[t+11],16,1839030562),n=Pf(n,i,s,r,e[t+14],23,-35309556),r=Pf(r,n,i,s,e[t+1],4,-1530992060),s=Pf(s,r,n,i,e[t+4],11,1272893353),i=Pf(i,s,r,n,e[t+7],16,-155497632),n=Pf(n,i,s,r,e[t+10],23,-1094730640),r=Pf(r,n,i,s,e[t+13],4,681279174),s=Pf(s,r,n,i,e[t],11,-358537222),i=Pf(i,s,r,n,e[t+3],16,-722521979),n=Pf(n,i,s,r,e[t+6],23,76029189),r=Pf(r,n,i,s,e[t+9],4,-640364487),s=Pf(s,r,n,i,e[t+12],11,-421815835),i=Pf(i,s,r,n,e[t+15],16,530742520),n=Pf(n,i,s,r,e[t+2],23,-995338651),r=Df(r,n,i,s,e[t],6,-198630844),s=Df(s,r,n,i,e[t+7],10,1126891415),i=Df(i,s,r,n,e[t+14],15,-1416354905),n=Df(n,i,s,r,e[t+5],21,-57434055),r=Df(r,n,i,s,e[t+12],6,1700485571),s=Df(s,r,n,i,e[t+3],10,-1894986606),i=Df(i,s,r,n,e[t+10],15,-1051523),n=Df(n,i,s,r,e[t+1],21,-2054922799),r=Df(r,n,i,s,e[t+8],6,1873313359),s=Df(s,r,n,i,e[t+15],10,-30611744),i=Df(i,s,r,n,e[t+6],15,-1560198380),n=Df(n,i,s,r,e[t+13],21,1309151649),r=Df(r,n,i,s,e[t+4],6,-145523070),s=Df(s,r,n,i,e[t+11],10,-1120210379),i=Df(i,s,r,n,e[t+2],15,718787259),n=Df(n,i,s,r,e[t+9],21,-343485551),r=Af(r,a),n=Af(n,o),i=Af(i,c),s=Af(s,u)}return[r,n,i,s]}(function(e){if(0===e.length)return[];const t=8*e.length,r=new Uint32Array(bf(t));for(let n=0;n<t;n+=8)r[n>>5]|=(255&e[n/8])<<n%32;return r}(e),8*e.length))});var kf={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function Cf(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:case 3:return t^r^n;case 2:return t&r^t&n^r&n}}function Of(e,t){return e<<t|e>>>32-t}const Nf=Sf("v5",80,function(e){const t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const n=e.length/4+2,i=Math.ceil(n/16),s=new Array(i);for(let t=0;t<i;++t){const r=new Uint32Array(16);for(let n=0;n<16;++n)r[n]=e[64*t+4*n]<<24|e[64*t+4*n+1]<<16|e[64*t+4*n+2]<<8|e[64*t+4*n+3];s[t]=r}s[i-1][14]=8*(e.length-1)/Math.pow(2,32),s[i-1][14]=Math.floor(s[i-1][14]),s[i-1][15]=8*(e.length-1)&4294967295;for(let e=0;e<i;++e){const n=new Uint32Array(80);for(let t=0;t<16;++t)n[t]=s[e][t];for(let e=16;e<80;++e)n[e]=Of(n[e-3]^n[e-8]^n[e-14]^n[e-16],1);let i=r[0],a=r[1],o=r[2],c=r[3],u=r[4];for(let e=0;e<80;++e){const r=Math.floor(e/20),s=Of(i,5)+Cf(r,a,o,c)+u+t[r]+n[e]>>>0;u=c,c=o,o=Of(a,30)>>>0,a=i,i=s}r[0]=r[0]+i>>>0,r[1]=r[1]+a>>>0,r[2]=r[2]+o>>>0,r[3]=r[3]+c>>>0,r[4]=r[4]+u>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]});var Mf=Object.freeze({__proto__:null,v1:function(e,t,r){let n=t&&r||0;const i=t||new Array(16);let s=(e=e||{}).node||mf,a=void 0!==e.clockseq?e.clockseq:gf;if(null==s||null==a){const t=e.random||(e.rng||df)();null==s&&(s=mf=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==a&&(a=gf=16383&(t[6]<<8|t[7]))}let o=void 0!==e.msecs?e.msecs:Date.now(),c=void 0!==e.nsecs?e.nsecs:Tf+1;const u=o-Ef+(c-Tf)/1e4;if(u<0&&void 0===e.clockseq&&(a=a+1&16383),(u<0||o>Ef)&&void 0===e.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Ef=o,Tf=c,gf=a,o+=122192928e5;const l=(1e4*(268435455&o)+c)%4294967296;i[n++]=l>>>24&255,i[n++]=l>>>16&255,i[n++]=l>>>8&255,i[n++]=255&l;const h=o/4294967296*1e4&268435455;i[n++]=h>>>8&255,i[n++]=255&h,i[n++]=h>>>24&15|16,i[n++]=h>>>16&255,i[n++]=a>>>8|128,i[n++]=255&a;for(let e=0;e<6;++e)i[n+e]=s[e];return t||vf(i)},v3:Lf,v4:function(e,t,r){if(kf.randomUUID&&!t&&!e)return kf.randomUUID();const n=(e=e||{}).random||(e.rng||df)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return vf(n)},v5:Nf,NIL:"00000000-0000-0000-0000-000000000000",version:function(e){if(!_f(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)},validate:_f,stringify:function(e,t=0){const r=vf(e,t);if(!_f(r))throw TypeError("Stringified UUID is invalid");return r},parse:yf}),xf=function(e){return e&&e.default||e}(Mf),Uf=cf(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Envelope=void 0;var r=function(){function e(e,t){this.event=e,this.eid=(0,xf.v4)(),this.ts_ms=Date.now(),this.created_at=Date.now(),this._tracker=new uf.Tracker,this._globalBPO=t}return Object.defineProperty(e.prototype,"tracker",{get:function(){return this._tracker},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"global",{get:function(){return this._globalBPO},enumerable:!1,configurable:!0}),e.getAttributeTypeMap=function(){return e.attributeTypeMap},e.attributeTypeMap=[{name:"eid",baseName:"eid",type:"string"},{name:"ts_ms",baseName:"ts_ms",type:"number"},{name:"created_at",baseName:"created_at",type:"number"},{name:"event",baseName:"event",type:"Event"},{name:"global",baseName:"global",type:"Event"},{name:"tracker",baseName:"tracker",type:"Tracker"}],e}();t.Envelope=r}),Ff=cf(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Event=void 0;var r=function(){function e(e,t,r){this.name=e,this.ts_ms=Date.now(),this.version=t,this.fields=r}return e.getAttributeTypeMap=function(){return e.attributeTypeMap},e.attributeTypeMap=[{name:"name",baseName:"name",type:"string"},{name:"ts_ms",baseName:"ts_ms",type:"number"},{name:"version",baseName:"version",type:"number"},{name:"fields",baseName:"fields",type:"object"}],e}();t.Event=r}),Vf=cf(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EventContext=void 0;var r=function(){function e(e,t,r){this.name=e,this.ts_ms=Date.now(),this.version=t,this.fields=r}return e.getAttributeTypeMap=function(){return e.attributeTypeMap},e.attributeTypeMap=[{name:"name",baseName:"name",type:"string"},{name:"ts_ms",baseName:"ts_ms",type:"number"},{name:"version",baseName:"version",type:"number"},{name:"fields",baseName:"fields",type:"object"}],e}();t.EventContext=r}),jf=cf(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalContext=void 0;t.GlobalContext=function(e,t,r){this.name=e,this.ts_ms=Date.now(),this.version=t,this.fields=r}}),Hf=cf(function(e,t){var r=of&&of.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),n=of&&of.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectSerializer=void 0,n(Uf,t),n(Ff,t),n(Vf,t),n(uf,t),n(jf,t);var i=Ff,s=Vf,a=uf,o=["string","boolean","double","integer","long","float","number","any"],c={},u={Envelope:Uf.Envelope,Event:i.Event,Tracker:a.Tracker,EventContext:s.EventContext},l=function(){function e(){}return e.findCorrectType=function(e,t){if(null==e)return t;if(-1!==o.indexOf(t.toLowerCase()))return t;if("Date"===t)return t;if(c[t])return t;if(!u[t])return t;var r=u[t].discriminator;if(null==r)return t;if(e[r]){var n=e[r];return u[n]?n:t}return t},e.serialize=function(t,r){if(null==t)return t;if(-1!==o.indexOf(r.toLowerCase()))return t;if(0===r.lastIndexOf("Array<",0)){var n=r.replace("Array<","");n=n.substring(0,n.length-1);var i=[];for(var s in t){var a=t[s];i.push(e.serialize(a,n))}return i}if("Date"===r)return t.toISOString();if(c[r])return t;if(!u[r])return t;r=this.findCorrectType(t,r);var l=u[r].getAttributeTypeMap(),h={};for(var s in l){var d=l[s];h[d.baseName]=e.serialize(t[d.name],d.type)}return h},e.deserialize=function(t,r){if(r=e.findCorrectType(t,r),null==t)return t;if(-1!==o.indexOf(r.toLowerCase()))return t;if(0===r.lastIndexOf("Array<",0)){var n=r.replace("Array<","");n=n.substring(0,n.length-1);var i=[];for(var s in t){var a=t[s];i.push(e.deserialize(a,n))}return i}if("Date"===r)return new Date(t);if(c[r])return t;if(!u[r])return t;var l=new u[r],h=u[r].getAttributeTypeMap();for(var s in h){var d=h[s];l[d.name]=e.deserialize(t[d.baseName],d.type)}return l},e}();t.ObjectSerializer=l}),Bf=cf(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.formatRequestEvent=t.parseJwt=t.getCookie=void 0,t.getCookie=function(e){if("undefined"==typeof document)return null;var t=document.cookie.match(new RegExp("(;\\s)?".concat(e,"=")));if(!t||0==t.length||void 0===t.index)return null;var r=document.cookie.indexOf(";",t.index+1),n=t.index+t[0].length,i=-1===r?document.cookie.substr(n):document.cookie.substring(n,r);return decodeURIComponent(i)},t.parseJwt=function(e){var t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(atob(t).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(r)},t.formatRequestEvent=function(e){var t=e.split(".");if(t.length<=2)return e;var r=t.pop();return"".concat(t.join("_"),".").concat(r)}}),Xf=cf(function(e,t){var r,n=of&&of.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function a(e){try{c(n.next(e))}catch(e){s(e)}}function o(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(a,o)}c((n=n.apply(e,t||[])).next())})},i=of&&of.__generator||function(e,t){var r,n,i,s,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(c){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(a=0)),a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},s=of&&of.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=of&&of.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return a};Object.defineProperty(t,"__esModule",{value:!0}),t.BigPictureClient=t.Configuration=t.Service=void 0,function(e){e.FRESNEL_PROD="https://fresnel-events.vimeocdn.com",e.FRESNEL_PROD_CN="https://fresnel-events.videoji.cn",e.FRESNEL_DEV="https://fresnel-event-staging.vimeows.com",e.EVENTS_PROD="https://lensflare.vimeo.com"}(r=t.Service||(t.Service={}));var o=function(e,t,r,n){void 0===t&&(t=null),void 0===r&&(r=null),void 0===n&&(n=""),this.service=e,this.globalBPO=t,this.contexts=r,this.endpoint=n};t.Configuration=o;var c=function(){function e(){}return Object.defineProperty(e,"isInitalized",{get:function(){return Boolean(e.conf.globalBPO)},enumerable:!1,configurable:!0}),e.configure=function(t){e.conf=t,e.WAIT_QUEUE.length>0&&(e.WAIT_QUEUE.map(function(t){var r=t.event,n=t.contexts;n?e.sendEventWithContexts(r,n):e.sendEvent(r)}),e.WAIT_QUEUE=[])},e.updateObject=function(t,r){return n(this,void 0,void 0,function(){var n,o,c,u,l,h,d;return i(this,function(i){try{for(n=s(Object.entries(t)),o=n.next();!o.done;o=n.next())if(c=a(o.value,2),u=c[0],l=c[1],u in r){if(l instanceof Object)return r[u]instanceof Object?(e.updateObject(l,r[u]),[2]):(r[u]=l,[2]);r[u]=l}}catch(e){h={error:e}}finally{try{o&&!o.done&&(d=n.return)&&d.call(n)}finally{if(h)throw h.error}}return[2]})})},e.updateContext=function(t){return n(this,void 0,void 0,function(){return i(this,function(r){return"global"==t.context&&e.conf.globalBPO&&e.updateObject(t.fields,e.conf.globalBPO.fields),[2]})})},e.sendEvent=function(t,r){return n(this,void 0,void 0,function(){var n,s,a,o,c,u;return i(this,function(i){switch(i.label){case 0:if(null==t)throw new Error("Required parameter event was null or undefined when calling sendEvent.");return e.isInitalized?(n=JSON.stringify(Hf.ObjectSerializer.serialize([new Uf.Envelope(t,this.conf.globalBPO)],"Array<Envelope>")),s=(0,Bf.formatRequestEvent)(t.name),a=""!==this.conf.endpoint?this.conf.endpoint:this.conf.service,o="".concat(a,"/add/").concat(encodeURIComponent(s)),navigator.sendBeacon&&!r?[3,2]:(c={method:"POST",headers:{"Content-Type":"application/json","User-Agent":navigator.userAgent,Origin:location.origin,Referer:document.referrer},body:n},r&&(c.headers.Authorization=r),[4,fetch(o,c)])):(e.WAIT_QUEUE.push({event:t}),e.waitAndFlushQueue(),[2]);case 1:return i.sent(),[3,3];case 2:u=new Blob([n]),navigator.sendBeacon(o,u),i.label=3;case 3:return[2]}})})},e.sendEventWithContexts=function(t,r,o){return n(this,void 0,void 0,function(){var n,c,u,l,h,d,f,_,p,v,m,g,E,T,y,S;return i(this,function(i){switch(i.label){case 0:if(null==t)throw new Error("Required parameter event was null or undefined when calling sendEvent.");if(!e.isInitalized)return e.WAIT_QUEUE.push({event:t,contexts:r}),e.waitAndFlushQueue(),[2];n=new Uf.Envelope(t,this.conf.globalBPO),(c=Hf.ObjectSerializer.serialize([n],"Array<Envelope>"))[0].contexts={};try{for(u=s(Object.entries(r)),l=u.next();!l.done;l=u.next())h=a(l.value,2),d=h[0],f=h[1],_=Hf.ObjectSerializer.serialize(f,"EventContext"),c[0].contexts[d]=_}catch(e){y={error:e}}finally{try{l&&!l.done&&(S=u.return)&&S.call(u)}finally{if(y)throw y.error}}return p=JSON.stringify(c),v=(0,Bf.formatRequestEvent)(t.name),m=""!==this.conf.endpoint?this.conf.endpoint:this.conf.service,g="".concat(m,"/add/").concat(encodeURIComponent(v)),navigator.sendBeacon&&!o?[3,2]:(E={method:"POST",headers:{"Content-Type":"application/json","User-Agent":navigator.userAgent,Origin:location.origin,Referer:document.referrer},body:p},o&&(E.headers.Authorization=o),[4,fetch(g,E)]);case 1:return i.sent(),[3,3];case 2:T=new Blob([p]),navigator.sendBeacon(g,T),i.label=3;case 3:return[2]}})})},e.waitAndFlushQueue=function(){e.flushQueueTimeoutHandler||(e.flushQueueTimeoutHandler=setTimeout(function(){e.WAIT_QUEUE.length>0&&(e.WAIT_QUEUE=[])},e.FLUSH_QUEUE_TIMEOUT))},e.FLUSH_QUEUE_TIMEOUT=1e4,e.conf=new o(r.FRESNEL_PROD),e.WAIT_QUEUE=[],e}();t.BigPictureClient=c}),Wf=cf(function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),qf=cf(function(e,t){var r=of&&of.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),n=of&&of.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),n(Xf,t),n(Hf,t),n(Wf,t)});const Gf=function(e){return(t,...r)=>(r.forEach(r=>{for(const n in r){const i=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,Object.assign(i,e))}}),t)}({enumerable:!0,configurable:!0,writeable:!1}),Kf={AD_BUFFERING:"ad-buffering",AD_CAN_PLAY:"ad-can-play",AD_COMPLETE:"ad-complete",AD_CLICK:"ad-click",AD_SKIPPED:"ad-skipped",ALL_ADS_COMPLETED:"all-ads-completed",AD_ERROR:"ad-error",AD_STARTED:"ad-started",ADS_MANAGER_LOADED:"ads-manager-loaded",CONTENT_PAUSE_REQUESTED:"content-pause-requested",CONTENT_RESUME_REQUESTED:"content-resume-requested"};function Yf(e,t){const r=new Ir;let n,i,s,a,o,c,u=!1,l=1,h=!1;function d(){return ue.iOS?t.videoPlayer.videoElement:t.videoPlayer}function f(){a=new c.AdsRequest,t.adUrl&&(a.adTagUrl=t.adUrl),a.linearAdSlotWidth=t.width.linear,a.linearAdSlotHeight=t.height.linear,a.nonLinearAdSlotWidth=t.width.nonlinear,a.nonLinearAdSlotHeight=t.height.nonlinear,a.setAdWillAutoPlay(t.autoplay),a.setAdWillPlayMuted(t.muted),i.requestAds(a)}function _(e){const t=new c.AdsRenderingSettings;t.restoreCustomPlaybackStateOnAdBreakComplete=!0,t.uiElements=[],t.enablePreloading=!0,s=e.getAdsManager(d(),t);const n=h&&o?0:1;s.setVolume(n),r.fire(Kf.ADS_MANAGER_LOADED),s.addEventListener(c.AdErrorEvent.Type.AD_ERROR,P),s.addEventListener(c.AdEvent.Type.CONTENT_PAUSE_REQUESTED,E),s.addEventListener(c.AdEvent.Type.CONTENT_RESUME_REQUESTED,T),s.addEventListener(c.AdEvent.Type.AD_BUFFERING,y),s.addEventListener(c.AdEvent.Type.AD_CAN_PLAY,S),s.addEventListener(c.AdEvent.Type.STARTED,b),s.addEventListener(c.AdEvent.Type.COMPLETE,A),s.addEventListener(c.AdEvent.Type.CLICK,I),s.addEventListener(c.AdEvent.Type.SKIPPED,w),s.addEventListener(c.AdEvent.Type.ALL_ADS_COMPLETED,R)}function p(){t.videoPlayer.pause(),h=!0,o=!1,f()}function v(){t.videoPlayer.volume=0,t.videoPlayer.muted=!0;const e=t.videoPlayer.play();void 0!==e&&e.then(m).catch(g)}function m(){t.videoPlayer.pause(),h=!0,o=!0,f()}function g(){t.videoPlayer.volume=1,t.videoPlayer.muted=!1,h=!1,o=!1,f()}function E(e){r.fire(Kf.CONTENT_PAUSE_REQUESTED,e)}function T(e){r.fire(Kf.CONTENT_RESUME_REQUESTED,e)}function y(e){r.fire(Kf.AD_BUFFERING,e)}function S(e){r.fire(Kf.AD_CAN_PLAY,e)}function b(e){r.fire(Kf.AD_STARTED,e)}function A(e){r.fire(Kf.AD_COMPLETE,e)}function I(e){s.pause(),r.fire(Kf.AD_CLICK,e)}function w(e){r.fire(Kf.AD_SKIPPED,e)}function R(e){r.fire(Kf.ALL_ADS_COMPLETED,e)}function P(e){r.fire(Kf.AD_ERROR,e.getError()),s&&s.destroy()}const D={isAutoPlayAllowed:()=>h,start:(e,t)=>(u||(n.initialize(),u=!0),s.init(e,t,c.ViewMode.NORMAL),s.start()),stop:()=>s.stop(),pause:()=>s.pause(),play:()=>s.resume(),skip:()=>s.skip(),resize:(e,t,r)=>r?s.resize(e,t,c.ViewMode.FULLSCREEN):s.resize(e,t,c.ViewMode.NORMAL),destroy(){r.off(),s.destroy(),i.destroy(),n.destroy()},get volume(){return F(s.getVolume())},set volume(e){l=U(e),s.setVolume(l)},get muted(){return 0===s.getVolume()},set muted(e){e?s.setVolume(0):s.setVolume(l)},get remainingTime(){return s.getRemainingTime()},setContentComplete(){i&&i.contentComplete()},on(e,t){return r.on(e,t),this},off(e,t){return r.off(e,t),this}};return function(e,t,r){if(document.getElementById(e))r&&r();else{const t=document.createElement("script");t.id=e,t.src="https://imasdk.googleapis.com/js/sdkloader/ima3.js",t.onload=()=>{r&&r()},document.getElementsByTagName("body")[0].appendChild(t)}}("vp-ima-sdk",0,function(){c=google.ima,n=new c.AdDisplayContainer(e,d()),i=new c.AdsLoader(n),i.addEventListener(c.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,_,!1),i.addEventListener(c.AdErrorEvent.Type.AD_ERROR,P,!1),function(){const e=t.videoPlayer.play();void 0!==e&&e.then(p).catch(v)}()}),Gf(this,D)}function $f(e,t,r,n){if(!Tt(e))return e;for(var i=-1,s=(t=Jt(t,e)).length,a=s-1,o=e;null!=o&&++i<s;){var c=Zt(t[i]),u=r;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(i!=a){var l=o[c];void 0===(u=n?n(l,c,o):void 0)&&(u=Tt(l)?l:Br(t[i+1])?[]:{})}Lr(o,c,u),o=o[c]}return e}function zf(e,t){return null!=e&&t in Object(e)}function Qf(e,t){return function(e,t,r){for(var n=-1,i=t.length,s={};++n<i;){var a=t[n],o=er(e,a);r(0,a)&&$f(s,Jt(a,e),o)}return s}(e,t,function(t,r){return function(e,t){return null!=e&&function(e,t,r){for(var n=-1,i=(t=Jt(t,e)).length,s=!1;++n<i;){var a=Zt(t[n]);if(!(s=null!=e&&r(e,a)))break;e=e[a]}return s||++n!=i?s:!!(i=null==e?0:e.length)&&Xr(i)&&Br(a,i)&&(it(e)||xr(e))}(e,t,zf)}(e,r)})}var Jf=ct?ct.isConcatSpreadable:void 0;function Zf(e){return it(e)||xr(e)||!!(Jf&&e&&e[Jf])}function e_(e,t,r,n,i){var s=-1,a=e.length;for(r||(r=Zf),i||(i=[]);++s<a;){var o=e[s];t>0&&r(o)?t>1?e_(o,t-1,r,n,i):yn(i,o):n||(i[i.length]=o)}return i}function t_(e){return null!=e&&e.length?e_(e,1):[]}var r_,n_,i_,s_,a_,o_,c_,u_,l_,h_,d_,f_=function(e){return vi(di(e,void 0,t_),e+"")}(function(e,t){return null==e?{}:Qf(e,t)}),__=function(e,t){return{name:e,value:void 0===t?-1:t,delta:0,entries:[],id:"v2-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)}},p_=function(e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){if("first-input"===e&&!("PerformanceEventTiming"in self))return;var r=new PerformanceObserver(function(e){return e.getEntries().map(t)});return r.observe({type:e,buffered:!0}),r}}catch(e){}},v_=function(e,t){var r=function r(n){"pagehide"!==n.type&&"hidden"!==document.visibilityState||(e(n),t&&(removeEventListener("visibilitychange",r,!0),removeEventListener("pagehide",r,!0)))};addEventListener("visibilitychange",r,!0),addEventListener("pagehide",r,!0)},m_=function(e){addEventListener("pageshow",function(t){t.persisted&&e(t)},!0)},g_=function(e,t,r){var n;return function(i){t.value>=0&&(i||r)&&(t.delta=t.value-(n||0),(t.delta||void 0===n)&&(n=t.value,e(t)))}},E_=-1,T_=function(){return"hidden"===document.visibilityState?0:1/0},y_=function(){v_(function(e){var t=e.timeStamp;E_=t},!0)},S_=function(){return E_<0&&(E_=T_(),y_(),m_(function(){setTimeout(function(){E_=T_(),y_()},0)})),{get firstHiddenTime(){return E_}}},b_=function(e,t){var r,n=S_(),i=__("FCP"),s=function(e){"first-contentful-paint"===e.name&&(o&&o.disconnect(),e.startTime<n.firstHiddenTime&&(i.value=e.startTime,i.entries.push(e),r(!0)))},a=window.performance&&performance.getEntriesByName&&performance.getEntriesByName("first-contentful-paint")[0],o=a?null:p_("paint",s);(a||o)&&(r=g_(e,i,t),a&&s(a),m_(function(n){i=__("FCP"),r=g_(e,i,t),requestAnimationFrame(function(){requestAnimationFrame(function(){i.value=performance.now()-n.timeStamp,r(!0)})})}))},A_=!1,I_=-1,w_=function(e,t){A_||(b_(function(e){I_=e.value}),A_=!0);var r,n=function(t){I_>-1&&e(t)},i=__("CLS",0),s=0,a=[],o=function(e){if(!e.hadRecentInput){var t=a[0],n=a[a.length-1];s&&e.startTime-n.startTime<1e3&&e.startTime-t.startTime<5e3?(s+=e.value,a.push(e)):(s=e.value,a=[e]),s>i.value&&(i.value=s,i.entries=a,r())}},c=p_("layout-shift",o);c&&(r=g_(n,i,t),v_(function(){c.takeRecords().map(o),r(!0)}),m_(function(){s=0,I_=-1,i=__("CLS",0),r=g_(n,i,t)}))},R_={passive:!0,capture:!0},P_=new Date,D_=function(e,t){r_||(r_=t,n_=e,i_=new Date,C_(removeEventListener),L_())},L_=function(){if(n_>=0&&n_<i_-P_){var e={entryType:"first-input",name:r_.type,target:r_.target,cancelable:r_.cancelable,startTime:r_.timeStamp,processingStart:r_.timeStamp+n_};s_.forEach(function(t){t(e)}),s_=[]}},k_=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var r=function(){D_(e,t),i()},n=function(){i()},i=function(){removeEventListener("pointerup",r,R_),removeEventListener("pointercancel",n,R_)};addEventListener("pointerup",r,R_),addEventListener("pointercancel",n,R_)}(t,e):D_(t,e)}},C_=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach(function(t){return e(t,k_,R_)})},O_=function(e,t){var r,n=S_(),i=__("FID"),s=function(e){e.startTime<n.firstHiddenTime&&(i.value=e.processingStart-e.startTime,i.entries.push(e),r(!0))},a=p_("first-input",s);r=g_(e,i,t),a&&v_(function(){a.takeRecords().map(s),a.disconnect()},!0),a&&m_(function(){var n;i=__("FID"),r=g_(e,i,t),s_=[],n_=-1,r_=null,C_(addEventListener),n=s,s_.push(n),L_()})},N_={},M_=function(e,t){var r,n=S_(),i=__("LCP"),s=function(e){var t=e.startTime;t<n.firstHiddenTime&&(i.value=t,i.entries.push(e),r())},a=p_("largest-contentful-paint",s);if(a){r=g_(e,i,t);var o=function(){N_[i.id]||(a.takeRecords().map(s),a.disconnect(),N_[i.id]=!0,r(!0))};["keydown","click"].forEach(function(e){addEventListener(e,o,{once:!0,capture:!0})}),v_(o,!0),m_(function(n){i=__("LCP"),r=g_(e,i,t),requestAnimationFrame(function(){requestAnimationFrame(function(){i.value=performance.now()-n.timeStamp,N_[i.id]=!0,r(!0)})})})}},x_={},U_=[],F_=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function V_(e,t){for(var r in t)e[r]=t[r];return e}function j_(e){var t=e.parentNode;t&&t.removeChild(e)}function H_(e,t,r){var n,i,s,a={};for(s in t)"key"==s?n=t[s]:"ref"==s?i=t[s]:a[s]=t[s];if(arguments.length>2&&(a.children=arguments.length>3?a_.call(arguments,2):r),"function"==typeof e&&null!=e.defaultProps)for(s in e.defaultProps)void 0===a[s]&&(a[s]=e.defaultProps[s]);return B_(e,a,n,i,null)}function B_(e,t,r,n,i){var s={type:e,props:t,key:r,ref:n,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==i?++c_:i};return null==i&&null!=o_.vnode&&o_.vnode(s),s}function X_(e){return e.children}function W_(e,t){this.props=e,this.context=t}function q_(e,t){if(null==t)return e.__?q_(e.__,e.__.__k.indexOf(e)+1):null;for(var r;t<e.__k.length;t++)if(null!=(r=e.__k[t])&&null!=r.__e)return r.__e;return"function"==typeof e.type?q_(e):null}function G_(e){var t,r;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(r=e.__k[t])&&null!=r.__e){e.__e=e.__c.base=r.__e;break}return G_(e)}}function K_(e){(!e.__d&&(e.__d=!0)&&u_.push(e)&&!Y_.__r++||h_!==o_.debounceRendering)&&((h_=o_.debounceRendering)||l_)(Y_)}function Y_(){for(var e;Y_.__r=u_.length;)e=u_.sort(function(e,t){return e.__v.__b-t.__v.__b}),u_=[],e.some(function(e){var t,r,n,i,s,a;e.__d&&(s=(i=(t=e).__v).__e,(a=t.__P)&&(r=[],(n=V_({},i)).__v=i.__v+1,np(a,i,n,t.__n,void 0!==a.ownerSVGElement,null!=i.__h?[s]:null,r,null==s?q_(i):s,i.__h),ip(r,i),i.__e!=s&&G_(i)))})}function $_(e,t,r,n,i,s,a,o,c,u){var l,h,d,f,_,p,v,m=n&&n.__k||U_,g=m.length;for(r.__k=[],l=0;l<t.length;l++)if(null!=(f=r.__k[l]=null==(f=t[l])||"boolean"==typeof f?null:"string"==typeof f||"number"==typeof f||"bigint"==typeof f?B_(null,f,null,null,f):Array.isArray(f)?B_(X_,{children:f},null,null,null):f.__b>0?B_(f.type,f.props,f.key,null,f.__v):f)){if(f.__=r,f.__b=r.__b+1,null===(d=m[l])||d&&f.key==d.key&&f.type===d.type)m[l]=void 0;else for(h=0;h<g;h++){if((d=m[h])&&f.key==d.key&&f.type===d.type){m[h]=void 0;break}d=null}np(e,f,d=d||x_,i,s,a,o,c,u),_=f.__e,(h=f.ref)&&d.ref!=h&&(v||(v=[]),d.ref&&v.push(d.ref,null,f),v.push(h,f.__c||_,f)),null!=_?(null==p&&(p=_),"function"==typeof f.type&&f.__k===d.__k?f.__d=c=z_(f,c,e):c=J_(e,f,d,m,_,c),"function"==typeof r.type&&(r.__d=c)):c&&d.__e==c&&c.parentNode!=e&&(c=q_(d))}for(r.__e=p,l=g;l--;)null!=m[l]&&("function"==typeof r.type&&null!=m[l].__e&&m[l].__e==r.__d&&(r.__d=q_(n,l+1)),op(m[l],m[l]));if(v)for(l=0;l<v.length;l++)ap(v[l],v[++l],v[++l])}function z_(e,t,r){for(var n,i=e.__k,s=0;i&&s<i.length;s++)(n=i[s])&&(n.__=e,t="function"==typeof n.type?z_(n,t,r):J_(r,n,n,i,n.__e,t));return t}function Q_(e,t){return t=t||[],null==e||"boolean"==typeof e||(Array.isArray(e)?e.some(function(e){Q_(e,t)}):t.push(e)),t}function J_(e,t,r,n,i,s){var a,o,c;if(void 0!==t.__d)a=t.__d,t.__d=void 0;else if(null==r||i!=s||null==i.parentNode)e:if(null==s||s.parentNode!==e)e.appendChild(i),a=null;else{for(o=s,c=0;(o=o.nextSibling)&&c<n.length;c+=2)if(o==i)break e;e.insertBefore(i,s),a=s}return void 0!==a?a:i.nextSibling}function Z_(e,t,r){"-"===t[0]?e.setProperty(t,r):e[t]=null==r?"":"number"!=typeof r||F_.test(t)?r:r+"px"}function ep(e,t,r,n,i){var s;e:if("style"===t)if("string"==typeof r)e.style.cssText=r;else{if("string"==typeof n&&(e.style.cssText=n=""),n)for(t in n)r&&t in r||Z_(e.style,t,"");if(r)for(t in r)n&&r[t]===n[t]||Z_(e.style,t,r[t])}else if("o"===t[0]&&"n"===t[1])s=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+s]=r,r?n||e.addEventListener(t,s?rp:tp,s):e.removeEventListener(t,s?rp:tp,s);else if("dangerouslySetInnerHTML"!==t){if(i)t=t.replace(/xlink[H:h]/,"h").replace(/sName$/,"s");else if("href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&t in e)try{e[t]=null==r?"":r;break e}catch(e){}"function"==typeof r||(null!=r&&(!1!==r||"a"===t[0]&&"r"===t[1])?e.setAttribute(t,r):e.removeAttribute(t))}}function tp(e){this.l[e.type+!1](o_.event?o_.event(e):e)}function rp(e){this.l[e.type+!0](o_.event?o_.event(e):e)}function np(e,t,r,n,i,s,a,o,c){var u,l,h,d,f,_,p,v,m,g,E,T=t.type;if(void 0!==t.constructor)return null;null!=r.__h&&(c=r.__h,o=t.__e=r.__e,t.__h=null,s=[o]),(u=o_.__b)&&u(t);try{e:if("function"==typeof T){if(v=t.props,m=(u=T.contextType)&&n[u.__c],g=u?m?m.props.value:u.__:n,r.__c?p=(l=t.__c=r.__c).__=l.__E:("prototype"in T&&T.prototype.render?t.__c=l=new T(v,g):(t.__c=l=new W_(v,g),l.constructor=T,l.render=cp),m&&m.sub(l),l.props=v,l.state||(l.state={}),l.context=g,l.__n=n,h=l.__d=!0,l.__h=[]),null==l.__s&&(l.__s=l.state),null!=T.getDerivedStateFromProps&&(l.__s==l.state&&(l.__s=V_({},l.__s)),V_(l.__s,T.getDerivedStateFromProps(v,l.__s))),d=l.props,f=l.state,h)null==T.getDerivedStateFromProps&&null!=l.componentWillMount&&l.componentWillMount(),null!=l.componentDidMount&&l.__h.push(l.componentDidMount);else{if(null==T.getDerivedStateFromProps&&v!==d&&null!=l.componentWillReceiveProps&&l.componentWillReceiveProps(v,g),!l.__e&&null!=l.shouldComponentUpdate&&!1===l.shouldComponentUpdate(v,l.__s,g)||t.__v===r.__v){l.props=v,l.state=l.__s,t.__v!==r.__v&&(l.__d=!1),l.__v=t,t.__e=r.__e,t.__k=r.__k,t.__k.forEach(function(e){e&&(e.__=t)}),l.__h.length&&a.push(l);break e}null!=l.componentWillUpdate&&l.componentWillUpdate(v,l.__s,g),null!=l.componentDidUpdate&&l.__h.push(function(){l.componentDidUpdate(d,f,_)})}l.context=g,l.props=v,l.state=l.__s,(u=o_.__r)&&u(t),l.__d=!1,l.__v=t,l.__P=e,u=l.render(l.props,l.state,l.context),l.state=l.__s,null!=l.getChildContext&&(n=V_(V_({},n),l.getChildContext())),h||null==l.getSnapshotBeforeUpdate||(_=l.getSnapshotBeforeUpdate(d,f)),E=null!=u&&u.type===X_&&null==u.key?u.props.children:u,$_(e,Array.isArray(E)?E:[E],t,r,n,i,s,a,o,c),l.base=t.__e,t.__h=null,l.__h.length&&a.push(l),p&&(l.__E=l.__=null),l.__e=!1}else null==s&&t.__v===r.__v?(t.__k=r.__k,t.__e=r.__e):t.__e=sp(r.__e,t,r,n,i,s,a,c);(u=o_.diffed)&&u(t)}catch(e){t.__v=null,(c||null!=s)&&(t.__e=o,t.__h=!!c,s[s.indexOf(o)]=null),o_.__e(e,t,r)}}function ip(e,t){o_.__c&&o_.__c(t,e),e.some(function(t){try{e=t.__h,t.__h=[],e.some(function(e){e.call(t)})}catch(e){o_.__e(e,t.__v)}})}function sp(e,t,r,n,i,s,a,o){var c,u,l,h=r.props,d=t.props,f=t.type,_=0;if("svg"===f&&(i=!0),null!=s)for(;_<s.length;_++)if((c=s[_])&&"setAttribute"in c==!!f&&(f?c.localName===f:3===c.nodeType)){e=c,s[_]=null;break}if(null==e){if(null===f)return document.createTextNode(d);e=i?document.createElementNS("http://www.w3.org/2000/svg",f):document.createElement(f,d.is&&d),s=null,o=!1}if(null===f)h===d||o&&e.data===d||(e.data=d);else{if(s=s&&a_.call(e.childNodes),u=(h=r.props||x_).dangerouslySetInnerHTML,l=d.dangerouslySetInnerHTML,!o){if(null!=s)for(h={},_=0;_<e.attributes.length;_++)h[e.attributes[_].name]=e.attributes[_].value;(l||u)&&(l&&(u&&l.__html==u.__html||l.__html===e.innerHTML)||(e.innerHTML=l&&l.__html||""))}if(function(e,t,r,n,i){var s;for(s in r)"children"===s||"key"===s||s in t||ep(e,s,null,r[s],n);for(s in t)i&&"function"!=typeof t[s]||"children"===s||"key"===s||"value"===s||"checked"===s||r[s]===t[s]||ep(e,s,t[s],r[s],n)}(e,d,h,i,o),l)t.__k=[];else if(_=t.props.children,$_(e,Array.isArray(_)?_:[_],t,r,n,i&&"foreignObject"!==f,s,a,s?s[0]:r.__k&&q_(r,0),o),null!=s)for(_=s.length;_--;)null!=s[_]&&j_(s[_]);o||("value"in d&&void 0!==(_=d.value)&&(_!==e.value||"progress"===f&&!_||"option"===f&&_!==h.value)&&ep(e,"value",_,h.value,!1),"checked"in d&&void 0!==(_=d.checked)&&_!==e.checked&&ep(e,"checked",_,h.checked,!1))}return e}function ap(e,t,r){try{"function"==typeof e?e(t):e.current=t}catch(e){o_.__e(e,r)}}function op(e,t,r){var n,i;if(o_.unmount&&o_.unmount(e),(n=e.ref)&&(n.current&&n.current!==e.__e||ap(n,null,t)),null!=(n=e.__c)){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(e){o_.__e(e,t)}n.base=n.__P=null}if(n=e.__k)for(i=0;i<n.length;i++)n[i]&&op(n[i],t,"function"!=typeof e.type);r||null==e.__e||j_(e.__e),e.__e=e.__d=void 0}function cp(e,t,r){return this.constructor(e,r)}function up(e,t,r){var n,i,s;o_.__&&o_.__(e,t),i=(n="function"==typeof r)?null:r&&r.__k||t.__k,s=[],np(t,e=(!n&&r||t).__k=H_(X_,null,[e]),i||x_,x_,void 0!==t.ownerSVGElement,!n&&r?[r]:i?null:t.firstChild?a_.call(t.childNodes):null,s,!n&&r?r:i?i.__e:t.firstChild,n),ip(s,e)}function lp(e,t){up(e,t,lp)}function hp(e,t,r){var n,i,s,a=V_({},e.props);for(s in t)"key"==s?n=t[s]:"ref"==s?i=t[s]:a[s]=t[s];return arguments.length>2&&(a.children=arguments.length>3?a_.call(arguments,2):r),B_(e.type,a,n||e.key,i||e.ref,null)}function dp(e,t){var r={__c:t="__cC"+d_++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e){var r,n;return this.getChildContext||(r=[],(n={})[t]=this,this.getChildContext=function(){return n},this.shouldComponentUpdate=function(e){this.props.value!==e.value&&r.some(K_)},this.sub=function(e){r.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){r.splice(r.indexOf(e),1),t&&t.call(e)}}),e.children}};return r.Provider.__=r.Consumer.contextType=r}a_=U_.slice,o_={__e:function(e,t){for(var r,n,i;t=t.__;)if((r=t.__c)&&!r.__)try{if((n=r.constructor)&&null!=n.getDerivedStateFromError&&(r.setState(n.getDerivedStateFromError(e)),i=r.__d),null!=r.componentDidCatch&&(r.componentDidCatch(e),i=r.__d),i)return r.__E=r}catch(t){e=t}throw e}},c_=0,W_.prototype.setState=function(e,t){var r;r=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=V_({},this.state),"function"==typeof e&&(e=e(V_({},r),this.props)),e&&V_(r,e),null!=e&&this.__v&&(t&&this.__h.push(t),K_(this))},W_.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),K_(this))},W_.prototype.render=X_,u_=[],l_="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Y_.__r=0,d_=0;var fp,_p,pp,vp=0,mp=[],gp=o_.__b,Ep=o_.__r,Tp=o_.diffed,yp=o_.__c,Sp=o_.unmount;function bp(e,t){o_.__h&&o_.__h(_p,e,vp||t),vp=0;var r=_p.__H||(_p.__H={__:[],__h:[]});return e>=r.__.length&&r.__.push({}),r.__[e]}function Ap(e){return vp=1,Ip(Vp,e)}function Ip(e,t,r){var n=bp(fp++,2);return n.t=e,n.__c||(n.__=[r?r(t):Vp(void 0,t),function(e){var t=n.t(n.__[0],e);n.__[0]!==t&&(n.__=[t,n.__[1]],n.__c.setState({}))}],n.__c=_p),n.__}function wp(e,t){var r=bp(fp++,3);!o_.__s&&Fp(r.__H,t)&&(r.__=e,r.__H=t,_p.__H.__h.push(r))}function Rp(e,t){var r=bp(fp++,4);!o_.__s&&Fp(r.__H,t)&&(r.__=e,r.__H=t,_p.__h.push(r))}function Pp(e){return vp=5,Dp(function(){return{current:e}},[])}function Dp(e,t){var r=bp(fp++,7);return Fp(r.__H,t)&&(r.__=e(),r.__H=t,r.__h=e),r.__}function Lp(e,t){return vp=8,Dp(function(){return e},t)}function kp(e){var t=_p.context[e.__c],r=bp(fp++,9);return r.c=e,t?(null==r.__&&(r.__=!0,t.sub(_p)),t.props.value):e.__}function Cp(e,t){o_.useDebugValue&&o_.useDebugValue(t?t(e):e)}function Op(e){var t=bp(fp++,10),r=Ap();return t.__=e,_p.componentDidCatch||(_p.componentDidCatch=function(e){t.__&&t.__(e),r[1](e)}),[r[0],function(){r[1](void 0)}]}function Np(){for(var e;e=mp.shift();)if(e.__P)try{e.__H.__h.forEach(xp),e.__H.__h.forEach(Up),e.__H.__h=[]}catch(t){e.__H.__h=[],o_.__e(t,e.__v)}}o_.__b=function(e){_p=null,gp&&gp(e)},o_.__r=function(e){Ep&&Ep(e),fp=0;var t=(_p=e.__c).__H;t&&(t.__h.forEach(xp),t.__h.forEach(Up),t.__h=[])},o_.diffed=function(e){Tp&&Tp(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(1!==mp.push(t)&&pp===o_.requestAnimationFrame||((pp=o_.requestAnimationFrame)||function(e){var t,r=function(){clearTimeout(n),Mp&&cancelAnimationFrame(t),setTimeout(e)},n=setTimeout(r,100);Mp&&(t=requestAnimationFrame(r))})(Np)),_p=null},o_.__c=function(e,t){t.some(function(e){try{e.__h.forEach(xp),e.__h=e.__h.filter(function(e){return!e.__||Up(e)})}catch(r){t.some(function(e){e.__h&&(e.__h=[])}),t=[],o_.__e(r,e.__v)}}),yp&&yp(e,t)},o_.unmount=function(e){Sp&&Sp(e);var t,r=e.__c;r&&r.__H&&(r.__H.__.forEach(function(e){try{xp(e)}catch(e){t=e}}),t&&o_.__e(t,r.__v))};var Mp="function"==typeof requestAnimationFrame;function xp(e){var t=_p,r=e.__c;"function"==typeof r&&(e.__c=void 0,r()),_p=t}function Up(e){var t=_p;e.__c=e.__(),_p=t}function Fp(e,t){return!e||e.length!==t.length||t.some(function(t,r){return t!==e[r]})}function Vp(e,t){return"function"==typeof t?t(e):t}function jp(){return jp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jp.apply(this,arguments)}function Hp(e,t){return Hp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Hp(e,t)}var Bp,Xp,Wp,qp=function(e){var t,r;function n(){return e.apply(this,arguments)||this}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,Hp(t,r);var i=n.prototype;return i.componentDidMount=function(){this.props.nodeRef.current=this.base},i.componentWillUnmount=function(){this.props.nodeRef.current=void 0},i.render=function(){return H_(X_,{},this.props.children)},n}(W_);!function(e){e.APPEAR="appear",e.APPEAR_ACTIVE="appearActive",e.APPEAR_DONE="appearDone",e.ENTER="enter",e.ENTER_ACTIVE="enterActive",e.ENTER_DONE="enterDone",e.EXIT="exit",e.EXIT_ACTIVE="exitActive",e.EXIT_DONE="exitDone"}(Xp||(Xp={})),function(e){e.ENTER="onEnter",e.ENTERING="onEntering",e.ENTERED="onEntered",e.EXIT="onExit",e.EXITING="onExiting",e.EXITED="onExited"}(Wp||(Wp={}));var Gp=((Bp={})[Xp.APPEAR]=[Wp.ENTER,Xp.APPEAR_ACTIVE],Bp[Xp.APPEAR_ACTIVE]=[Wp.ENTERING,Xp.APPEAR_DONE,!0],Bp[Xp.APPEAR_DONE]=[Wp.ENTERED],Bp[Xp.ENTER]=[Wp.ENTER,Xp.ENTER_ACTIVE],Bp[Xp.ENTER_ACTIVE]=[Wp.ENTERING,Xp.ENTER_DONE,!0],Bp[Xp.ENTER_DONE]=[Wp.ENTERED],Bp[Xp.EXIT]=[Wp.EXIT,Xp.EXIT_ACTIVE],Bp[Xp.EXIT_ACTIVE]=[Wp.EXITING,Xp.EXIT_DONE,!0],Bp[Xp.EXIT_DONE]=[Wp.EXITED],Bp);function Kp(e){var t=e.children,r=e.in,n=void 0!==r&&r,i=e.appear,s=void 0!==i&&i,a=e.enter,o=void 0===a||a,c=e.exit,u=void 0===c||c,l=e.duration,h=void 0===l?500:l,d=e.alwaysMounted,f=void 0!==d&&d,_=e.addEndListener,p=Pp(),v=Pp(),m=!1,g=Ap(function(){return m=!0,n?s?Xp.APPEAR:Xp.APPEAR_DONE:Xp.EXIT_DONE}),E=g[0],T=g[1];wp(function(){var t=window,r=t.setTimeout,n=t.clearTimeout,i=Gp[E],s=i[1],a=i[2],o=e[i[0]];return null==o||o(p.current),s&&(a?_?_(p.current,function(){return T(s)}):v.current=r(T,h,s):T(s)),function(){n(v.current)}},[E,h]),Rp(function(){m||T(n?o?Xp.ENTER:Xp.ENTER_DONE:u?Xp.EXIT:Xp.EXIT_DONE)},[n]);var y=Dp(function(){var e={};return Object.keys(Gp).forEach(function(t){e[t]=E===t}),e},[E]);return f||(u?E!==Xp.EXIT_DONE:n)?H_(qp,{nodeRef:p,children:t(y,E)}):null}var Yp,$p=["children","styles"];function zp(e){var t=e.children,r=e.styles,n=function(e,t){if(null==e)return{};var r,n,i={},s=Object.keys(e);for(n=0;n<s.length;n++)t.indexOf(r=s[n])>=0||(i[r]=e[r]);return i}(e,$p);return H_(Kp,n,function(e,n){var i=t.props.style,s=Dp(function(){return jp({},function(e,t){var r=t[e];switch(e){case Xp.APPEAR_ACTIVE:return jp({},t[Xp.APPEAR],r);case Xp.ENTER_ACTIVE:return jp({},t[Xp.ENTER],r);case Xp.EXIT_ACTIVE:return jp({},t[Xp.EXIT],r);default:return r}}(n,r),i)},[i,r,n]);return hp(t,{style:s})})}function Qp(e,t){for(var r in t)e[r]=t[r];return e}function Jp(e,t){for(var r in e)if("__source"!==r&&!(r in t))return!0;for(var n in t)if("__source"!==n&&e[n]!==t[n])return!0;return!1}function Zp(e){this.props=e}(Yp={})[Xp.APPEAR]="-appear",Yp[Xp.APPEAR_ACTIVE]="-appear-active",Yp[Xp.APPEAR_DONE]="-appear-done",Yp[Xp.ENTER]="-enter",Yp[Xp.ENTER_ACTIVE]="-enter-active",Yp[Xp.ENTER_DONE]="-enter-done",Yp[Xp.EXIT]="-exit",Yp[Xp.EXIT_ACTIVE]="-exit-active",Yp[Xp.EXIT_DONE]="-exit-done",(Zp.prototype=new W_).isPureReactComponent=!0,Zp.prototype.shouldComponentUpdate=function(e,t){return Jp(this.props,e)||Jp(this.state,t)};var ev=o_.__b;o_.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),ev&&ev(e)};var tv="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function rv(e){function t(t,r){var n=Qp({},t);return delete n.ref,e(n,(r=t.ref||r)&&("object"!=typeof r||"current"in r)?r:null)}return t.$$typeof=tv,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var nv=function(e,t){return null==e?null:Q_(Q_(e).map(t))},iv={map:nv,forEach:nv,count:function(e){return e?Q_(e).length:0},only:function(e){var t=Q_(e);if(1!==t.length)throw"Children.only";return t[0]},toArray:Q_},sv=o_.__e;o_.__e=function(e,t,r){if(e.then)for(var n,i=t;i=i.__;)if((n=i.__c)&&n.__c)return null==t.__e&&(t.__e=r.__e,t.__k=r.__k),n.__c(e,t);sv(e,t,r)};var av=o_.unmount;function ov(){this.__u=0,this.t=null,this.__b=null}function cv(e){var t=e.__.__c;return t&&t.__e&&t.__e(e)}function uv(){this.u=null,this.o=null}o_.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),av&&av(e)},(ov.prototype=new W_).__c=function(e,t){var r=t.__c,n=this;null==n.t&&(n.t=[]),n.t.push(r);var i=cv(n.__v),s=!1,a=function(){s||(s=!0,r.__R=null,i?i(o):o())};r.__R=a;var o=function(){if(! --n.__u){if(n.state.__e){var e=n.state.__e;n.__v.__k[0]=function e(t,r,n){return t&&(t.__v=null,t.__k=t.__k&&t.__k.map(function(t){return e(t,r,n)}),t.__c&&t.__c.__P===r&&(t.__e&&n.insertBefore(t.__e,t.__d),t.__c.__e=!0,t.__c.__P=n)),t}(e,e.__c.__P,e.__c.__O)}var t;for(n.setState({__e:n.__b=null});t=n.t.pop();)t.forceUpdate()}},c=!0===t.__h;n.__u++||c||n.setState({__e:n.__b=n.__v.__k[0]}),e.then(a,a)},ov.prototype.componentWillUnmount=function(){this.t=[]},ov.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var r=document.createElement("div"),n=this.__v.__k[0].__c;this.__v.__k[0]=function e(t,r,n){return t&&(t.__c&&t.__c.__H&&(t.__c.__H.__.forEach(function(e){"function"==typeof e.__c&&e.__c()}),t.__c.__H=null),null!=(t=Qp({},t)).__c&&(t.__c.__P===n&&(t.__c.__P=r),t.__c=null),t.__k=t.__k&&t.__k.map(function(t){return e(t,r,n)})),t}(this.__b,r,n.__O=n.__P)}this.__b=null}var i=t.__e&&H_(X_,null,e.fallback);return i&&(i.__h=null),[H_(X_,null,t.__e?null:e.children),i]};var lv=function(e,t,r){if(++r[1]===r[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(r=e.u;r;){for(;r.length>3;)r.pop()();if(r[1]<r[0])break;e.u=r=r[2]}};function hv(e){return this.getChildContext=function(){return e.context},e.children}function dv(e){var t=this,r=e.i;t.componentWillUnmount=function(){up(null,t.l),t.l=null,t.i=null},t.i&&t.i!==r&&t.componentWillUnmount(),e.__v?(t.l||(t.i=r,t.l={nodeType:1,parentNode:r,childNodes:[],appendChild:function(e){this.childNodes.push(e),t.i.appendChild(e)},insertBefore:function(e,r){this.childNodes.push(e),t.i.appendChild(e)},removeChild:function(e){this.childNodes.splice(this.childNodes.indexOf(e)>>>1,1),t.i.removeChild(e)}}),up(H_(hv,{context:t.context},e.__v),t.l)):t.l&&t.componentWillUnmount()}function fv(e,t){return H_(dv,{__v:e,i:t})}(uv.prototype=new W_).__e=function(e){var t=this,r=cv(t.__v),n=t.o.get(e);return n[0]++,function(i){var s=function(){t.props.revealOrder?(n.push(i),lv(t,e,n)):i()};r?r(s):s()}},uv.prototype.render=function(e){this.u=null,this.o=new Map;var t=Q_(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var r=t.length;r--;)this.o.set(t[r],this.u=[1,0,this.u]);return e.children},uv.prototype.componentDidUpdate=uv.prototype.componentDidMount=function(){var e=this;this.o.forEach(function(t,r){lv(e,r,t)})};var _v="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,pv=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,vv="undefined"!=typeof document,mv=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};W_.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(W_.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var gv=o_.event;function Ev(){}function Tv(){return this.cancelBubble}function yv(){return this.defaultPrevented}o_.event=function(e){return gv&&(e=gv(e)),e.persist=Ev,e.isPropagationStopped=Tv,e.isDefaultPrevented=yv,e.nativeEvent=e};var Sv,bv={configurable:!0,get:function(){return this.class}},Av=o_.vnode;o_.vnode=function(e){var t=e.type,r=e.props,n=r;if("string"==typeof t){var i=-1===t.indexOf("-");for(var s in n={},r){var a=r[s];vv&&"children"===s&&"noscript"===t||"value"===s&&"defaultValue"in r&&null==a||("defaultValue"===s&&"value"in r&&null==r.value?s="value":"download"===s&&!0===a?a="":/ondoubleclick/i.test(s)?s="ondblclick":/^onchange(textarea|input)/i.test(s+t)&&!mv(r.type)?s="oninput":/^onfocus$/i.test(s)?s="onfocusin":/^onblur$/i.test(s)?s="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(s)?s=s.toLowerCase():i&&pv.test(s)?s=s.replace(/[A-Z0-9]/,"-$&").toLowerCase():null===a&&(a=void 0),n[s]=a)}"select"==t&&n.multiple&&Array.isArray(n.value)&&(n.value=Q_(r.children).forEach(function(e){e.props.selected=-1!=n.value.indexOf(e.props.value)})),"select"==t&&null!=n.defaultValue&&(n.value=Q_(r.children).forEach(function(e){e.props.selected=n.multiple?-1!=n.defaultValue.indexOf(e.props.value):n.defaultValue==e.props.value})),e.props=n,r.class!=r.className&&(bv.enumerable="className"in r,null!=r.className&&(n.class=r.className),Object.defineProperty(n,"className",bv))}e.$$typeof=_v,Av&&Av(e)};var Iv=o_.__r;o_.__r=function(e){Iv&&Iv(e),Sv=e.__c};var wv={ReactCurrentDispatcher:{current:{readContext:function(e){return Sv.__n[e.__c].props.value}}}};function Rv(e){return!!e&&e.$$typeof===_v}var Pv={useState:Ap,useReducer:Ip,useEffect:wp,useLayoutEffect:Rp,useRef:Pp,useImperativeHandle:function(e,t,r){vp=6,Rp(function(){"function"==typeof e?e(t()):e&&(e.current=t())},null==r?r:r.concat(e))},useMemo:Dp,useCallback:Lp,useContext:kp,useDebugValue:Cp,version:"17.0.2",Children:iv,render:function(e,t,r){return null==t.__k&&(t.textContent=""),up(e,t),"function"==typeof r&&r(),e?e.__c:null},hydrate:function(e,t,r){return lp(e,t),"function"==typeof r&&r(),e?e.__c:null},unmountComponentAtNode:function(e){return!!e.__k&&(up(null,e),!0)},createPortal:fv,createElement:H_,createContext:dp,createFactory:function(e){return H_.bind(null,e)},cloneElement:function(e){return Rv(e)?hp.apply(null,arguments):e},createRef:function(){return{current:null}},Fragment:X_,isValidElement:Rv,findDOMNode:function(e){return e&&(e.base||1===e.nodeType&&e)||null},Component:W_,PureComponent:Zp,memo:function(e,t){function r(e){var r=this.props.ref,n=r==e.ref;return!n&&r&&(r.call?r(null):r.current=null),t?!t(this.props,e)||!n:Jp(this.props,e)}function n(t){return this.shouldComponentUpdate=r,H_(e,t)}return n.displayName="Memo("+(e.displayName||e.name)+")",n.prototype.isReactComponent=!0,n.__f=!0,n},forwardRef:rv,flushSync:function(e,t){return e(t)},unstable_batchedUpdates:function(e,t){return e(t)},StrictMode:X_,Suspense:ov,SuspenseList:uv,lazy:function(e){var t,r,n;function i(i){if(t||(t=e()).then(function(e){r=e.default||e},function(e){n=e}),n)throw n;if(!r)throw t;return H_(r,i)}return i.displayName="Lazy",i.__f=!0,i},__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:wv};const Dv="undefined"==typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?wp:Rp;function Lv(e){const t="function"==typeof e?function(e){let t;const r=new Set,n=(e,n)=>{const i="function"==typeof e?e(t):e;if(i!==t){const e=t;t=n?i:Object.assign({},t,i),r.forEach(r=>r(t,e))}},i=()=>t,s={setState:n,getState:i,subscribe:(e,n,s)=>n||s?((e,n=i,s=Object.is)=>{let a=n(t);function o(){const r=n(t);if(!s(a,r)){const t=a;e(a=r,t)}}return r.add(o),()=>r.delete(o)})(e,n,s):(r.add(e),()=>r.delete(e)),destroy:()=>r.clear()};return t=e(n,i,s),s}(e):e,r=(e=t.getState,r=Object.is)=>{const[,n]=Ip(e=>e+1,0),i=t.getState(),s=Pp(i),a=Pp(e),o=Pp(r),c=Pp(!1),u=Pp();let l;void 0===u.current&&(u.current=e(i));let h=!1;(s.current!==i||a.current!==e||o.current!==r||c.current)&&(l=e(i),h=!r(u.current,l)),Dv(()=>{h&&(u.current=l),s.current=i,a.current=e,o.current=r,c.current=!1});const d=Pp(i);Dv(()=>{const e=()=>{try{const e=t.getState(),r=a.current(e);o.current(u.current,r)||(s.current=e,u.current=r,n())}catch(e){c.current=!0,n()}},r=t.subscribe(e);return t.getState()!==d.current&&e(),r},[]);const f=h?l:u.current;return Cp(f),f};return Object.assign(r,t),r[Symbol.iterator]=function(){const e=[r,t];return{next(){const t=e.length<=0;return{value:e.shift(),done:t}}}},r}function kv(){const e=dp(void 0);return{Provider:({initialStore:t,createStore:r,children:n})=>{const i=Pp();return i.current||(t&&(r||(r=()=>t)),i.current=r()),H_(e.Provider,{value:i.current},n)},useStore:(t,r=Object.is)=>{const n=kp(e);if(!n)throw new Error("Seems like you have not used zustand provider as an ancestor.");return n(t,r)},useStoreApi:()=>{const t=kp(e);if(!t)throw new Error("Seems like you have not used zustand provider as an ancestor.");return Dp(()=>({getState:t.getState,setState:t.setState,subscribe:t.subscribe,destroy:t.destroy}),[t])}}}const Cv=e=>(t,r,n)=>{const i=n.subscribe;return n.subscribe=(e,t,r)=>{let s=e;if(t){const i=(null==r?void 0:r.equalityFn)||Object.is;let a=e(n.getState());s=r=>{const n=e(r);if(!i(a,n)){const e=a;t(a=n,e)}},(null==r?void 0:r.fireImmediately)&&t(a,a)}return i(s)},e(t,r,n)};var Ov=0;function Nv(e,t,r,n,i){var s,a,o={};for(a in t)"ref"==a?s=t[a]:o[a]=t[a];var c={type:e,props:o,key:r,ref:s,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--Ov,__source:n,__self:i};if("function"==typeof e&&(s=e.defaultProps))for(a in s)void 0===o[a]&&(o[a]=s[a]);return o_.vnode&&o_.vnode(c),c}function Mv(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Xt;++t<r;)this.add(e[t])}function xv(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function Uv(e,t){return e.has(t)}function Fv(e,t,r,n,i,s){var a=1&r,o=e.length,c=t.length;if(o!=c&&!(a&&c>o))return!1;var u=s.get(e),l=s.get(t);if(u&&l)return u==t&&l==e;var h=-1,d=!0,f=2&r?new Mv:void 0;for(s.set(e,t),s.set(t,e);++h<o;){var _=e[h],p=t[h];if(n)var v=a?n(p,_,h,t,e,s):n(_,p,h,e,t,s);if(void 0!==v){if(v)continue;d=!1;break}if(f){if(!xv(t,function(e,t){if(!Uv(f,t)&&(_===e||i(_,e,r,n,s)))return f.push(t)})){d=!1;break}}else if(_!==p&&!i(_,p,r,n,s)){d=!1;break}}return s.delete(e),s.delete(t),d}function Vv(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r}function jv(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}Mv.prototype.add=Mv.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Mv.prototype.has=function(e){return this.__data__.has(e)};var Hv=ct?ct.prototype:void 0,Bv=Hv?Hv.valueOf:void 0,Xv=Object.prototype.hasOwnProperty,Wv="[object Arguments]",qv="[object Array]",Gv="[object Object]",Kv=Object.prototype.hasOwnProperty;function Yv(e,t,r,n,i){return e===t||(null==e||null==t||!vt(e)&&!vt(t)?e!=e&&t!=t:function(e,t,r,n,i,s){var a=it(e),o=it(t),c=a?qv:Bn(e),u=o?qv:Bn(t),l=(c=c==Wv?Gv:c)==Gv,h=(u=u==Wv?Gv:u)==Gv,d=c==u;if(d&&jr(e)){if(!jr(t))return!1;a=!0,l=!1}if(d&&!l)return s||(s=new wr),a||Qr(e)?Fv(e,t,r,n,i,s):function(e,t,r,n,i,s,a){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!s(new Wn(e),new Wn(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Ut(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var o=Vv;case"[object Set]":var c=1&n;if(o||(o=jv),e.size!=t.size&&!c)return!1;var u=a.get(e);if(u)return u==t;n|=2,a.set(e,t);var l=Fv(o(e),o(t),n,i,s,a);return a.delete(e),l;case"[object Symbol]":if(Bv)return Bv.call(e)==Bv.call(t)}return!1}(e,t,c,r,n,i,s);if(!(1&r)){var f=l&&Kv.call(e,"__wrapped__"),_=h&&Kv.call(t,"__wrapped__");if(f||_){var p=f?e.value():e,v=_?t.value():t;return s||(s=new wr),i(p,v,r,n,s)}}return!!d&&(s||(s=new wr),function(e,t,r,n,i,s){var a=1&r,o=In(e),c=o.length;if(c!=In(t).length&&!a)return!1;for(var u=c;u--;){var l=o[u];if(!(a?l in t:Xv.call(t,l)))return!1}var h=s.get(e),d=s.get(t);if(h&&d)return h==t&&d==e;var f=!0;s.set(e,t),s.set(t,e);for(var _=a;++u<c;){var p=e[l=o[u]],v=t[l];if(n)var m=a?n(v,p,l,t,e,s):n(p,v,l,e,t,s);if(!(void 0===m?p===v||i(p,v,r,n,s):m)){f=!1;break}_||(_="constructor"==l)}if(f&&!_){var g=e.constructor,E=t.constructor;g==E||!("constructor"in e)||!("constructor"in t)||"function"==typeof g&&g instanceof g&&"function"==typeof E&&E instanceof E||(f=!1)}return s.delete(e),s.delete(t),f}(e,t,r,n,i,s))}(e,t,r,n,Yv,i))}function $v(e,t){return Yv(e,t)}var zv=[],Qv=[];function Jv(e,t){if(e&&"undefined"!=typeof document){var r,n=!0===t.prepend?"prepend":"append",i=!0===t.singleTag,s="string"==typeof t.container?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(i){var a=zv.indexOf(s);-1===a&&(a=zv.push(s)-1,Qv[a]={}),r=Qv[a]&&Qv[a][n]?Qv[a][n]:Qv[a][n]=o()}else r=o();65279===e.charCodeAt(0)&&(e=e.substring(1)),r.styleSheet?r.styleSheet.cssText+=e:r.appendChild(document.createTextNode(e))}function o(){var e=document.createElement("style");if(e.setAttribute("type","text/css"),t.attributes)for(var r=Object.keys(t.attributes),i=0;i<r.length;i++)e.setAttribute(r[i],t.attributes[r[i]]);var a="prepend"===n?"afterbegin":"beforeend";return s.insertAdjacentElement(a,e),e}}var Zv=cf(function(e,t){
/*! For license information please see hls-parser.min.js.LICENSE.txt */
self,e.exports=function(){return e={851:(e,t,r)=>{var n=r(771),i=n.getOptions,s=n.setOptions,a=r(463),o=r(367),c=r(890);e.exports={parse:a,stringify:o,types:c,getOptions:i,setOptions:s}},463:(e,t,r)=>{function n(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=s(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){c=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(c)throw a}}}}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,s=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,s=e}finally{try{n||null==o.return||o.return()}finally{if(i)throw s}}return r}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var o=r(771),c=r(890),u=c.Rendition,l=c.Variant,h=c.SessionData,d=c.Key,f=c.MediaInitializationSection,_=c.DateRange,p=c.SpliceInfo,v=c.MasterPlaylist,m=c.MediaPlaylist,g=c.Segment,E=c.PartialSegment,T=c.RenditionReport;function y(e){return o.trim(e,'"')}function S(e){var t=o.splitAt(e,",");return{duration:o.toNumber(t[0]),title:decodeURIComponent(escape(t[1]))}}function b(e){var t=o.splitAt(e,"@");return{length:o.toNumber(t[0]),offset:t[1]?o.toNumber(t[1]):-1}}function A(e,t){t.IV&&e.compatibleVersion<2&&(e.compatibleVersion=2),(t.KEYFORMAT||t.KEYFORMATVERSIONS)&&e.compatibleVersion<5&&(e.compatibleVersion=5)}function I(e){var t=o.splitByCommaWithPreservingQuotes(e),r={};return t.forEach(function(e){var t,n,s=i(o.splitAt(e,"="),2),a=s[0],c=s[1],u=y(c);switch(a){case"URI":r[a]=u;break;case"START-DATE":case"END-DATE":r[a]=new Date(u);break;case"IV":r[a]=(t=u,16!==(n=o.hexToByteSequence(t)).length&&o.INVALIDPLAYLIST("IV must be a 128-bit unsigned integer"),n);break;case"BYTERANGE":r[a]=b(u);break;case"RESOLUTION":r[a]=function(e){var t=o.splitAt(e,"x");return{width:o.toNumber(t[0]),height:o.toNumber(t[1])}}(u);break;case"END-ON-NEXT":case"DEFAULT":case"AUTOSELECT":case"FORCED":case"PRECISE":case"CAN-BLOCK-RELOAD":case"INDEPENDENT":case"GAP":r[a]="YES"===u;break;case"DURATION":case"PLANNED-DURATION":case"BANDWIDTH":case"AVERAGE-BANDWIDTH":case"FRAME-RATE":case"TIME-OFFSET":case"CAN-SKIP-UNTIL":case"HOLD-BACK":case"PART-HOLD-BACK":case"PART-TARGET":case"BYTERANGE-START":case"BYTERANGE-LENGTH":case"LAST-MSN":case"LAST-PART":case"SKIPPED-SEGMENTS":r[a]=o.toNumber(u);break;default:a.startsWith("SCTE35-")?r[a]=o.hexToByteSequence(u):a.startsWith("X-")?r[a]=function(e){return e.startsWith('"')?y(e):e.startsWith("0x")||e.startsWith("0X")?o.hexToByteSequence(e):o.toNumber(e)}(c):r[a]=u}}),r}function w(){o.INVALIDPLAYLIST("The file contains both media and master playlist tags.")}function R(e,t,r){var i,s=(i=t.attributes,new u({type:i.TYPE,uri:i.URI,groupId:i["GROUP-ID"],language:i.LANGUAGE,assocLanguage:i["ASSOC-LANGUAGE"],name:i.NAME,isDefault:i.DEFAULT,autoselect:i.AUTOSELECT,forced:i.FORCED,instreamId:i["INSTREAM-ID"],characteristics:i.CHARACTERISTICS,channels:i.CHANNELS})),a=e[o.camelify(r)],c=function(e,t){var r,i=!1,s=n(e);try{for(s.s();!(r=s.n()).done;){var a=r.value;if(a.name===t.name)return"All EXT-X-MEDIA tags in the same Group MUST have different NAME attributes.";a.isDefault&&(i=!0)}}catch(e){s.e(e)}finally{s.f()}return i&&t.isDefault?"EXT-X-MEDIA A Group MUST NOT have more than one member with a DEFAULT attribute of YES.":""}(a,s);c&&o.INVALIDPLAYLIST(c),a.push(s),s.isDefault&&(e.currentRenditions[o.camelify(r)]=a.length-1)}function P(e,t,r,i,s){var a,c=new l({uri:r,bandwidth:t.BANDWIDTH,averageBandwidth:t["AVERAGE-BANDWIDTH"],codecs:t.CODECS,resolution:t.RESOLUTION,frameRate:t["FRAME-RATE"],hdcpLevel:t["HDCP-LEVEL"]}),u=n(e);try{for(u.s();!(a=u.n()).done;){var h=a.value;if("EXT-X-MEDIA"===h.name){var d=h.attributes,f=d.TYPE;if(f&&d["GROUP-ID"]||o.INVALIDPLAYLIST("EXT-X-MEDIA TYPE attribute is REQUIRED."),t[f]===d["GROUP-ID"]&&(R(c,h,f),"CLOSED-CAPTIONS"===f)){var _,p=n(c.closedCaptions);try{for(p.s();!(_=p.n()).done;){var v=_.value.instreamId;if(v&&v.startsWith("SERVICE")&&s.compatibleVersion<7){s.compatibleVersion=7;break}}}catch(e){p.e(e)}finally{p.f()}}}}}catch(e){u.e(e)}finally{u.f()}return function(e,t,r){["AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(n){"CLOSED-CAPTIONS"===n&&"NONE"===e[n]?(r.isClosedCaptionsNone=!0,t.closedCaptions=[]):e[n]&&!t[o.camelify(n)].find(function(t){return t.groupId===e[n]})&&o.INVALIDPLAYLIST("".concat(n," attribute MUST match the value of the GROUP-ID attribute of an EXT-X-MEDIA tag whose TYPE attribute is ").concat(n,"."))})}(t,c,s),c.isIFrameOnly=i,c}function D(e,t){if(e.method!==t.method)return!1;if(e.uri!==t.uri)return!1;if(e.iv){if(!t.iv)return!1;if(e.iv.length!==t.iv.length)return!1;for(var r=0;r<e.iv.length;r++)if(e.iv[r]!==t.iv[r])return!1}else if(t.iv)return!1;return e.format===t.format&&e.formatVersion===t.formatVersion}function L(e,t,r,n,i,s,a){for(var c=new g({uri:t,mediaSequenceNumber:i,discontinuitySequence:s}),u=!1,l=!1,h=function(t){var r=e[t],n=r.name,i=r.value,s=r.attributes;if("EXTINF"===n)!Number.isInteger(i.duration)&&a.compatibleVersion<3&&(a.compatibleVersion=3),Math.round(i.duration)>a.targetDuration&&o.INVALIDPLAYLIST("EXTINF duration, when rounded to the nearest integer, MUST be less than or equal to the target duration"),c.duration=i.duration,c.title=i.title;else if("EXT-X-BYTERANGE"===n)a.compatibleVersion<4&&(a.compatibleVersion=4),c.byterange=i;else if("EXT-X-DISCONTINUITY"===n)c.parts.length>0&&o.INVALIDPLAYLIST("EXT-X-DISCONTINUITY must appear before the first EXT-X-PART tag of the Parent Segment."),c.discontinuity=!0;else if("EXT-X-KEY"===n)c.parts.length>0&&o.INVALIDPLAYLIST("EXT-X-KEY must appear before the first EXT-X-PART tag of the Parent Segment."),A(a,s),c.key=new d({method:s.METHOD,uri:s.URI,iv:s.IV,format:s.KEYFORMAT,formatVersion:s.KEYFORMATVERSIONS});else if("EXT-X-MAP"===n)c.parts.length>0&&o.INVALIDPLAYLIST("EXT-X-MAP must appear before the first EXT-X-PART tag of the Parent Segment."),a.compatibleVersion<5&&(a.compatibleVersion=5),a.hasMap=!0,c.map=new f({uri:s.URI,byterange:s.BYTERANGE});else if("EXT-X-PROGRAM-DATE-TIME"===n)c.programDateTime=i;else if("EXT-X-DATERANGE"===n){var h={};Object.keys(s).forEach(function(e){(e.startsWith("SCTE35-")||e.startsWith("X-"))&&(h[e]=s[e])}),c.dateRange=new _({id:s.ID,classId:s.CLASS,start:s["START-DATE"],end:s["END-DATE"],duration:s.DURATION,plannedDuration:s["PLANNED-DURATION"],endOnNext:s["END-ON-NEXT"],attributes:h})}else if("EXT-X-CUE-OUT"===n)c.markers.push(new p({type:"OUT",duration:i}));else if("EXT-X-CUE-IN"===n)c.markers.push(new p({type:"IN"}));else if("EXT-X-CUE-OUT-CONT"===n||"EXT-X-CUE"===n||"EXT-OATCLS-SCTE35"===n||"EXT-X-ASSET"===n||"EXT-X-SCTE35"===n)c.markers.push(new p({type:"RAW",tagName:n,value:i}));else if("EXT-X-PRELOAD-HINT"!==n||s.TYPE)if("EXT-X-PRELOAD-HINT"===n&&"PART"===s.TYPE&&l)o.INVALIDPLAYLIST("Servers should not add more than one EXT-X-PRELOAD-HINT tag with the same TYPE attribute to a Playlist.");else if("EXT-X-PART"!==n&&"EXT-X-PRELOAD-HINT"!==n||s.URI){if("EXT-X-PRELOAD-HINT"===n&&"MAP"===s.TYPE)u&&o.INVALIDPLAYLIST("Servers should not add more than one EXT-X-PRELOAD-HINT tag with the same TYPE attribute to a Playlist."),u=!0,a.hasMap=!0,c.map=new f({hint:!0,uri:s.URI,byterange:{length:s["BYTERANGE-LENGTH"],offset:s["BYTERANGE-START"]||0}});else if("EXT-X-PART"===n||"EXT-X-PRELOAD-HINT"===n&&"PART"===s.TYPE){"EXT-X-PART"!==n||s.DURATION||o.INVALIDPLAYLIST("EXT-X-PART: DURATION attribute is mandatory"),"EXT-X-PRELOAD-HINT"===n&&(l=!0);var v=new E({hint:"EXT-X-PRELOAD-HINT"===n,uri:s.URI,byterange:"EXT-X-PART"===n?s.BYTERANGE:{length:s["BYTERANGE-LENGTH"],offset:s["BYTERANGE-START"]||0},duration:s.DURATION,independent:s.INDEPENDENT,gap:s.GAP});c.parts.push(v)}}else o.INVALIDPLAYLIST("EXT-X-PART / EXT-X-PRELOAD-HINT: URI attribute is mandatory");else o.INVALIDPLAYLIST("EXT-X-PRELOAD-HINT: TYPE attribute is mandatory")},v=r;v<=n;v++)h(v);return c}function k(e,t,r,n,i){var s=t.discontinuity,a=t.key,c=t.map,u=t.byterange,l=t.uri;if(s&&(t.discontinuitySequence=r+1),a||(t.key=n),c||(t.map=i),u&&-1===u.offset){var h=e.segments;if(h.length>0){var d=h[h.length-1];d.byterange&&d.uri===l?u.offset=d.byterange.offset+d.byterange.length:o.INVALIDPLAYLIST("If offset of EXT-X-BYTERANGE is not present, a previous Media Segment MUST be a sub-range of the same media resource")}else o.INVALIDPLAYLIST("If offset of EXT-X-BYTERANGE is not present, a previous Media Segment MUST appear in the Playlist file")}return e.segments.push(t),[t.discontinuitySequence,t.key,t.map]}function C(e,t){var r=i(function(e){var t=e.indexOf(":");return-1===t?[e.slice(1).trim(),null]:[e.slice(1,t).trim(),e.slice(t+1).trim()]}(e),2),n=r[0],s=r[1],a=function(e){switch(e){case"EXTM3U":case"EXT-X-VERSION":return"Basic";case"EXTINF":case"EXT-X-BYTERANGE":case"EXT-X-DISCONTINUITY":case"EXT-X-KEY":case"EXT-X-MAP":case"EXT-X-PROGRAM-DATE-TIME":case"EXT-X-DATERANGE":case"EXT-X-CUE-OUT":case"EXT-X-CUE-IN":case"EXT-X-CUE-OUT-CONT":case"EXT-X-CUE":case"EXT-OATCLS-SCTE35":case"EXT-X-ASSET":case"EXT-X-SCTE35":case"EXT-X-PART":case"EXT-X-PRELOAD-HINT":return"Segment";case"EXT-X-TARGETDURATION":case"EXT-X-MEDIA-SEQUENCE":case"EXT-X-DISCONTINUITY-SEQUENCE":case"EXT-X-ENDLIST":case"EXT-X-PLAYLIST-TYPE":case"EXT-X-I-FRAMES-ONLY":case"EXT-X-SERVER-CONTROL":case"EXT-X-PART-INF":case"EXT-X-RENDITION-REPORT":case"EXT-X-SKIP":return"MediaPlaylist";case"EXT-X-MEDIA":case"EXT-X-STREAM-INF":case"EXT-X-I-FRAME-STREAM-INF":case"EXT-X-SESSION-DATA":case"EXT-X-SESSION-KEY":return"MasterPlaylist";case"EXT-X-INDEPENDENT-SEGMENTS":case"EXT-X-START":return"MediaorMasterPlaylist";default:return"Unknown"}}(n);if(function(e,t){if("Segment"===e||"MediaPlaylist"===e)return void 0===t.isMasterPlaylist?void(t.isMasterPlaylist=!1):void(t.isMasterPlaylist&&w());if("MasterPlaylist"===e){if(void 0===t.isMasterPlaylist)return void(t.isMasterPlaylist=!0);!1===t.isMasterPlaylist&&w()}}(a,t),"Unknown"===a)return null;"MediaPlaylist"===a&&"EXT-X-RENDITION-REPORT"!==n&&(t.hash[n]&&o.INVALIDPLAYLIST("There MUST NOT be more than one Media Playlist tag of each type in any Media Playlist"),t.hash[n]=!0);var c=i(function(e,t){switch(e){case"EXTM3U":case"EXT-X-DISCONTINUITY":case"EXT-X-ENDLIST":case"EXT-X-I-FRAMES-ONLY":case"EXT-X-INDEPENDENT-SEGMENTS":case"EXT-X-CUE-IN":return[null,null];case"EXT-X-VERSION":case"EXT-X-TARGETDURATION":case"EXT-X-MEDIA-SEQUENCE":case"EXT-X-DISCONTINUITY-SEQUENCE":case"EXT-X-CUE-OUT":return[o.toNumber(t),null];case"EXT-X-KEY":case"EXT-X-MAP":case"EXT-X-DATERANGE":case"EXT-X-MEDIA":case"EXT-X-STREAM-INF":case"EXT-X-I-FRAME-STREAM-INF":case"EXT-X-SESSION-DATA":case"EXT-X-SESSION-KEY":case"EXT-X-START":case"EXT-X-SERVER-CONTROL":case"EXT-X-PART-INF":case"EXT-X-PART":case"EXT-X-PRELOAD-HINT":case"EXT-X-RENDITION-REPORT":case"EXT-X-SKIP":return[null,I(t)];case"EXTINF":return[S(t),null];case"EXT-X-BYTERANGE":return[b(t),null];case"EXT-X-PROGRAM-DATE-TIME":return[new Date(t),null];default:return[t,null]}}(n,s),2);return{name:n,category:a,value:c[0],attributes:c[1]}}function O(e,t){var r;return t.isMasterPlaylist?r=function(e,t){var r,s=new v,a=n(e.entries());try{for(a.s();!(r=a.n()).done;){var c=i(r.value,2),u=c[0],l=c[1],f=l.name,_=l.value,p=l.attributes;if("EXT-X-VERSION"===f)s.version=_;else if("EXT-X-STREAM-INF"===f){var m=e[u+1];("string"!=typeof m||m.startsWith("#EXT"))&&o.INVALIDPLAYLIST("EXT-X-STREAM-INF must be followed by a URI line");var g=P(e,p,m,!1,t);g&&s.variants.push(g)}else if("EXT-X-I-FRAME-STREAM-INF"===f){var E=P(e,p,p.URI,!0,t);E&&s.variants.push(E)}else"EXT-X-SESSION-DATA"===f?function(){var e=new h({id:p["DATA-ID"],value:p.VALUE,uri:p.URI,language:p.LANGUAGE});s.sessionDataList.find(function(t){return t.id===e.id&&t.language===e.language})&&o.INVALIDPLAYLIST("A Playlist MUST NOT contain more than one EXT-X-SESSION-DATA tag with the same DATA-ID attribute and the same LANGUAGE attribute."),s.sessionDataList.push(e)}():"EXT-X-SESSION-KEY"===f?function(){"NONE"===p.METHOD&&o.INVALIDPLAYLIST("EXT-X-SESSION-KEY: The value of the METHOD attribute MUST NOT be NONE");var e=new d({method:p.METHOD,uri:p.URI,iv:p.IV,format:p.KEYFORMAT,formatVersion:p.KEYFORMATVERSIONS});s.sessionKeyList.find(function(t){return D(t,e)})&&o.INVALIDPLAYLIST("A Master Playlist MUST NOT contain more than one EXT-X-SESSION-KEY tag with the same METHOD, URI, IV, KEYFORMAT, and KEYFORMATVERSIONS attribute values."),A(t,p),s.sessionKeyList.push(e)}():"EXT-X-INDEPENDENT-SEGMENTS"===f?(s.independentSegments&&o.INVALIDPLAYLIST("EXT-X-INDEPENDENT-SEGMENTS tag MUST NOT appear more than once in a Playlist"),s.independentSegments=!0):"EXT-X-START"===f&&(s.start&&o.INVALIDPLAYLIST("EXT-X-START tag MUST NOT appear more than once in a Playlist"),"number"!=typeof p["TIME-OFFSET"]&&o.INVALIDPLAYLIST("EXT-X-START: TIME-OFFSET attribute is REQUIRED"),s.start={offset:p["TIME-OFFSET"],precise:p.PRECISE||!1})}}catch(e){a.e(e)}finally{a.f()}if(t.isClosedCaptionsNone){var T,y=n(s.variants);try{for(y.s();!(T=y.n()).done;)T.value.closedCaptions.length>0&&o.INVALIDPLAYLIST("If there is a variant with CLOSED-CAPTIONS attribute of NONE, all EXT-X-STREAM-INF tags MUST have this attribute with a value of NONE")}catch(e){y.e(e)}finally{y.f()}}return s}(e,t):!(r=function(e,t){var r,s=new m,a=-1,c=0,u=!1,l=0,h=null,d=null,f=!1,_=n(e.entries());try{for(_.s();!(r=_.n()).done;){var p=i(r.value,2),v=p[0],g=p[1],E=g.name,y=g.value,S=g.attributes;if("Segment"!==g.category){if("EXT-X-VERSION"===E)void 0===s.version?s.version=y:o.INVALIDPLAYLIST("A Playlist file MUST NOT contain more than one EXT-X-VERSION tag.");else if("EXT-X-TARGETDURATION"===E)s.targetDuration=t.targetDuration=y;else if("EXT-X-MEDIA-SEQUENCE"===E)s.segments.length>0&&o.INVALIDPLAYLIST("The EXT-X-MEDIA-SEQUENCE tag MUST appear before the first Media Segment in the Playlist."),s.mediaSequenceBase=c=y;else if("EXT-X-DISCONTINUITY-SEQUENCE"===E)s.segments.length>0&&o.INVALIDPLAYLIST("The EXT-X-DISCONTINUITY-SEQUENCE tag MUST appear before the first Media Segment in the Playlist."),u&&o.INVALIDPLAYLIST("The EXT-X-DISCONTINUITY-SEQUENCE tag MUST appear before any EXT-X-DISCONTINUITY tag."),s.discontinuitySequenceBase=l=y;else if("EXT-X-ENDLIST"===E)s.endlist=!0;else if("EXT-X-PLAYLIST-TYPE"===E)s.playlistType=y;else if("EXT-X-I-FRAMES-ONLY"===E)t.compatibleVersion<4&&(t.compatibleVersion=4),s.isIFrame=!0;else if("EXT-X-INDEPENDENT-SEGMENTS"===E)s.independentSegments&&o.INVALIDPLAYLIST("EXT-X-INDEPENDENT-SEGMENTS tag MUST NOT appear more than once in a Playlist"),s.independentSegments=!0;else if("EXT-X-START"===E)s.start&&o.INVALIDPLAYLIST("EXT-X-START tag MUST NOT appear more than once in a Playlist"),"number"!=typeof S["TIME-OFFSET"]&&o.INVALIDPLAYLIST("EXT-X-START: TIME-OFFSET attribute is REQUIRED"),s.start={offset:S["TIME-OFFSET"],precise:S.PRECISE||!1};else if("EXT-X-SERVER-CONTROL"===E)S["CAN-BLOCK-RELOAD"]||o.INVALIDPLAYLIST("EXT-X-SERVER-CONTROL: CAN-BLOCK-RELOAD=YES is mandatory for Low-Latency HLS"),s.lowLatencyCompatibility={canBlockReload:S["CAN-BLOCK-RELOAD"],canSkipUntil:S["CAN-SKIP-UNTIL"],holdBack:S["HOLD-BACK"],partHoldBack:S["PART-HOLD-BACK"]};else if("EXT-X-PART-INF"===E)S["PART-TARGET"]||o.INVALIDPLAYLIST("EXT-X-PART-INF: PART-TARGET attribute is mandatory"),s.partTargetDuration=S["PART-TARGET"];else if("EXT-X-RENDITION-REPORT"===E)S.URI||o.INVALIDPLAYLIST("EXT-X-RENDITION-REPORT: URI attribute is mandatory"),0===S.URI.search(/^[a-z]+:/)&&o.INVALIDPLAYLIST("EXT-X-RENDITION-REPORT: URI must be relative to the playlist uri"),s.renditionReports.push(new T({uri:S.URI,lastMSN:S["LAST-MSN"],lastPart:S["LAST-PART"]}));else if("EXT-X-SKIP"===E)S["SKIPPED-SEGMENTS"]||o.INVALIDPLAYLIST("EXT-X-SKIP: SKIPPED-SEGMENTS attribute is mandatory"),t.compatibleVersion<9&&(t.compatibleVersion=9),s.skip=S["SKIPPED-SEGMENTS"],c+=s.skip;else if("string"==typeof g){-1===a&&o.INVALIDPLAYLIST("A URI line is not preceded by any segment tags"),s.targetDuration||o.INVALIDPLAYLIST("The EXT-X-TARGETDURATION tag is REQUIRED");var b=L(e,g,a,v-1,c++,l,t);if(b){var A=i(k(s,b,l,h,d),3);l=A[0],h=A[1],d=A[2],!f&&b.parts.length>0&&(f=!0)}a=-1}}else-1===a&&(a=v),"EXT-X-DISCONTINUITY"===E&&(u=!0)}}catch(e){_.e(e)}finally{_.f()}if(-1!==a){var I=L(e,"",a,e.length-1,c++,l,t);if(I){var w=I.parts;w.length>0&&!s.endlist&&!w[w.length-1].hint&&o.INVALIDPLAYLIST("If the Playlist contains EXT-X-PART tags and does not contain an EXT-X-ENDLIST tag, the Playlist must contain an EXT-X-PRELOAD-HINT tag with a TYPE=PART attribute"),k(s,I,h,d),!f&&I.parts.length>0&&(f=!0)}}return function(e){for(var t=new Map,r=new Map,i=!1,s=!1,a=e.length-1;a>=0;a--){var c=e[a],u=c.programDateTime,l=c.dateRange;if(u&&(s=!0),l&&l.start){i=!0,l.endOnNext&&(l.end||l.duration)&&o.INVALIDPLAYLIST("An EXT-X-DATERANGE tag with an END-ON-NEXT=YES attribute MUST NOT contain DURATION or END-DATE attributes.");var h=l.start.getTime(),d=l.duration||0;l.end&&l.duration&&h+1e3*d!==l.end.getTime()&&o.INVALIDPLAYLIST("END-DATE MUST be equal to the value of the START-DATE attribute plus the value of the DURATION"),l.endOnNext&&(l.end=t.get(l.classId)),t.set(l.classId,l.start);var f=l.end?l.end.getTime():l.start.getTime()+1e3*(l.duration||0),_=r.get(l.classId);if(_){var p,v=n(_);try{for(v.s();!(p=v.n()).done;){var m=p.value;(m.start<=h&&m.end>h||m.start>=h&&m.start<f)&&o.INVALIDPLAYLIST("DATERANGE tags with the same CLASS should not overlap")}}catch(e){v.e(e)}finally{v.f()}_.push({start:h,end:f})}else r.set(l.classId,[{start:h,end:f}])}}i&&!s&&o.INVALIDPLAYLIST("If a Playlist contains an EXT-X-DATERANGE tag, it MUST also contain at least one EXT-X-PROGRAM-DATE-TIME tag.")}(s.segments),s.lowLatencyCompatibility&&function(e,t){var r=e.lowLatencyCompatibility,s=e.targetDuration,a=e.partTargetDuration,c=e.segments,u=e.renditionReports,l=r.canSkipUntil,h=r.holdBack,d=r.partHoldBack;if(l<6*s&&o.INVALIDPLAYLIST("The Skip Boundary must be at least six times the EXT-X-TARGETDURATION."),h<3*s&&o.INVALIDPLAYLIST("HOLD-BACK must be at least three times the EXT-X-TARGETDURATION."),t){void 0===a&&o.INVALIDPLAYLIST("EXT-X-PART-INF is required if a Playlist contains one or more EXT-X-PART tags"),void 0===d&&o.INVALIDPLAYLIST("EXT-X-PART: PART-HOLD-BACK attribute is mandatory"),d<a&&o.INVALIDPLAYLIST("PART-HOLD-BACK must be at least PART-TARGET");var f,_=n(c.entries());try{for(_.s();!(f=_.n()).done;){var p=i(f.value,2),v=p[0],m=p[1].parts;m.length>0&&v<c.length-3&&o.INVALIDPLAYLIST("Remove EXT-X-PART tags from the Playlist after they are greater than three target durations from the end of the Playlist.");var g,E=n(m.entries());try{for(E.s();!(g=E.n()).done;){var T=i(g.value,2),y=T[0],S=T[1].duration;void 0!==S&&(S>a&&o.INVALIDPLAYLIST("PART-TARGET is the maximum duration of any Partial Segment"),y<m.length-1&&S<.85*a&&o.INVALIDPLAYLIST("All Partial Segments except the last part of a segment must have a duration of at least 85% of PART-TARGET"))}}catch(e){E.e(e)}finally{E.f()}}}catch(e){_.e(e)}finally{_.f()}}var b,A=n(u);try{for(A.s();!(b=A.n()).done;){var I=b.value,w=c[c.length-1];I.lastMSN||(I.lastMSN=w.mediaSequenceNumber),!I.lastPart&&w.parts.length>0&&(I.lastPart=w.parts.length-1)}}catch(e){A.e(e)}finally{A.f()}}(s,f),s}(e,t)).isIFrame&&t.hasMap&&t.compatibleVersion<6&&(t.compatibleVersion=6),t.compatibleVersion>1&&(!r.version||r.version<t.compatibleVersion)&&o.INVALIDPLAYLIST("EXT-X-VERSION needs to be ".concat(t.compatibleVersion," or higher.")),r}e.exports=function(e){var t={version:void 0,isMasterPlaylist:void 0,hasMap:!1,targetDuration:0,compatibleVersion:1,isClosedCaptionsNone:!1,hash:{}},r=O(function(e,t){var r=[];return e.split("\n").forEach(function(e){var n=e.trim();if(n)if(n.startsWith("#")){if(n.startsWith("#EXT")){var i=C(n,t);return void(i&&r.push(i))}}else r.push(n)}),0!==r.length&&"EXTM3U"===r[0].name||o.INVALIDPLAYLIST("The EXTM3U tag MUST be the first line."),r}(e,t),t);return r.source=e,r}},367:(e,t,r)=>{function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,s=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,s=e}finally{try{n||null==o.return||o.return()}finally{if(i)throw s}}return r}}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=a(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){c=!0,s=e},f:function(){try{o||null==r.return||r.return()}finally{if(c)throw s}}}}function a(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t,r){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){var t="function"==typeof Map?new Map:void 0;return(l=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return h(e,arguments,_(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),f(n,e)})(e)}function h(e,t,r){return(h=d()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&f(i,r.prototype),i}).apply(null,arguments)}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=r(771),v=["#EXTINF","#EXT-X-BYTERANGE","#EXT-X-DISCONTINUITY","#EXT-X-STREAM-INF","#EXT-X-CUE-OUT","#EXT-X-CUE-IN","#EXT-X-KEY","#EXT-X-MAP"],m=["#EXT-X-MEDIA"],g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(s,e);var t,r,n,i=(t=s,r=d(),function(){var e,n=_(t);if(r){var i=_(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return u(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=i.call(this)).baseUri=e,t}return(n=[{key:"push",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var i=function(){var t=o[a];if(!t.startsWith("#"))return c(_(s.prototype),"push",e).call(e,t),"continue";if(v.some(function(e){return t.startsWith(e)}))return c(_(s.prototype),"push",e).call(e,t),"continue";if(e.includes(t)){if(m.some(function(e){return t.startsWith(e)}))return"continue";p.INVALIDPLAYLIST("Redundant item (".concat(t,")"))}c(_(s.prototype),"push",e).call(e,t)},a=0,o=r;a<o.length;a++)i()}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(s.prototype,n),s}(l(Array));function E(e,t){var r=1e3;t&&(r=Math.pow(10,t));var n=Math.round(e*r)/r;return t?n.toFixed(t):n}function T(e){var t=['DATA-ID="'.concat(e.id,'"')];return e.language&&t.push('LANGUAGE="'.concat(e.language,'"')),e.value?t.push('VALUE="'.concat(e.value,'"')):e.uri&&t.push('URI="'.concat(e.uri,'"')),"#EXT-X-SESSION-DATA:".concat(t.join(","))}function y(e,t){var r=t?"#EXT-X-SESSION-KEY":"#EXT-X-KEY",n=["METHOD=".concat(e.method)];return e.uri&&n.push('URI="'.concat(e.uri,'"')),e.iv&&(16!==e.iv.length&&p.INVALIDPLAYLIST("IV must be a 128-bit unsigned integer"),n.push("IV=".concat(p.byteSequenceToHex(e.iv)))),e.format&&n.push('KEYFORMAT="'.concat(e.format,'"')),e.formatVersion&&n.push('KEYFORMATVERSIONS="'.concat(e.formatVersion,'"')),"".concat(r,":").concat(n.join(","))}function S(e,t){var r=t.isIFrameOnly?"#EXT-X-I-FRAME-STREAM-INF":"#EXT-X-STREAM-INF",n=["BANDWIDTH=".concat(t.bandwidth)];if(t.averageBandwidth&&n.push("AVERAGE-BANDWIDTH=".concat(t.averageBandwidth)),t.isIFrameOnly&&n.push('URI="'.concat(t.uri,'"')),t.codecs&&n.push('CODECS="'.concat(t.codecs,'"')),t.resolution&&n.push("RESOLUTION=".concat(t.resolution.width,"x").concat(t.resolution.height)),t.frameRate&&n.push("FRAME-RATE=".concat(E(t.frameRate,3))),t.hdcpLevel&&n.push("HDCP-LEVEL=".concat(t.hdcpLevel)),t.audio.length>0){n.push('AUDIO="'.concat(t.audio[0].groupId,'"'));var i,a=s(t.audio);try{for(a.s();!(i=a.n()).done;){var o=i.value;e.push(b(o))}}catch(e){a.e(e)}finally{a.f()}}if(t.video.length>0){n.push('VIDEO="'.concat(t.video[0].groupId,'"'));var c,u=s(t.video);try{for(u.s();!(c=u.n()).done;){var l=c.value;e.push(b(l))}}catch(e){u.e(e)}finally{u.f()}}if(t.subtitles.length>0){n.push('SUBTITLES="'.concat(t.subtitles[0].groupId,'"'));var h,d=s(t.subtitles);try{for(d.s();!(h=d.n()).done;){var f=h.value;e.push(b(f))}}catch(e){d.e(e)}finally{d.f()}}if(p.getOptions().allowClosedCaptionsNone&&0===t.closedCaptions.length)n.push("CLOSED-CAPTIONS=NONE");else if(t.closedCaptions.length>0){n.push('CLOSED-CAPTIONS="'.concat(t.closedCaptions[0].groupId,'"'));var _,v=s(t.closedCaptions);try{for(v.s();!(_=v.n()).done;){var m=_.value;e.push(b(m))}}catch(e){v.e(e)}finally{v.f()}}e.push("".concat(r,":").concat(n.join(","))),t.isIFrameOnly||e.push("".concat(t.uri))}function b(e){var t=["TYPE=".concat(e.type),'GROUP-ID="'.concat(e.groupId,'"'),'NAME="'.concat(e.name,'"')];return void 0!==e.isDefault&&t.push("DEFAULT=".concat(e.isDefault?"YES":"NO")),void 0!==e.autoselect&&t.push("AUTOSELECT=".concat(e.autoselect?"YES":"NO")),void 0!==e.forced&&t.push("FORCED=".concat(e.forced?"YES":"NO")),e.language&&t.push('LANGUAGE="'.concat(e.language,'"')),e.assocLanguage&&t.push('ASSOC-LANGUAGE="'.concat(e.assocLanguage,'"')),e.instreamId&&t.push('INSTREAM-ID="'.concat(e.instreamId,'"')),e.characteristics&&t.push('CHARACTERISTICS="'.concat(e.characteristics,'"')),e.channels&&t.push('CHANNELS="'.concat(e.channels,'"')),e.uri&&t.push('URI="'.concat(e.uri,'"')),"#EXT-X-MEDIA:".concat(t.join(","))}function A(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=!1;if(t.byterange&&e.push("#EXT-X-BYTERANGE:".concat(I(t.byterange))),t.discontinuity&&e.push("#EXT-X-DISCONTINUITY"),t.key){var a=y(t.key);a!==r&&(e.push(a),r=a)}if(t.map){var o=function(e){var t=['URI="'.concat(e.uri,'"')];return e.byterange&&t.push('BYTERANGE="'.concat(I(e.byterange),'"')),"#EXT-X-MAP:".concat(t.join(","))}(t.map);o!==n&&(e.push(o),n=o)}if(t.programDateTime&&e.push("#EXT-X-PROGRAM-DATE-TIME:".concat(p.formatDate(t.programDateTime))),t.dateRange&&e.push(function(e){var t=['ID="'.concat(e.id,'"')];return e.start&&t.push('START-DATE="'.concat(p.formatDate(e.start),'"')),e.end&&t.push('END-DATE="'.concat(e.end,'"')),e.duration&&t.push("DURATION=".concat(e.duration)),e.plannedDuration&&t.push("PLANNED-DURATION=".concat(e.plannedDuration)),e.classId&&t.push('CLASS="'.concat(e.classId,'"')),e.endOnNext&&t.push("END-ON-NEXT=YES"),Object.keys(e.attributes).forEach(function(r){r.startsWith("X-")?"number"==typeof e.attributes[r]?t.push("".concat(r,"=").concat(e.attributes[r])):t.push("".concat(r,'="').concat(e.attributes[r],'"')):r.startsWith("SCTE35-")&&t.push("".concat(r,"=").concat(p.byteSequenceToHex(e.attributes[r])))}),"#EXT-X-DATERANGE:".concat(t.join(","))}(t.dateRange)),t.markers.length>0&&w(e,t.markers),t.parts.length>0&&(s=R(e,t.parts)),s)return[r,n];var c=i<3?Math.round(t.duration):E(t.duration,function(e){var t=e.toString(10),r=t.indexOf(".");return-1===r?0:t.length-r-1}(t.duration));return e.push("#EXTINF:".concat(c,",").concat(unescape(encodeURIComponent(t.title||"")))),Array.prototype.push.call(e,"".concat(t.uri)),[r,n]}function I(e){var t=e.offset,r=e.length;return"".concat(r,"@").concat(t)}function w(e,t){var r,n=s(t);try{for(n.s();!(r=n.n()).done;){var i=r.value;if("OUT"===i.type)e.push("#EXT-X-CUE-OUT:".concat(i.duration));else if("IN"===i.type)e.push("#EXT-X-CUE-IN");else if("RAW"===i.type){var a=i.value?":".concat(i.value):"";e.push("#".concat(i.tagName).concat(a))}}}catch(e){n.e(e)}finally{n.f()}}function R(e,t){var r,n=!1,i=s(t);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.hint){var o=[];if(o.push("TYPE=PART"),o.push('URI="'.concat(a.uri,'"')),a.byterange){var c=a.byterange,u=c.offset,l=c.length;o.push("BYTERANGE-START=".concat(u)),l&&o.push("BYTERANGE-LENGTH=".concat(l))}e.push("#EXT-X-PRELOAD-HINT:".concat(o.join(","))),n=!0}else{var h=[];h.push("DURATION=".concat(a.duration)),h.push('URI="'.concat(a.uri,'"')),a.byterange&&h.push("BYTERANGE=".concat(I(a.byterange))),a.independent&&h.push("INDEPENDENT=YES"),a.gap&&h.push("GAP=YES"),e.push("#EXT-X-PART:".concat(h.join(",")))}}}catch(e){i.e(e)}finally{i.f()}return n}e.exports=function(e){p.PARAMCHECK(e),p.ASSERT("Not a playlist","playlist"===e.type);var t=new g(e.uri);return t.push("#EXTM3U"),e.version&&t.push("#EXT-X-VERSION:".concat(e.version)),e.independentSegments&&t.push("#EXT-X-INDEPENDENT-SEGMENTS"),e.start&&t.push("#EXT-X-START:TIME-OFFSET=".concat(E(e.start.offset)).concat(e.start.precise?",PRECISE=YES":"")),e.isMasterPlaylist?function(e,t){var r,n=s(t.sessionDataList);try{for(n.s();!(r=n.n()).done;){var i=r.value;e.push(T(i))}}catch(e){n.e(e)}finally{n.f()}var a,o=s(t.sessionKeyList);try{for(o.s();!(a=o.n()).done;){var c=a.value;e.push(y(c,!0))}}catch(e){o.e(e)}finally{o.f()}var u,l=s(t.variants);try{for(l.s();!(u=l.n()).done;)S(e,u.value)}catch(e){l.e(e)}finally{l.f()}}(t,e):function(e,t){var r="",n="";if(t.targetDuration&&e.push("#EXT-X-TARGETDURATION:".concat(t.targetDuration)),t.lowLatencyCompatibility){var a=t.lowLatencyCompatibility,o=a.canBlockReload,c=a.canSkipUntil,u=a.holdBack,l=a.partHoldBack,h=[];h.push("CAN-BLOCK-RELOAD=".concat(o?"YES":"NO")),void 0!==c&&h.push("CAN-SKIP-UNTIL=".concat(c)),void 0!==u&&h.push("HOLD-BACK=".concat(u)),void 0!==l&&h.push("PART-HOLD-BACK=".concat(l)),e.push("#EXT-X-SERVER-CONTROL:".concat(h.join(",")))}t.partTargetDuration&&e.push("#EXT-X-PART-INF:PART-TARGET=".concat(t.partTargetDuration)),t.mediaSequenceBase&&e.push("#EXT-X-MEDIA-SEQUENCE:".concat(t.mediaSequenceBase)),t.discontinuitySequenceBase&&e.push("#EXT-X-DISCONTINUITY-SEQUENCE:".concat(t.discontinuitySequenceBase)),t.playlistType&&e.push("#EXT-X-PLAYLIST-TYPE:".concat(t.playlistType)),t.isIFrame&&e.push("#EXT-X-I-FRAMES-ONLY"),t.skip>0&&e.push("#EXT-X-SKIP:SKIPPED-SEGMENTS=".concat(t.skip));var d,f=s(t.segments);try{for(f.s();!(d=f.n()).done;){var _=i(A(e,d.value,r,n,t.version),2);r=_[0],n=_[1]}}catch(e){f.e(e)}finally{f.f()}t.endlist&&e.push("#EXT-X-ENDLIST");var p,v=s(t.renditionReports);try{for(v.s();!(p=v.n()).done;){var m=p.value,g=[];g.push('URI="'.concat(m.uri,'"')),g.push("LAST-MSN=".concat(m.lastMSN)),void 0!==m.lastPart&&g.push("LAST-PART=".concat(m.lastPart)),e.push("#EXT-X-RENDITION-REPORT:".concat(g.join(",")))}}catch(e){v.e(e)}finally{v.f()}}(t,e),t.join("\n")}},890:(e,t,r)=>{function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var i=c(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return o(this,r)}}function o(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var l=r(771),h=function e(t){u(this,e),l.PARAMCHECK(t),this.type=t},d=function(e){i(r,e);var t=a(r);function r(e){var n,i=e.isMasterPlaylist,s=e.uri,a=e.version,o=e.independentSegments,c=void 0!==o&&o,h=e.start,d=e.source;return u(this,r),n=t.call(this,"playlist"),l.PARAMCHECK(i),n.isMasterPlaylist=i,n.uri=s,n.version=a,n.independentSegments=c,n.start=h,n.source=d,n}return r}(h),f=function(e){i(r,e);var t=a(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(this,r),n.isMasterPlaylist=!0,e=t.call(this,n);var i=n.variants,s=void 0===i?[]:i,a=n.currentVariant,o=n.sessionDataList,c=void 0===o?[]:o,l=n.sessionKeyList,h=void 0===l?[]:l;return e.variants=s,e.currentVariant=a,e.sessionDataList=c,e.sessionKeyList=h,e}return r}(d),_=function(e){i(r,e);var t=a(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(this,r),n.isMasterPlaylist=!1,e=t.call(this,n);var i=n.targetDuration,s=n.mediaSequenceBase,a=void 0===s?0:s,o=n.discontinuitySequenceBase,c=void 0===o?0:o,l=n.endlist,h=void 0!==l&&l,d=n.playlistType,f=n.isIFrame,_=n.segments,p=void 0===_?[]:_,v=n.lowLatencyCompatibility,m=n.partTargetDuration,g=n.renditionReports,E=void 0===g?[]:g,T=n.skip,y=void 0===T?0:T,S=n.hash;return e.targetDuration=i,e.mediaSequenceBase=a,e.discontinuitySequenceBase=c,e.endlist=h,e.playlistType=d,e.isIFrame=f,e.segments=p,e.lowLatencyCompatibility=v,e.partTargetDuration=m,e.renditionReports=E,e.skip=y,e.hash=S,e}return r}(d),p=function(e){i(r,e);var t=a(r);function r(e){var n,i=e.uri,s=e.mimeType,a=e.data,o=e.duration,c=e.title,l=e.byterange,h=e.discontinuity,d=e.mediaSequenceNumber,f=void 0===d?0:d,_=e.discontinuitySequence,p=void 0===_?0:_,v=e.key,m=e.map,g=e.programDateTime,E=e.dateRange,T=e.markers,y=void 0===T?[]:T,S=e.parts,b=void 0===S?[]:S;return u(this,r),(n=t.call(this,"segment")).uri=i,n.mimeType=s,n.data=a,n.duration=o,n.title=c,n.byterange=l,n.discontinuity=h,n.mediaSequenceNumber=f,n.discontinuitySequence=p,n.key=v,n.map=m,n.programDateTime=g,n.dateRange=E,n.markers=y,n.parts=b,n}return r}(h),v=function(e){i(r,e);var t=a(r);function r(e){var n,i=e.hint,s=void 0!==i&&i,a=e.uri,o=e.duration,c=e.independent,h=e.byterange,d=e.gap;return u(this,r),n=t.call(this,"part"),l.PARAMCHECK(a),n.hint=s,n.uri=a,n.duration=o,n.independent=c,n.duration=o,n.byterange=h,n.gap=d,n}return r}(h);e.exports={Rendition:function e(t){var r=t.type,n=t.uri,i=t.groupId,s=t.language,a=t.assocLanguage,o=t.name,c=t.isDefault,h=t.autoselect,d=t.forced,f=t.instreamId,_=t.characteristics,p=t.channels;u(this,e),l.PARAMCHECK(r,i,o),l.CONDITIONALASSERT(["SUBTITLES"===r,n],["CLOSED-CAPTIONS"===r,f],["CLOSED-CAPTIONS"===r,!n],[d,"SUBTITLES"===r]),this.type=r,this.uri=n,this.groupId=i,this.language=s,this.assocLanguage=a,this.name=o,this.isDefault=c,this.autoselect=h,this.forced=d,this.instreamId=f,this.characteristics=_,this.channels=p},Variant:function e(t){var r=t.uri,n=t.isIFrameOnly,i=void 0!==n&&n,s=t.bandwidth,a=t.averageBandwidth,o=t.codecs,c=t.resolution,h=t.frameRate,d=t.hdcpLevel,f=t.audio,_=void 0===f?[]:f,p=t.video,v=void 0===p?[]:p,m=t.subtitles,g=void 0===m?[]:m,E=t.closedCaptions,T=void 0===E?[]:E,y=t.currentRenditions,S=void 0===y?{audio:0,video:0,subtitles:0,closedCaptions:0}:y;u(this,e),l.PARAMCHECK(r,s),this.uri=r,this.isIFrameOnly=i,this.bandwidth=s,this.averageBandwidth=a,this.codecs=o,this.resolution=c,this.frameRate=h,this.hdcpLevel=d,this.audio=_,this.video=v,this.subtitles=g,this.closedCaptions=T,this.currentRenditions=S},SessionData:function e(t){var r=t.id,n=t.value,i=t.uri,s=t.language;u(this,e),l.PARAMCHECK(r,n||i),l.ASSERT("SessionData cannot have both value and uri, shoud be either.",!(n&&i)),this.id=r,this.value=n,this.uri=i,this.language=s},Key:function e(t){var r=t.method,n=t.uri,i=t.iv,s=t.format,a=t.formatVersion;u(this,e),l.PARAMCHECK(r),l.CONDITIONALPARAMCHECK(["NONE"!==r,n]),l.CONDITIONALASSERT(["NONE"===r,!(n||i||s||a)]),this.method=r,this.uri=n,this.iv=i,this.format=s,this.formatVersion=a},MediaInitializationSection:function e(t){var r=t.hint,n=void 0!==r&&r,i=t.uri,s=t.mimeType,a=t.byterange;u(this,e),l.PARAMCHECK(i),this.hint=n,this.uri=i,this.mimeType=s,this.byterange=a},DateRange:function e(t){var r=t.id,n=t.classId,i=t.start,s=t.end,a=t.duration,o=t.plannedDuration,c=t.endOnNext,h=t.attributes,d=void 0===h?{}:h;u(this,e),l.PARAMCHECK(r),l.CONDITIONALPARAMCHECK([!0===c,n]),l.CONDITIONALASSERT([s,i],[s,i<=s],[a,a>=0],[o,o>=0]),this.id=r,this.classId=n,this.start=i,this.end=s,this.duration=a,this.plannedDuration=o,this.endOnNext=c,this.attributes=d},SpliceInfo:function e(t){var r=t.type,n=t.duration,i=t.tagName,s=t.value;u(this,e),l.PARAMCHECK(r),l.CONDITIONALPARAMCHECK(["OUT"===r,n]),l.CONDITIONALPARAMCHECK(["RAW"===r,i]),this.type=r,this.duration=n,this.tagName=i,this.value=s},Playlist:d,MasterPlaylist:f,MediaPlaylist:_,Segment:p,PartialSegment:v,RenditionReport:function e(t){var r=t.uri,n=t.lastMSN,i=t.lastPart;u(this,e),l.PARAMCHECK(r),this.uri=r,this.lastMSN=n,this.lastPart=i}}},771:e=>{function t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,s=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,s=e}finally{try{n||null==o.return||o.return()}finally{if(i)throw s}}return r}}(e,t)||n(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=n(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,s=function(){};return{s:s,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){c=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(c)throw a}}}}function n(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var s={};function a(e){if(s.strictMode)throw e;s.silent}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;if("number"==typeof e)return e;var r=10===t?Number.parseFloat(e,t):Number.parseInt(e,t);return Number.isNaN(r)?0:r}e.exports={THROW:a,ASSERT:function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];var o,c=r(i.entries());try{for(c.s();!(o=c.n()).done;){var u=t(o.value,2),l=u[0];u[1]||a(new Error("".concat(e," : Failed at [").concat(l,"]")))}}catch(e){c.e(e)}finally{c.f()}},CONDITIONALASSERT:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var s,o=r(n.entries());try{for(o.s();!(s=o.n()).done;){var c=t(s.value,2),u=c[0],l=t(c[1],2),h=l[0],d=l[1];h&&(d||a(new Error("Conditional Assert : Failed at [".concat(u,"]"))))}}catch(e){o.e(e)}finally{o.f()}},PARAMCHECK:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var s,o=r(n.entries());try{for(o.s();!(s=o.n()).done;){var c=t(s.value,2),u=c[0];void 0===c[1]&&a(new Error("Param Check : Failed at [".concat(u,"]")))}}catch(e){o.e(e)}finally{o.f()}},CONDITIONALPARAMCHECK:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var s,o=r(n.entries());try{for(o.s();!(s=o.n()).done;){var c=t(s.value,2),u=c[0],l=t(c[1],2),h=l[0],d=l[1];h&&void 0===d&&a(new Error("Conditional Param Check : Failed at [".concat(u,"]")))}}catch(e){o.e(e)}finally{o.f()}},INVALIDPLAYLIST:function(e){a(new Error("Invalid Playlist : ".concat(e)))},toNumber:o,hexToByteSequence:function(e){(e.startsWith("0x")||e.startsWith("0X"))&&(e=e.slice(2));for(var t=[],r=0;r<e.length;r+=2)t.push(o(e.slice(r,r+2),16));return Buffer.from(t)},byteSequenceToHex:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length;r<=t&&a(new Error("end must be larger than start : start=".concat(t,", end=").concat(r)));for(var n=[],i=t;i<r;i++)n.push("0".concat((255&e[i]).toString(16).toUpperCase()).slice(-2));return"0x".concat(n.join(""))},tryCatch:function(e,t){try{return e()}catch(e){return t(e)}},splitAt:function(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=-1,i=0,s=0;i<e.length;i++)if(e[i]===t){if(s++===r)return[e.slice(0,i),e.slice(i+1)];n=i}return-1!==n?[e.slice(0,n),e.slice(n+1)]:[e]},trim:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return e?(e=e.trim()," "===t||(e.startsWith(t)&&(e=e.slice(1)),e.endsWith(t)&&(e=e.slice(0,-1))),e):e},splitByCommaWithPreservingQuotes:function(e){for(var t=[],r=!0,n=0,i=[],s=0;s<e.length;s++){var a=e[s];r&&","===a?(t.push(e.slice(n,s).trim()),n=s+1):'"'!==a&&"'"!==a||(r?(i.push(a),r=!1):a===i[i.length-1]?(i.pop(),r=!0):i.push(a))}return t.push(e.slice(n).trim()),t},camelify:function(e){var t,n=[],i=!1,s=r(e);try{for(s.s();!(t=s.n()).done;){var a=t.value;"-"!==a&&"_"!==a?i?(n.push(a.toUpperCase()),i=!1):n.push(a.toLowerCase()):i=!0}}catch(e){s.e(e)}finally{s.f()}return n.join("")},formatDate:function(e){var t=e.getUTCFullYear(),r=("0"+(e.getUTCMonth()+1)).slice(-2),n=("0"+e.getUTCDate()).slice(-2),i=("0"+e.getUTCHours()).slice(-2),s=("0"+e.getUTCMinutes()).slice(-2),a=("0"+e.getUTCSeconds()).slice(-2),o=("00"+e.getUTCMilliseconds()).slice(-3);return"".concat(t,"-").concat(r,"-").concat(n,"T").concat(i,":").concat(s,":").concat(a,".").concat(o,"Z")},hasOwnProp:function(e,t){return Object.hasOwnProperty.call(e,t)},setOptions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s=Object.assign(s,e)},getOptions:function(){return Object.assign({},s)}}}},t={},function r(n){if(t[n])return t[n].exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}(851);var e,t}()});function em(){return em=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},em.apply(this,arguments)}var tm,rm=["bottom","height","left","right","top","width"],nm=new Map,im=function e(){var t=[];nm.forEach(function(e,r){var n=r.getBoundingClientRect();(function(e,t){return void 0===e&&(e={}),void 0===t&&(t={}),rm.some(function(r){return e[r]!==t[r]})})(n,e.rect)&&(e.rect=n,t.push(e))}),t.forEach(function(e){e.callbacks.forEach(function(t){return t(e.rect)})}),tm=window.requestAnimationFrame(e)},sm="undefined"!=typeof window?Pv.useLayoutEffect:Pv.useEffect;function am(e,t){void 0===t&&(t={width:0,height:0});var r=Pv.useState(e.current),n=r[0],i=r[1],s=Pv.useReducer(om,t),a=s[0],o=s[1],c=Pv.useRef(!1);return sm(function(){e.current!==n&&i(e.current)}),sm(function(){if(n&&!c.current){c.current=!0;var e=n.getBoundingClientRect();o({rect:e})}},[n]),Pv.useEffect(function(){if(n){var e=function(e,t){return{observe:function(){var r=0===nm.size;nm.has(e)?nm.get(e).callbacks.push(t):nm.set(e,{rect:void 0,hasRectChanged:!1,callbacks:[t]}),r&&im()},unobserve:function(){var r=nm.get(e);if(r){var n=r.callbacks.indexOf(t);n>=0&&r.callbacks.splice(n,1),r.callbacks.length||nm.delete(e),nm.size||cancelAnimationFrame(tm)}}}}(n,function(e){o({rect:e})});return e.observe(),function(){e.unobserve()}}},[n]),a}function om(e,t){var r=t.rect;return e.height!==r.height||e.width!==r.width?r:e}var cm=function(){return 50},um=function(e){return e},lm=function(e,t){return e[t?"offsetWidth":"offsetHeight"]},hm=function(e){for(var t=Math.max(e.start-e.overscan,0),r=Math.min(e.end+e.overscan,e.size-1),n=[],i=t;i<=r;i++)n.push(i);return n};function dm(e){var t,r=e.size,n=void 0===r?0:r,i=e.estimateSize,s=void 0===i?cm:i,a=e.overscan,o=void 0===a?1:a,c=e.paddingStart,u=void 0===c?0:c,l=e.paddingEnd,h=void 0===l?0:l,d=e.parentRef,f=e.horizontal,_=e.scrollToFn,p=e.useObserver,v=e.initialRect,m=e.onScrollElement,g=e.scrollOffsetFn,E=e.keyExtractor,T=void 0===E?um:E,y=e.measureSize,S=void 0===y?lm:y,b=e.rangeExtractor,A=void 0===b?hm:b,I=f?"width":"height",w=f?"scrollLeft":"scrollTop",R=Pv.useRef({scrollOffset:0,measurements:[]}),P=Pv.useState(0),D=P[0],L=P[1];R.current.scrollOffset=D;var k=(p||am)(d,v)[I];R.current.outerSize=k;var C=Pv.useCallback(function(e){d.current&&(d.current[w]=e)},[d,w]),O=_||C;_=Pv.useCallback(function(e){O(e,C)},[C,O]);var N=Pv.useState({}),M=N[0],x=N[1],U=Pv.useCallback(function(){return x({})},[]),F=Pv.useRef([]),V=Pv.useMemo(function(){var e=F.current.length>0?Math.min.apply(Math,F.current):0;F.current=[];for(var t=R.current.measurements.slice(0,e),r=e;r<n;r++){var i=T(r),a=M[i],o=t[r-1]?t[r-1].end:u,c="number"==typeof a?a:s(r),l=o+c;t[r]={index:r,start:o,size:c,end:l,key:i}}return t},[s,M,u,n,T]),j=((null==(t=V[n-1])?void 0:t.end)||u)+h;R.current.measurements=V,R.current.totalSize=j;var H=m?m.current:d.current,B=Pv.useRef(g);B.current=g,sm(function(){if(H){var e=function(e){var t=B.current?B.current(e):H[w];L(t)};return e(),H.addEventListener("scroll",e,{capture:!1,passive:!0}),function(){H.removeEventListener("scroll",e)}}L(0)},[H,w]);var X=function(e){for(var t=e.measurements,r=e.outerSize,n=e.scrollOffset,i=t.length-1,s=fm(0,i,function(e){return t[e].start},n),a=s;a<i&&t[a].end<n+r;)a++;return{start:s,end:a}}(R.current),W=X.start,q=X.end,G=Pv.useMemo(function(){return A({start:W,end:q,overscan:o,size:V.length})},[W,q,o,V.length,A]),K=Pv.useRef(S);K.current=S;var Y=Pv.useMemo(function(){for(var e=[],t=function(t,r){var n=G[t],i=em(em({},V[n]),{},{measureRef:function(e){if(e){var t=K.current(e,f);if(t!==i.size){var r=R.current.scrollOffset;i.start<r&&C(r+(t-i.size)),F.current.push(n),x(function(e){var r;return em(em({},e),{},((r={})[i.key]=t,r))})}}}});e.push(i)},r=0,n=G.length;r<n;r++)t(r);return e},[G,C,f,V]),$=Pv.useRef(!1);sm(function(){$.current&&x({}),$.current=!0},[s]);var z=Pv.useCallback(function(e,t){var r=(void 0===t?{}:t).align,n=void 0===r?"start":r,i=R.current,s=i.scrollOffset,a=i.outerSize;"auto"===n&&(n=e<=s?"start":e>=s+a?"end":"start"),"start"===n?_(e):"end"===n?_(e-a):"center"===n&&_(e-a/2)},[_]),Q=Pv.useCallback(function(e,t){var r=void 0===t?{}:t,i=r.align,s=void 0===i?"auto":i,a=function(e,t){if(null==e)return{};var r,n,i={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(r,["align"]),o=R.current,c=o.measurements,u=o.scrollOffset,l=o.outerSize,h=c[Math.max(0,Math.min(e,n-1))];if(h){if("auto"===s)if(h.end>=u+l)s="end";else{if(!(h.start<=u))return;s="start"}var d="center"===s?h.start+h.size/2:"end"===s?h.end:h.start;z(d,em({align:s},a))}},[z,n]),J=Pv.useCallback(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];Q.apply(void 0,t),requestAnimationFrame(function(){Q.apply(void 0,t)})},[Q]);return{virtualItems:Y,totalSize:j,scrollToOffset:z,scrollToIndex:J,measure:U}}var fm=function(e,t,r,n){for(;e<=t;){var i=(e+t)/2|0,s=r(i);if(s<n)e=i+1;else{if(!(s>n))return i;t=i-1}}return e>0?e-1:0};export{A as $,hl as A,dl as B,nd as C,yl as D,Ir as E,Sl as F,Ad as G,El as H,Mi as I,ji as J,Vi as K,Ul as L,sd as M,Su as N,hs as O,fl as P,_l as Q,Tl as R,ml as S,Ui as T,ds as U,Oi as V,ls as W,cs as X,es as Y,b as Z,p as _,k as a,a as a$,ad as a0,Wt as a1,yt as a2,Cd as a3,Od as a4,jd as a5,nf as a6,Yh as a7,rf as a8,qh as a9,wp as aA,Ap as aB,Pp as aC,Lp as aD,kv as aE,Op as aF,Nv as aG,Lv as aH,Rp as aI,$v as aJ,x as aK,Cv as aL,zp as aM,rv as aN,H_ as aO,h as aP,X_ as aQ,kp as aR,dp as aS,Q_ as aT,hp as aU,Dp as aV,fv as aW,Jv as aX,_e as aY,up as aZ,Fi as a_,Ii as aa,Te as ab,pe as ac,ud as ad,ye as ae,me as af,du as ag,id as ah,lh as ai,Zo as aj,Jo as ak,C as al,af as am,qf as an,Yf as ao,Kf as ap,f_ as aq,ge as ar,zo as as,Qo as at,Je as au,O_ as av,w_ as aw,M_ as ax,Ae as ay,w as az,f as b,o as b0,s as b1,Kl as b2,Eh as b3,Er as b4,Sr as b5,Tr as b6,P as b7,ed as b8,le as b9,B as ba,M as bb,Vd as bc,Nu as bd,nt as be,Zv as bf,m as bg,g as bh,we as bi,O as bj,Re as bk,t as bl,N as bm,ec as bn,dm as bo,ci as c,D as d,V as e,Wl as f,tr as g,e as h,td as i,u as j,_ as k,Ee as l,_d as m,l as n,bh as o,fd as p,L as q,Ye as r,ue as s,be as t,tl as u,kd as v,vl as w,Le as x,pl as y,gl as z};
